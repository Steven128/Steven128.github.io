{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"source/lib/pjax/LICENSE","path":"lib/pjax/LICENSE","modified":1,"renderable":0},{"_id":"source/lib/pjax/index.d.ts","path":"lib/pjax/index.d.ts","modified":1,"renderable":0},{"_id":"source/lib/pjax/tests/test.ts","path":"lib/pjax/tests/test.ts","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.jpg","path":"images/avatar.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/anime.min.js","path":"lib/anime.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/all.min.css","path":"lib/font-awesome/css/all.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-brands-400.woff2","path":"lib/font-awesome/webfonts/fa-brands-400.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-regular-400.woff2","path":"lib/font-awesome/webfonts/fa-regular-400.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-solid-900.woff2","path":"lib/font-awesome/webfonts/fa-solid-900.woff2","modified":1,"renderable":1}],"Cache":[{"_id":"source/_posts/webpack.md","hash":"559f0042464f50589730d4f8c351d543e27ae655","modified":1635749478868},{"_id":"source/about/index.md","hash":"99928fe29fed81f316bd843e6d5073bba04fe717","modified":1635580592276},{"_id":"source/tags/index.md","hash":"165c13846ab5918471ee0775dfcfd625f0f7d72c","modified":1635580614548},{"_id":"source/categories/index.md","hash":"563d458e070b2eeaf68bb061ef41152fba69fbf3","modified":1635580614550},{"_id":"source/_posts/webpack/webpack-1.png","hash":"72ee00932ec7530b11c7cf90700e77d76ec8104c","modified":1621930418000},{"_id":"source/_posts/webpack/webpack-2.png","hash":"4788a42f1aa2063fa0fba15c631838b54b5257d1","modified":1621930709000},{"_id":"source/lib/pjax/.editorconfig","hash":"c064a6369e31f846061fec42fd20c94cd34baebf","modified":1574163195000},{"_id":"source/lib/pjax/.eslintignore","hash":"9039b3607514f44ee5955e986ee96920ea324398","modified":1574163195000},{"_id":"source/lib/pjax/.eslintrc.json","hash":"cdbc258b29270771e1846aeacc67198d0aed5447","modified":1574163195000},{"_id":"source/lib/pjax/.gitignore","hash":"af77252405d1ae97b1d4139b53f2684b64d87596","modified":1574163195000},{"_id":"source/lib/pjax/.prettierignore","hash":"9039b3607514f44ee5955e986ee96920ea324398","modified":1574163195000},{"_id":"source/lib/pjax/.travis.yml","hash":"0948420e18b2cec89c40093da5c7c14fa4c9bc5d","modified":1574163195000},{"_id":"source/lib/pjax/CHANGELOG.md","hash":"4482a245ac2c867102490c71d0fcbb502be0e3e5","modified":1574163195000},{"_id":"source/lib/pjax/LICENSE","hash":"0cadc79604daeacf95062d1e5ccd43edbfaed836","modified":1574163195000},{"_id":"source/lib/pjax/index.d.ts","hash":"b90fe99fe90ee7024d760467e75565da561f7ccd","modified":1574163195000},{"_id":"source/lib/pjax/index.js","hash":"4af61bcf253ce67d67bb0f524b441869301de9a5","modified":1574163195000},{"_id":"source/lib/pjax/package.json","hash":"1c0055fc51eee37e39ca9d5b6ea5078677b20201","modified":1574163195000},{"_id":"source/lib/pjax/pjax.js","hash":"e973e2c6ffb6f6d7b4a1730ba0ed6d3628b2b39f","modified":1574163195000},{"_id":"source/lib/pjax/pjax.min.js","hash":"68d0c6ad28f042c78fc18a6e9d782a7047c01905","modified":1574163195000},{"_id":"source/lib/pjax/example/example.js","hash":"48b27c93eb351d2fa91247c35038a9f1627e971a","modified":1574163195000},{"_id":"source/lib/pjax/example/forms.html","hash":"aa62fc6e697e17e16a947eb0176dc24e2e42d72c","modified":1574163195000},{"_id":"source/lib/pjax/example/index.html","hash":"4a00b556253eeb11fc10013c8c3940a019154001","modified":1574163195000},{"_id":"source/lib/pjax/example/page2.html","hash":"7654e0a5a471bec5d74fb88d9f2f218817afdd52","modified":1574163195000},{"_id":"source/lib/pjax/example/page3.html","hash":"8d1d6a9afd80caf29e5b22f10a849b23a864a6a4","modified":1574163195000},{"_id":"source/lib/pjax/lib/abort-request.js","hash":"cbae038c94f70163340801cb608f4e503640b88d","modified":1574163195000},{"_id":"source/lib/pjax/lib/eval-script.js","hash":"d5980b3c5f3c1a95427eab0d7d2263324fb72bca","modified":1574163195000},{"_id":"source/lib/pjax/lib/execute-scripts.js","hash":"8c7c18b14c11af7e2d8dd0146b7df428bf8149bb","modified":1574163195000},{"_id":"source/lib/pjax/lib/foreach-els.js","hash":"d8e50967878930891112f4acb46f47697ddc3ad7","modified":1574163195000},{"_id":"source/lib/pjax/lib/foreach-selectors.js","hash":"b11d36344a7a6aa36d533a335785772c9bfb6bc9","modified":1574163195000},{"_id":"source/lib/pjax/lib/is-supported.js","hash":"62ede7268080ab7efddd64fced8b3e79af2901f6","modified":1574163195000},{"_id":"source/lib/pjax/lib/parse-options.js","hash":"054a902e9f350f7414b80f62419da004dd90aa37","modified":1574163195000},{"_id":"source/lib/pjax/lib/send-request.js","hash":"15c341d066b0d60879ef3ca5ff858103381fb378","modified":1574163195000},{"_id":"source/lib/pjax/lib/switches-selectors.js","hash":"f31b4af163db3d9a5b3bb7c7534a4a2dd5543435","modified":1574163195000},{"_id":"source/lib/pjax/lib/switches.js","hash":"4e283f667c10e0fea15e269f1c73ccb699979bb4","modified":1574163195000},{"_id":"source/lib/pjax/lib/uniqueid.js","hash":"eb127cf8936e5bdcaa7459cf5bd042ff96b5a387","modified":1574163195000},{"_id":"source/lib/pjax/tests/setup.js","hash":"4a9489e72cbe98527931d95d68b68e2d6a9bff6e","modified":1574163195000},{"_id":"source/lib/pjax/tests/test.ts","hash":"3a5222592fc1883ba6d07fbb2095e4bb4866e9d9","modified":1574163195000},{"_id":"source/lib/pjax/lib/events/on.js","hash":"111fba16cc4ca701aefedea2589c832b60af303d","modified":1574163195000},{"_id":"source/lib/pjax/lib/events/off.js","hash":"79920b24246e150f1c73511f1a271b93b9c5d9c8","modified":1574163195000},{"_id":"source/lib/pjax/lib/events/trigger.js","hash":"c05ba73199c5e2c7682655491ed37743bd451751","modified":1574163195000},{"_id":"source/lib/pjax/lib/proto/attach-form.js","hash":"b41c66e58897e6371fbd04cd2b9eb7bae10e0d89","modified":1574163195000},{"_id":"source/lib/pjax/lib/proto/attach-link.js","hash":"d15a61235aa8c1615e60ea34d9bbee834be804d0","modified":1574163195000},{"_id":"source/lib/pjax/lib/proto/handle-response.js","hash":"f68bab958cce4dbbcb91920d7a8aba55b9066b41","modified":1574163195000},{"_id":"source/lib/pjax/lib/proto/log.js","hash":"c728730594aed7d81509787c5bb487af014415e1","modified":1574163195000},{"_id":"source/lib/pjax/lib/proto/parse-element.js","hash":"52bef8a845aab0d54907f73875fa58b4084019be","modified":1574163195000},{"_id":"source/lib/pjax/lib/util/clone.js","hash":"55027b88e007818c6963205fcd0090a61af8237c","modified":1574163195000},{"_id":"source/lib/pjax/lib/util/contains.js","hash":"fcc9be0477d941b7c4ba71de328773e556ded7ce","modified":1574163195000},{"_id":"source/lib/pjax/lib/util/extend.js","hash":"e599aaef93e3a00ccbd92cd87df09898d712e398","modified":1574163195000},{"_id":"source/lib/pjax/lib/util/noop.js","hash":"2c9f7e231af1a62db195875ca62df7edc253c3c4","modified":1574163195000},{"_id":"source/lib/pjax/lib/util/update-query-string.js","hash":"eefcbff322f8c607865d47ee8fa49f1c8bfa8d7a","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/abort-request.js","hash":"96d7a604ca275455199bd94d16b9cdc254bee9b9","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/eval-scripts.js","hash":"3c9125a04cec9d511f16f9311656533ef6a115d1","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/events.js","hash":"70ca7ec140d1dcf8c4958e7b6788b09ef2b60181","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/execute-scripts.js","hash":"2d02a0151ead9924516cdae9308f8667b27a7ea7","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/foreach-els.js","hash":"85995dd27d0d866cfaf5c560732fab8b0099938c","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/foreach-selectors.js","hash":"898b48ef191719070488f16a54fba8a794b10057","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/is-supported.js","hash":"e25c7e69c8b7a64a44affcae317adb2b3889aee6","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/parse-options.js","hash":"45ab302da33e5457a71fd22bbd082e51f5b06b49","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/send-request.js","hash":"d6adad7f95754c53b9885c0999a5118995fdc76f","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/switch-selectors.js","hash":"993dd67b1b629288feb8d167fb12b602626cf1d5","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/switches.js","hash":"f5dfdf57bafd2b4edd5f854d70837b5fe760756e","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/uniqueid.js","hash":"430550f31b9e6356c2e3a033c1b418bd6acd9667","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/proto/attach-form.js","hash":"3614a962e3185b354a2e0d987bcecdef4a209da6","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/proto/attach-link.js","hash":"9d283cb0b09730e932673c73a3352a2d2e8939fa","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/proto/handle-response.js","hash":"26e0e334f0b20ff2fe75b3ab12a93ce44a5823f0","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/proto/parse-element.js","hash":"474edc8844028de67cbad054da79c05727620785","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/util/clone.js","hash":"4b0e62bd0f4eef3549b0da70987f63ce4953bef0","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/util/contains.js","hash":"bc0c8be855e9736cb256a2aa44fd46f3a7d1d6c5","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/util/extend.js","hash":"d45488ff6f8e3e1b59a62d0c88c86b750fe50ed4","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/util/noop.js","hash":"6959a4c02c41453a5edfa4163e36752fcfa3edf9","modified":1574163195000},{"_id":"source/lib/pjax/tests/lib/util/update-query-string.js","hash":"4158dcd877c5f229400417e0da22eb4c5b8e8e38","modified":1574163195000},{"_id":"themes/next/.editorconfig","hash":"731c650ddad6eb0fc7c3d4a91cad1698fe7ad311","modified":1635573862474},{"_id":"themes/next/.eslintrc.json","hash":"d3c11de434171d55d70daadd3914bc33544b74b8","modified":1635573862474},{"_id":"themes/next/.gitattributes","hash":"3e00e1fb043438cd820d94ee3dc9ffb6718996f3","modified":1635573862475},{"_id":"themes/next/.gitignore","hash":"83418530da80e6a78501e1d62a89c3bf5cbaec3d","modified":1635573862487},{"_id":"themes/next/.stylintrc","hash":"6259e2a0b65d46865ab89564b88fc67638668295","modified":1635573862488},{"_id":"themes/next/.travis.yml","hash":"379f31a140ce41e441442add6f673bf397d863ea","modified":1635573862488},{"_id":"themes/next/LICENSE.md","hash":"0a9c7399f102b4eb0a6950dd31264be421557c7d","modified":1635573862489},{"_id":"themes/next/README.md","hash":"7d56751b580d042559b2acf904fca4b42bcb30a7","modified":1635573862490},{"_id":"themes/next/_config.yml","hash":"b300d964dc54f928273d750d31505b3f85d442db","modified":1635748984173},{"_id":"themes/next/crowdin.yml","hash":"4a53f5985e545c635cb56b2a57ed290cb8cf8942","modified":1635573862493},{"_id":"themes/next/gulpfile.js","hash":"0c76a1ac610ee8cbe8e2cc9cca1c925ffd0edf98","modified":1635573862510},{"_id":"themes/next/package.json","hash":"b099e7cea4406e209130410d13de87988ba37b2a","modified":1635573862579},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"778b7e052993ed59f21ed266ba7119ee2e5253fb","modified":1635573862476},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5ddde54fb50d11dc08cec899a3588addb56aa386","modified":1635573862477},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"d2f8e6b65783e31787feb05d2ccea86151f53f35","modified":1635573862482},{"_id":"themes/next/.github/config.yml","hash":"df3d970700e6b409edc3d23be8d553db78d5ba3f","modified":1635573862483},{"_id":"themes/next/.github/issue-close-app.yml","hash":"b14756e65546eb9ecc9d4393f0c9a84a3dac1824","modified":1635573862484},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"533fbe6b2f87d7e7ec6949063bb7ea7eb4fbe52d","modified":1635573862485},{"_id":"themes/next/.github/lock.yml","hash":"3ce3d0a26030a1cd52b273cc6a6d444d7c8d85c2","modified":1635573862485},{"_id":"themes/next/.github/mergeable.yml","hash":"1c1cb77a62df1e3654b151c2da34b4a10d351170","modified":1635573862485},{"_id":"themes/next/.github/release-drafter.yml","hash":"09c3352b2d643acdc6839601ceb38abc38ab97c5","modified":1635573862486},{"_id":"themes/next/.github/stale.yml","hash":"590b65aca710e0fba75d3cf5361a64d13b6b0f63","modified":1635573862487},{"_id":"themes/next/.github/support.yml","hash":"7ce2722d6904c31a086444c422dc49b6aa310651","modified":1635573862487},{"_id":"themes/next/docs/AGPL3.md","hash":"f463f95b169d64983f59fa6f3e4b6760290a0e6b","modified":1635573862495},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"60c7e9ef0c578deebad43e9395c958fa61096baf","modified":1635573862495},{"_id":"themes/next/docs/AUTHORS.md","hash":"cde7cc095ac31b421a573042cf61060f90d9ad0d","modified":1635573862496},{"_id":"themes/next/docs/DATA-FILES.md","hash":"980fb8d37701f7fd96b30bb911519de3bbb473d1","modified":1635573862497},{"_id":"themes/next/docs/INSTALLATION.md","hash":"07ea00bee149a1bdc9073e903ee6b411e9f2f818","modified":1635573862498},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"6cc663db5e99fd86bb993c10d446ad26ada88e58","modified":1635573862499},{"_id":"themes/next/docs/LICENSE.txt","hash":"ae5ad07e4f4106bad55535dba042221539e6c7f9","modified":1635573862499},{"_id":"themes/next/docs/MATH.md","hash":"f56946053ade0915ff7efa74d43c38b8dd9e63bb","modified":1635573862500},{"_id":"themes/next/languages/de.yml","hash":"15078b7ede1b084e8a6a15d271f0db9c325bd698","modified":1635573862512},{"_id":"themes/next/languages/ar.yml","hash":"abcf220bd615cec0dd50e4d98da56580169d77e1","modified":1635573862511},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"1e86d32063b490d204baa9d45d8d3cb22c24a37d","modified":1635573862500},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1635573862513},{"_id":"themes/next/languages/es.yml","hash":"f064c793d56a5e0f20cda93b6f0e355044efc7d8","modified":1635573862514},{"_id":"themes/next/languages/en.yml","hash":"dbb64776f9c001c54d0058256c415a9a0724ed5d","modified":1635573862513},{"_id":"themes/next/languages/fa.yml","hash":"6c0a7d5bcc26eb45a9f3e02f13117c668e77fffd","modified":1635573862515},{"_id":"themes/next/languages/fr.yml","hash":"3e2f89d4bb4441d33ecc7b5a4ee114f627603391","modified":1635573862516},{"_id":"themes/next/languages/hu.yml","hash":"0ea89ffaefd02a10494995f05a2a59d5e5679a28","modified":1635573862516},{"_id":"themes/next/languages/id.yml","hash":"7599bb0ecf278beb8fde3d17bfc148a3241aef82","modified":1635573862517},{"_id":"themes/next/languages/it.yml","hash":"46222f468e66789e9ba13095809eb5e5b63edf30","modified":1635573862518},{"_id":"themes/next/languages/ja.yml","hash":"bf279d0eb1911806d01a12f27261fbc76a3bb3f9","modified":1635573862518},{"_id":"themes/next/languages/nl.yml","hash":"9749cf90b250e631dd550a4f32ada3bb20f66dd0","modified":1635573862519},{"_id":"themes/next/languages/ko.yml","hash":"af4be6cb394abd4e2e9a728418897d2ed4cc5315","modified":1635573862519},{"_id":"themes/next/languages/pt-BR.yml","hash":"69aa3bef5710b61dc9a0f3b3a8f52f88c4d08c00","modified":1635573862520},{"_id":"themes/next/languages/ru.yml","hash":"012abc694cf9de281a0610f95f79c594f0a16562","modified":1635573862521},{"_id":"themes/next/languages/pt.yml","hash":"f6606dd0b916a465c233f24bd9a70adce34dc8d6","modified":1635573862520},{"_id":"themes/next/languages/tr.yml","hash":"c4e9ab7e047ae13a19f147c6bec163c3ba2c6898","modified":1635573862521},{"_id":"themes/next/languages/uk.yml","hash":"69ef00b1b8225920fcefff6a6b6f2f3aad00b4ce","modified":1635573862522},{"_id":"themes/next/languages/vi.yml","hash":"6a578cc28773bd764f4418110500478f185d6efa","modified":1635573862522},{"_id":"themes/next/languages/zh-HK.yml","hash":"92ccee40c234626bf0142152949811ebe39fcef2","modified":1635573862523},{"_id":"themes/next/languages/zh-TW.yml","hash":"cf0740648725983fb88409d6501876f8b79db41d","modified":1635573862524},{"_id":"themes/next/languages/zh-CN.yml","hash":"81d73e21402dad729053a3041390435f43136a68","modified":1635573862523},{"_id":"themes/next/layout/category.swig","hash":"c546b017a956faaa5f5643c7c8a363af7ac9d6b9","modified":1635573862574},{"_id":"themes/next/layout/_layout.swig","hash":"9554bd0f5c5a0438aa7b64065be5561c374d260e","modified":1635573862524},{"_id":"themes/next/layout/archive.swig","hash":"cf4957c899b2bebc93e4e7948ccc06559b6b60bd","modified":1635580210619},{"_id":"themes/next/layout/page.swig","hash":"357d916694d4c9a0fd1140fa56d3d17e067d8b52","modified":1635573862575},{"_id":"themes/next/layout/index.swig","hash":"8dfd96fb6f833dd5d037de800813105654e8e8e6","modified":1635573862574},{"_id":"themes/next/layout/post.swig","hash":"5f0b5ba2e0a5b763be5e7e96611865e33bba24d7","modified":1635573862576},{"_id":"themes/next/layout/tag.swig","hash":"d44ff8755727f6532e86fc9fc8dc631200ffe161","modified":1635573862577},{"_id":"themes/next/scripts/renderer.js","hash":"e3658eea97b1183ee2e9f676231e53f7994741f6","modified":1635573862596},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"e67146befddec3a0dc47dc80d1109070c71d5d04","modified":1635573862478},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"6beeca0f45a429cd932b6e648617f548ff64c27c","modified":1635573862479},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"d5aa1a3323639a36bcd9a401484b67537043cd3c","modified":1635573862480},{"_id":"themes/next/.github/ISSUE_TEMPLATE/question.md","hash":"59275aa0582f793fee7be67904dcf52ad33a7181","modified":1635573862481},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"54e6a067ed95268eab6be2ba040a7e9b1907928e","modified":1635573862501},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"a9cfe5ac9ef727a8650b2b6584482751a26b1460","modified":1635573862502},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"3202be9a8d31986caac640e7a4c7ce22e99917eb","modified":1635573862504},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"cb8e39c377fc4a14aaf133b4d1338a48560e9e65","modified":1635573862503},{"_id":"themes/next/docs/ru/README.md","hash":"1e5ddb26ad6f931f8c06ce2120f257ff38b74fdf","modified":1635573862502},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7e6f227f2aaf30f400d4c065650a4e3d0d61b9e1","modified":1635573862504},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"611f2930c2b281b80543531b1bf33d082531456a","modified":1635573862505},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"2d868cd271d78b08775e28c5b976de8836da4455","modified":1635573862506},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"716111dd36d276f463c707dfcc9937fea2a1cf7a","modified":1635573862506},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"50ab381c27611d5bf97bb3907b5ca9998f28187d","modified":1635573862507},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"0d46f9f50cf2e4183970adce705d1041155b0d37","modified":1635573862508},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"b3201934b966bc731eaf8a4dad4ba4bdcd300c10","modified":1635573862509},{"_id":"themes/next/docs/zh-CN/README.md","hash":"8f7c0d0b766024152591d4ccfac715c8e18b37f3","modified":1635573862509},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"30ade8c806d7826cc50a4a3e46a9e6213fddf333","modified":1635573862527},{"_id":"themes/next/layout/_macro/post.swig","hash":"c3fd56bac90ce45a0c79ddfe68beb223ad0d72b4","modified":1635573862528},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"5bffdb1448caca7db7b1f84e1693e6657a106d50","modified":1635573862528},{"_id":"themes/next/layout/_partials/comments.swig","hash":"142efb4c6b73d8f736f6784804b40d5871333172","modified":1635573862529},{"_id":"themes/next/layout/_partials/footer.swig","hash":"2e083be33fea10e8984e8d827649a9ac1905835a","modified":1635575313403},{"_id":"themes/next/layout/_partials/languages.swig","hash":"c3ea82604a5853fb44c5f4e4663cbe912aa5dcf8","modified":1635573862536},{"_id":"themes/next/layout/_scripts/index.swig","hash":"1822eaf55bbb4bec88871c324fc18ad95580ccb4","modified":1635573862546},{"_id":"themes/next/layout/_partials/widgets.swig","hash":"5392dcbb504266f0f61d5b8219914068ef9cdc25","modified":1635573862544},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"2de77d533c91532a8a4052000244d0c1693370df","modified":1635573862538},{"_id":"themes/next/layout/_scripts/pjax.swig","hash":"ccff5a773644d33ff22f6b45b6734f52b048f22b","modified":1635573862548},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"7b9e0f776a5be6c3f95bc7f394e1424ba02ba93b","modified":1635573862546},{"_id":"themes/next/layout/_scripts/three.swig","hash":"6b092c6d882b2dfa5273e1b3f60b244cb7c29fcd","modified":1635573862552},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"244ca2d74ee0d497c87572c6a26b43c62a952673","modified":1635573862552},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"28b0a7e843ec4365db1963646659a153753cd746","modified":1635573862555},{"_id":"themes/next/layout/_third-party/index.swig","hash":"c6b63cbc80938e6e09578b8c67e01adf13a9e3bd","modified":1635573862563},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"5ae5adcd6f63ed98b2071e4f7e5e38c4d7d24e1b","modified":1635573862566},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"269102fc5e46bd1ce75abdcce161f0570ae70e2f","modified":1635573862567},{"_id":"themes/next/scripts/events/index.js","hash":"5c355f10fe8c948a7f7cd28bd8120adb7595ebde","modified":1635573862581},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"ad321db012cea520066deb0639335e9bc0dcc343","modified":1635573862589},{"_id":"themes/next/scripts/filters/front-matter.js","hash":"305d03c1e45782988809298c3e3b3c5d5ee438aa","modified":1635573862589},{"_id":"themes/next/scripts/filters/locals.js","hash":"a5e7d05d3bd2ae6dcffad5a8ea0f72c6e55dbd02","modified":1635573862590},{"_id":"themes/next/scripts/filters/minify.js","hash":"21196a48cb127bf476ce598f25f24e8a53ef50c2","modified":1635573862590},{"_id":"themes/next/scripts/filters/post.js","hash":"57f2d817578dd97e206942604365e936a49854de","modified":1635573862591},{"_id":"themes/next/scripts/helpers/engine.js","hash":"eb6b8bbc1dce4846cd5e0fac0452dbff56d07b5d","modified":1635573862594},{"_id":"themes/next/scripts/helpers/font.js","hash":"8fb1c0fc745df28e20b96222974402aab6d13a79","modified":1635573862594},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"b8d7ddfa4baa9b8d6b9066a634aa81c6243beec9","modified":1635573862595},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"4044129368d0e2811859a9661cad8ab47118bc32","modified":1635573862596},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"840536754121e0da5968f5ad235f29200fc5d769","modified":1635573862598},{"_id":"themes/next/scripts/tags/button.js","hash":"bb0e8abbc0a6d5b3a1a75a23976f2ac3075aab31","modified":1635573862597},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"e2d0184bc4a557e1017395b80ff46880078d8537","modified":1635573862599},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"93ccd3f99d3cb42674f29183c756df63acb5d7f8","modified":1635573862600},{"_id":"themes/next/scripts/tags/label.js","hash":"fc83f4e1be2c34e81cb79938f4f99973eba1ea60","modified":1635573862601},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"81134494ff0134c0dae1b3815caf6606fccd4e46","modified":1635573862601},{"_id":"themes/next/scripts/tags/note.js","hash":"1fdf4f95810fdb983bfd5ad4c4f13fedd4ea2f8d","modified":1635573862602},{"_id":"themes/next/scripts/tags/pdf.js","hash":"37b53661ad00a01a2ca7d2e4a5ad3a926073f8e2","modified":1635573862602},{"_id":"themes/next/scripts/tags/tabs.js","hash":"c70a4a66fd0c28c98ccb6c5d5f398972e5574d28","modified":1635573862602},{"_id":"themes/next/scripts/tags/video.js","hash":"944293fec96e568d9b09bc1280d5dbc9ee1bbd17","modified":1635573862603},{"_id":"themes/next/source/css/_colors.styl","hash":"11aef31a8e76f0f332a274a8bfd4537b73d4f88f","modified":1635573862604},{"_id":"themes/next/source/css/_mixins.styl","hash":"072a3fa473c19b20ccd7536a656cda044dbdae0a","modified":1635573862656},{"_id":"themes/next/source/css/main.styl","hash":"815ef30987d02f3d76dbe4b5ee3a72135a152678","modified":1635573862674},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1635573862675},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1635573862677},{"_id":"themes/next/source/images/avatar.jpg","hash":"bf9b5a40213ee491994b8f981a220d42f7c162a5","modified":1581494542193},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1635573862679},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1635573862681},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1635573862682},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1635573862682},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1635573862683},{"_id":"themes/next/source/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1635573862683},{"_id":"themes/next/source/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1635573862684},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1635573862684},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1635573862685},{"_id":"themes/next/source/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1635573862686},{"_id":"themes/next/source/js/algolia-search.js","hash":"6a813410e33824d7acc65a369a2983912bb3420c","modified":1635573862687},{"_id":"themes/next/source/js/bookmark.js","hash":"9f05fd3672789311dc0cf5b37e40dc654cb04a2a","modified":1635573862687},{"_id":"themes/next/source/js/local-search.js","hash":"cfa6a0f3f9c2bc759ee507668a21f4e8f250f42a","modified":1635573862688},{"_id":"themes/next/source/js/motion.js","hash":"d5aa1a08cdf3c8d1d8d550fb1801274cc41e5874","modified":1635573862688},{"_id":"themes/next/source/js/next-boot.js","hash":"250d8dcd6322e69e3fbadd0f3e37081c97b47c52","modified":1635573862689},{"_id":"themes/next/source/js/utils.js","hash":"26a82e46fdcadc7c3c2c56a7267284b61a26f7f3","modified":1635573862691},{"_id":"themes/next/source/lib/anime.min.js","hash":"960be51132134acd65c2017cc8a5d69cb419a0cd","modified":1635573862693},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"7d638e413f2548fc990c4a467dd03de6c81fc960","modified":1635573862531},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"90cce9f407e9490756ba99580e3eb09f55b05eaa","modified":1635573862532},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"91056a6c98cca63ff8cc6956e531ee3faf4b8ad9","modified":1635573862533},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"0dd316f153c492c0a03bd0273d50fa322bc81f11","modified":1635573862534},{"_id":"themes/next/layout/_partials/header/menu-item.swig","hash":"4baa86ca631168fc6388d27f4b1b501b40c877a8","modified":1635573862535},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"90d3eaba6fbe69bee465ddd67c467fd2c0239dc4","modified":1635573862535},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"bed6cc2b48cf2655036ba39c9bae73a295228a4d","modified":1635573862536},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"91c0addb33006619faa4c32e5d66874e25f1e9b3","modified":1635573862537},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"8d4e3dd0d3631ce0b21bc15c259f6ac886de631d","modified":1635573862537},{"_id":"themes/next/layout/_partials/post/post-followme.swig","hash":"d8f785c062c6b0763a778bd4a252e6f5fee0e432","modified":1635573862539},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"f2eb455c8bf13533427254f0c9b4b17b2498168b","modified":1635573862538},{"_id":"themes/next/layout/_partials/post/post-footer.swig","hash":"ce712c110b5ce8aacba7a86b0558ff89700675c9","modified":1635573862539},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"bc7b047a6246df07767373644b1637d91c3a88b1","modified":1635573862540},{"_id":"themes/next/layout/_partials/post/post-reward.swig","hash":"f349a226e5370075bb6924e60da8b0170c7cfcc1","modified":1635573862540},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"98fd1f5df044f4534e1d4ca9ab092ba5761739a9","modified":1635573862541},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"a6c761d5193cb6f22e9422dbbcf209e05471b0ed","modified":1635573862541},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"128f7d679bb4d53b29203d598d217f029a66dee7","modified":1635573862542},{"_id":"themes/next/layout/_partials/sidebar/site-overview.swig","hash":"fab01d83579fb4b4c3f3350521687adf9136ced1","modified":1635746689980},{"_id":"themes/next/layout/_scripts/pages/schedule.swig","hash":"34c05e9d73b0f081db70990c296b6d6a0f8ea2ca","modified":1635573862547},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"34495d408e8467555afee489500b8aad98c52079","modified":1635573862549},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"0b44f400ec00d2b5add5ee96c11d22465c432376","modified":1635573862549},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"0b44f400ec00d2b5add5ee96c11d22465c432376","modified":1635573862550},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"34495d408e8467555afee489500b8aad98c52079","modified":1635573862551},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"84adaadd83ce447fa9da2cff19006334c9fcbff9","modified":1635573862554},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"b8819bd056f8a580c5556d4415836a906ed5d7a4","modified":1635573862554},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"91c2cb900c76224c5814eeb842d1d5f517f9bf05","modified":1635573862555},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"85b60e222712ca3b2c4dc2039de2dc36b8d82940","modified":1635573862555},{"_id":"themes/next/layout/_third-party/chat/chatra.swig","hash":"2642e8aef5afbe23a2a76efdc955dab2ee04ed48","modified":1635573862556},{"_id":"themes/next/layout/_third-party/chat/tidio.swig","hash":"fb94ee487d75e484e59b7fba96e989f699ff8a83","modified":1635573862557},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"9298e6d6c4a62a0862fc0f4060ed99779d7b68cb","modified":1635573862558},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"1b29b99fa921f12c25d3dc95facdf84ef7bb1b5c","modified":1635573862560},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"a42f97eda3748583bac2253c47fe5dfa54f07b8f","modified":1635573862561},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"606ad14a29320157df9b8f33738282c51bb393d9","modified":1635573862561},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"3d91899ca079e84d95087b882526d291e6f53918","modified":1635573862562},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"ae2707d6e47582bb470c075649ec7bad86a6d5a9","modified":1635573862563},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"59df21fcfe9d0ada8cee3188cb1075529c1c3eb8","modified":1635573862565},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"276f523e414d4aa7f350a8f2fd3df8a3d8ea9656","modified":1635573862565},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"1f34b2d3c753a3589ab6c462880bd4eb7df09914","modified":1635573862566},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"fd726aad77a57b288f07d6998ec29291c67c7cbb","modified":1635573862568},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"58296a5c1883f26464c2a5ccf734c19f5fbf395a","modified":1635573862568},{"_id":"themes/next/layout/_third-party/search/swiftype.swig","hash":"aa6ab95b8b76611694613defb4bf25003d1b927f","modified":1635573862569},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.swig","hash":"d2f0e4c598410ec33785abe302c7ea7492bb791a","modified":1635573862569},{"_id":"themes/next/layout/_third-party/statistics/cnzz-analytics.swig","hash":"53a0760c75d5aaabb3ce8e8aa8e003510d59807f","modified":1635573862570},{"_id":"themes/next/layout/_third-party/statistics/firestore.swig","hash":"01d94354d07e72cad47100482068b6be69fcc033","modified":1635573862571},{"_id":"themes/next/layout/_third-party/statistics/index.swig","hash":"964cd6bac668cf6d211a2624fbef3948cfdece55","modified":1635573862571},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.swig","hash":"c171ea94e9afbba97f06856904264da331559463","modified":1635573862571},{"_id":"themes/next/layout/_third-party/tags/mermaid.swig","hash":"619338ddacf01e3df812e66a997e778f672f4726","modified":1635573862572},{"_id":"themes/next/layout/_third-party/tags/pdf.swig","hash":"5a223b60406cee7438cfe3a5e41d1284425aa7a5","modified":1635573862573},{"_id":"themes/next/scripts/events/lib/config.js","hash":"aefe3b38a22bc155d485e39187f23e4f2ee5680a","modified":1635573862582},{"_id":"themes/next/scripts/events/lib/injects-point.js","hash":"08496b71c9939718e7955704d219e44d7109247b","modified":1635573862583},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"e73f697bb160b223fdde783237148be5f41c1d78","modified":1635573862584},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"2f22f48f7370470cef78561a47c2a47c78035385","modified":1635573862585},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"713056d33dbcd8e9748205c5680b456c21174f4e","modified":1635573862585},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"0c3bea89d64bc12c1bbe6f208a83773c6fb5375a","modified":1635573862586},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"3a80559df0b670ccb065ea9d3bb587d0b61be3a4","modified":1635573862587},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"67cf90d9a2428c14eb113a64bdd213c22a019aef","modified":1635573862587},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"323a47df6ded894944a2647db44556d6163e67c4","modified":1635573862588},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"a4f3153ac76a7ffdf6cc70f52f1b2cc218ed393e","modified":1635573862588},{"_id":"themes/next/scripts/filters/comment/valine.js","hash":"851359f5ff90f733a9bd7fe677edbee8b8ac714c","modified":1635573862588},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"583ff1e7a2ca889f1f54eb0ca793894466823c7c","modified":1635573862671},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"5980abbbbeacd8541121f436fa414d24ad5e97c2","modified":1635573862672},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"c22b58af3327236ec54d5706501aa5a20e15012e","modified":1635573862672},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"4e33774b1fe6d0a51f3a428c54c5e600e83bf154","modified":1635573862673},{"_id":"themes/next/source/css/_variables/base.styl","hash":"ad680efdfb2f86546182bf3f59886efbcf3c1b2d","modified":1635573862674},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"b85a6e2af1387fe64b51e7cd3e2da8616e6f5a3f","modified":1635573862690},{"_id":"themes/next/source/js/schemes/muse.js","hash":"a18559a9c332199efad0100cf84bb0c23fc0f17a","modified":1635573862690},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"bf172816a9c57f9040e3d19c24e181a142daf92b","modified":1635573862701},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"dde584994ac13dc601836e86f4cf490e418d9723","modified":1635573862702},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"510a6f0ba7485dd54ce347cca890ab52c4957081","modified":1635573862605},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"0534b329d279a6f255112b3305ff92c810f31724","modified":1635573862605},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"d17236df3b4d6def1e4e81133ef4729c390de3ac","modified":1635573862606},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"c52648a7b09f9fe37858f5694fcc1ffc709ad147","modified":1635573862621},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"a2ee16cac29a82cfce26804c160286fcbee94161","modified":1635573862635},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"7a95c27762e1303bf06ee808c63f616cb192fcaf","modified":1635573862635},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"5540c9259cb7895a5f10a289c7937e5470a7c134","modified":1635573862641},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"45f4badac6ec45cf24355f6157aece1d4d3f1134","modified":1635573862642},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"4b068d0d898f4e624937503f0e1428993050bd65","modified":1635573862643},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"6d740699fb6a7640647a8fd77c4ea4992d8d6437","modified":1635578010120},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"b619f39e18398422e0ac4999d8f042a5eaebe9cd","modified":1635573862649},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"43045d115f8fe95732c446aa45bf1c97609ff2a5","modified":1635573862650},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"f317d2e3886e94f5fbb8781c2e68edd19669ff58","modified":1635573862650},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"20e0e3e3eba384930c022e21511214d244b4c9e7","modified":1635573862655},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"e342b8f8e11a3a6aa5a029912c9778c25bf5d135","modified":1635573862657},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"b9e87d32da24264bda247c1526afe140c858b0ef","modified":1635573862657},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"12b265f82840f27112ca2b1be497677f20f87545","modified":1635573862660},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"716e8b0f056bf6393e6bc6969ac84598ab8e7a6f","modified":1635573862661},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"e1c29b81a32273a0dedd926cda199a71aea72624","modified":1635573862662},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"c5142739e01e9f25c8b32b2209af85c787bb2b42","modified":1635573862662},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"8674bd88df076a1dfe4023ed6750ded1f5b00223","modified":1635573862663},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"49c76bc723d3952abb613d9d68398ed7305da999","modified":1635573862664},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4b7f057dbb53efd7cbe7eac7835a793ab3cbb135","modified":1635573862664},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"9898323ee5a7ac2a5d4f633c653112280beb2643","modified":1635573862666},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"2d3e05015796a790abd9d68957a5c698c0c9f9b6","modified":1635573862666},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"25c2a7930da14f023329df20f38df2728057fb4d","modified":1635573862667},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"558794fced306339b98dc2b0ee7f0576802f1355","modified":1635573862668},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5de34e1d8a290751641ae456c942410852d5e809","modified":1635573862668},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"0a9f0d9eb042595502d200fb8c65efb0e6c89aa9","modified":1635573862669},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"dc9318992ce2eb086ebaa2fe56b325e56d24098b","modified":1635573862669},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b69ac38b9da8c9c1b7de696fdeea7f9d7705213a","modified":1635573862670},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"25c2a7930da14f023329df20f38df2728057fb4d","modified":1635573862670},{"_id":"themes/next/source/lib/font-awesome/css/all.min.css","hash":"82e34d28f8a1169b20b60101d5bb0446deba3514","modified":1635573862695},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-regular-400.woff2","hash":"260bb01acd44d88dcb7f501a238ab968f86bef9e","modified":1635573862698},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"236a039b0900f4267de566b46f62314ad967d30f","modified":1635573862607},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"18edddb2ffb3f85a68e4367f81e06c461e07bc25","modified":1635573862607},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"6cf78a379bb656cc0abb4ab80fcae60152ce41ad","modified":1635573862608},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"f6f05f02d50f742c84ee5122016c0563a8bb2cf9","modified":1635573862610},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"97974c231b4659b8aa5e9321c4d54db5c816d0db","modified":1635573862611},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"a52f8cae599099231866298ed831fdf76c9b6717","modified":1635573862613},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"34fe3bb11087026cd0faba4ce013d74a7a430c38","modified":1635576447355},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"9af620eba5ccceea21a0e3bc69f6f1fa7637c2f3","modified":1635573862615},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"97dec98d0403097d66822f1c90b50b2890c84698","modified":1635573862616},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"57b9a179675f1536e017cba457b6ac575e397c4f","modified":1635573862616},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"0dfb97703a519d9438f64f9e41ab1dd37381f733","modified":1635573862617},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"2d9f82d8e2313e32fc9b2f739464751f5004925f","modified":1635576255345},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"66fc406796b6efe6cea76550573b7a632112406a","modified":1635573862619},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"2c24829d95c742eb9e8316ebf2fbe9f2c168b59a","modified":1635573862619},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"09dda2667628d1f91b2e37d8fc6df1413f961b64","modified":1635573862620},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"5cc9e7394c927065c688cba5edd6e0a27587f1d8","modified":1635573862620},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"b266d2ce5e2b117be01537889e839a69004dc0bb","modified":1635573862621},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"fcd64c23d17775b3635325f6758b648d932e79b5","modified":1635573862621},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"b87f4a06c0db893df4f756f24be182e1a4751f24","modified":1635573862622},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"d83102771df652769e51ddfd041cf5f4ca1a041d","modified":1635573862623},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"8ed7a9d5dfac592de703421b543978095129aa5b","modified":1635573862623},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"bad99f4cccb93b3cefe990a2c85124e60698d32e","modified":1635573862624},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1f6b0d3ab227697ca115e57fd61122ea7950e19d","modified":1635573862627},{"_id":"themes/next/source/css/_common/outline/footer/footer.styl","hash":"7eeb22c5696f8e0c95161dc57703973cf81c8c12","modified":1635573862628},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"b4f4bae437d4f994af93cf142494ffcd86bae46b","modified":1635573862629},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"b31c86d1a4f89837f9187bed646bda96b2cd286c","modified":1635573862630},{"_id":"themes/next/source/css/_common/outline/header/header.styl","hash":"300058ca12e81013e77ba01fe66ac210525768b6","modified":1635573862632},{"_id":"themes/next/source/css/_common/outline/header/headerband.styl","hash":"6d5f26646e2914474f295de8bf6dc327d4acd529","modified":1635573862633},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"7a3a56b10ab714c0e2ed240d0939deeecdcad167","modified":1635573862633},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"3d16ac0f4ccaeed868c246d4d49bde543d1f62cb","modified":1635573862634},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"b8c816fba0a9b4a35fbae03ba5b1b2da96ba2687","modified":1635573862634},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"49722d555a2edb18094bb2cb3d7336dd72051b93","modified":1635573862636},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"357f825f0a649b2e28cba1481d4c9a0cb402e43a","modified":1635573862637},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"096f908c08ce553e482aadfd3e767a0145191093","modified":1635573862637},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"525242ce9e912c4adfe5134347c67dbdb9e98e3d","modified":1635573862638},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"12f7eaf6b56624cbc411528562d6bb848ff97039","modified":1635573862638},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"b11b04737a1a0fea3bd9f0081d96ee6c015358d4","modified":1635573862639},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"eb64d24ed409d26280bde023f555e5f823094be1","modified":1635577508081},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"098b4bdf49c7300490f959386d5d1185a32543f6","modified":1635573862639},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar.styl","hash":"5d540f683018745a5ed1d6f635df28ea610c1244","modified":1635573862640},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"67a1fcb33535122d41acd24f1f49cf02c89b88fa","modified":1635573862640},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"4079e616fbf36112dec0674c1e0713d1d9769068","modified":1635573862644},{"_id":"themes/next/source/css/_common/scaffolding/highlight/diff.styl","hash":"83bd737f663a8461e66985af8ddbfc0a731fc939","modified":1635573862645},{"_id":"themes/next/source/css/_common/scaffolding/highlight/highlight.styl","hash":"80488259271bcfe38031f4c2e902463daba9336b","modified":1635573862646},{"_id":"themes/next/source/css/_common/scaffolding/highlight/theme.styl","hash":"c911045b2ce9a66e38d9dd30c7ed078abbc10cbf","modified":1635573862648},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"aca7bb220fc14ef2a8f96282d2a95a96a9238d46","modified":1635573862652},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"ceacfa6218f6084c71a230b086e5d2708d29927e","modified":1635573862652},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"8b7aafb911850c73074cdb6cc87abe4ac8c12e99","modified":1635573862653},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"03a5bcecc0b12231462ef6ffe432fa77ee71beff","modified":1635573862654},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"adaf0f580fccf4158169eeaf534a18005b39a760","modified":1635573862653},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"3256e39f281f06751a1c0145d9806a0e56d68170","modified":1635573862654},{"_id":"themes/next/source/css/_common/scaffolding/tags/tags.styl","hash":"51d46fa3c7c6b691c61a2c2b0ac005c97cfbf72b","modified":1635573862655},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-brands-400.woff2","hash":"509988477da79c146cb93fb728405f18e923c2de","modified":1635573862696},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-solid-900.woff2","hash":"75a88815c47a249eadb5f0edc1675957f860cca7","modified":1635573862700},{"_id":"public/lib/pjax/index.js","hash":"0d43f95d9c585a23addf0be7b08d615434ceb336","modified":1635769946277},{"_id":"public/lib/pjax/package.json","hash":"da55143475b12cb91a44aeb5a995c53879fe3326","modified":1635769946277},{"_id":"public/lib/pjax/example/example.js","hash":"48b27c93eb351d2fa91247c35038a9f1627e971a","modified":1635769946277},{"_id":"public/lib/pjax/lib/abort-request.js","hash":"cbae038c94f70163340801cb608f4e503640b88d","modified":1635769946277},{"_id":"public/lib/pjax/lib/eval-script.js","hash":"d5980b3c5f3c1a95427eab0d7d2263324fb72bca","modified":1635769946277},{"_id":"public/lib/pjax/lib/execute-scripts.js","hash":"8c7c18b14c11af7e2d8dd0146b7df428bf8149bb","modified":1635769946277},{"_id":"public/lib/pjax/lib/foreach-els.js","hash":"d8e50967878930891112f4acb46f47697ddc3ad7","modified":1635769946277},{"_id":"public/lib/pjax/lib/foreach-selectors.js","hash":"b11d36344a7a6aa36d533a335785772c9bfb6bc9","modified":1635769946277},{"_id":"public/lib/pjax/lib/is-supported.js","hash":"62ede7268080ab7efddd64fced8b3e79af2901f6","modified":1635769946277},{"_id":"public/lib/pjax/lib/parse-options.js","hash":"054a902e9f350f7414b80f62419da004dd90aa37","modified":1635769946277},{"_id":"public/lib/pjax/lib/send-request.js","hash":"15c341d066b0d60879ef3ca5ff858103381fb378","modified":1635769946277},{"_id":"public/lib/pjax/lib/switches-selectors.js","hash":"f31b4af163db3d9a5b3bb7c7534a4a2dd5543435","modified":1635769946277},{"_id":"public/lib/pjax/lib/switches.js","hash":"d0bfd9e24a93442d2e6092433f9c3aa6c794fd3a","modified":1635769946277},{"_id":"public/lib/pjax/lib/uniqueid.js","hash":"eb127cf8936e5bdcaa7459cf5bd042ff96b5a387","modified":1635769946277},{"_id":"public/lib/pjax/tests/setup.js","hash":"4a9489e72cbe98527931d95d68b68e2d6a9bff6e","modified":1635769946277},{"_id":"public/lib/pjax/lib/events/off.js","hash":"79920b24246e150f1c73511f1a271b93b9c5d9c8","modified":1635769946277},{"_id":"public/lib/pjax/lib/events/on.js","hash":"111fba16cc4ca701aefedea2589c832b60af303d","modified":1635769946277},{"_id":"public/lib/pjax/lib/events/trigger.js","hash":"c05ba73199c5e2c7682655491ed37743bd451751","modified":1635769946277},{"_id":"public/lib/pjax/lib/proto/attach-form.js","hash":"b41c66e58897e6371fbd04cd2b9eb7bae10e0d89","modified":1635769946277},{"_id":"public/lib/pjax/lib/proto/attach-link.js","hash":"d15a61235aa8c1615e60ea34d9bbee834be804d0","modified":1635769946277},{"_id":"public/lib/pjax/lib/proto/handle-response.js","hash":"f68bab958cce4dbbcb91920d7a8aba55b9066b41","modified":1635769946277},{"_id":"public/lib/pjax/lib/proto/log.js","hash":"c728730594aed7d81509787c5bb487af014415e1","modified":1635769946277},{"_id":"public/lib/pjax/lib/proto/parse-element.js","hash":"bafb5e4b9897716624a92ba69458e418116e22f8","modified":1635769946277},{"_id":"public/lib/pjax/lib/util/clone.js","hash":"55027b88e007818c6963205fcd0090a61af8237c","modified":1635769946277},{"_id":"public/lib/pjax/lib/util/extend.js","hash":"e599aaef93e3a00ccbd92cd87df09898d712e398","modified":1635769946277},{"_id":"public/lib/pjax/lib/util/contains.js","hash":"fcc9be0477d941b7c4ba71de328773e556ded7ce","modified":1635769946277},{"_id":"public/lib/pjax/lib/util/noop.js","hash":"2c9f7e231af1a62db195875ca62df7edc253c3c4","modified":1635769946277},{"_id":"public/lib/pjax/lib/util/update-query-string.js","hash":"eefcbff322f8c607865d47ee8fa49f1c8bfa8d7a","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/abort-request.js","hash":"96d7a604ca275455199bd94d16b9cdc254bee9b9","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/eval-scripts.js","hash":"3c9125a04cec9d511f16f9311656533ef6a115d1","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/events.js","hash":"70ca7ec140d1dcf8c4958e7b6788b09ef2b60181","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/foreach-els.js","hash":"85995dd27d0d866cfaf5c560732fab8b0099938c","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/execute-scripts.js","hash":"358ba332a75d646a83a9f68644d0c4d7981098c1","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/foreach-selectors.js","hash":"898b48ef191719070488f16a54fba8a794b10057","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/is-supported.js","hash":"e25c7e69c8b7a64a44affcae317adb2b3889aee6","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/parse-options.js","hash":"45ab302da33e5457a71fd22bbd082e51f5b06b49","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/send-request.js","hash":"d6adad7f95754c53b9885c0999a5118995fdc76f","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/switches.js","hash":"57c77ae3d2fb31bf7659480316c77f1cf54a39a9","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/switch-selectors.js","hash":"993dd67b1b629288feb8d167fb12b602626cf1d5","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/uniqueid.js","hash":"430550f31b9e6356c2e3a033c1b418bd6acd9667","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/proto/attach-form.js","hash":"3614a962e3185b354a2e0d987bcecdef4a209da6","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/proto/handle-response.js","hash":"26e0e334f0b20ff2fe75b3ab12a93ce44a5823f0","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/proto/attach-link.js","hash":"9d283cb0b09730e932673c73a3352a2d2e8939fa","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/proto/parse-element.js","hash":"d3d9d0cb2a23f6fd4b4b77914b026f3e761049a9","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/util/clone.js","hash":"4b0e62bd0f4eef3549b0da70987f63ce4953bef0","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/util/contains.js","hash":"692f766c34309478ebbf624a90b043e820127bac","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/util/noop.js","hash":"6959a4c02c41453a5edfa4163e36752fcfa3edf9","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/util/extend.js","hash":"d45488ff6f8e3e1b59a62d0c88c86b750fe50ed4","modified":1635769946277},{"_id":"public/lib/pjax/tests/lib/util/update-query-string.js","hash":"4158dcd877c5f229400417e0da22eb4c5b8e8e38","modified":1635769946277},{"_id":"public/lib/pjax/pjax.min.js","hash":"f48f9a1fecf86bf7983547c42253c34dd3517574","modified":1635769946277},{"_id":"public/lib/pjax/pjax.js","hash":"9ded740629b18cc07578e93142addff4808787bf","modified":1635769946277},{"_id":"public/search.xml","hash":"7eb92c47d69dc7854682705e531d97bdda01daf1","modified":1635769946277},{"_id":"public/about/index.html","hash":"112cedeae89d4edf148386b0f62ec47c162028fb","modified":1635769946277},{"_id":"public/categories/index.html","hash":"ac85f9c1c601207d9526fc38e2e7fc5b1b22ff94","modified":1635769946277},{"_id":"public/tags/index.html","hash":"69e8cb94ddef3ba24e042906e6cacbecfa0298be","modified":1635769946277},{"_id":"public/lib/pjax/example/index.html","hash":"4e2a8925b32eb7ad345aadb0a40eea140dd12fdd","modified":1635769946277},{"_id":"public/lib/pjax/example/page3.html","hash":"11e4feeb18d7f7d17f72bc5bbbc1bf7bec9b3d6b","modified":1635769946277},{"_id":"public/lib/pjax/example/page2.html","hash":"2fc296835be1ab000fba96de342074481383f3d0","modified":1635769946277},{"_id":"public/archives/index.html","hash":"02d0f11be80dd050fb30679d309c190d0a4dfa9f","modified":1635769946277},{"_id":"public/archives/2021/index.html","hash":"9499d9bb4b7e4a5453e53c3902a516fcabb6acd2","modified":1635769946277},{"_id":"public/archives/2021/11/index.html","hash":"cc8a03ee4b0c5cc54fa90563534080e1ccdead52","modified":1635769946277},{"_id":"public/categories/webpack/index.html","hash":"f012d1cbc086a45883c9de98dc1f1e9fdada687b","modified":1635769946277},{"_id":"public/index.html","hash":"1bf74c0bf4a22a6b73bdac9646f92f72ecfe0d59","modified":1635769946277},{"_id":"public/tags/webpack/index.html","hash":"e6c117d71e2116d7c91d4a75adb47d0a87ead4e4","modified":1635769946277},{"_id":"public/lib/pjax/CHANGELOG.html","hash":"d03ee7275c177a0c9c055cc55ffe452403f08c3d","modified":1635769946277},{"_id":"public/lib/pjax/example/forms.html","hash":"f5a048de45a34ddbe8e8a00435dd94924501767a","modified":1635769946277},{"_id":"public/2021/11/01/webpack/index.html","hash":"195af9b12f2f39ae222348fa7bded6f68e3d0c00","modified":1635769946277},{"_id":"public/lib/pjax/LICENSE","hash":"0cadc79604daeacf95062d1e5ccd43edbfaed836","modified":1635769946277},{"_id":"public/lib/pjax/index.d.ts","hash":"b90fe99fe90ee7024d760467e75565da561f7ccd","modified":1635769946277},{"_id":"public/lib/pjax/tests/test.ts","hash":"3a5222592fc1883ba6d07fbb2095e4bb4866e9d9","modified":1635769946277},{"_id":"public/images/algolia_logo.svg","hash":"45eeea0b5fba833e21e38ea10ed5ab385ceb4f01","modified":1635769946277},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1635769946277},{"_id":"public/images/avatar.jpg","hash":"bf9b5a40213ee491994b8f981a220d42f7c162a5","modified":1635769946277},{"_id":"public/images/cc-by-nc-nd.svg","hash":"bc3588c9b2d7c68830524783120ff6cf957cf668","modified":1635769946277},{"_id":"public/images/cc-by-nc-sa.svg","hash":"6f55543d1fb9cbc436c101d24f802dec7b41efc3","modified":1635769946277},{"_id":"public/images/cc-by-nc.svg","hash":"6f076713fb9bf934aa2c1046bdf2cf2e37bc1eab","modified":1635769946277},{"_id":"public/images/cc-by-nd.svg","hash":"42cd73da328077ccc92f859bb8f3cf621b3484f8","modified":1635769946277},{"_id":"public/images/cc-by-sa.svg","hash":"70c1535f43e54e5ff35ca81419e77e4c0c301398","modified":1635769946277},{"_id":"public/images/cc-by.svg","hash":"e92a33c32d1dac8ed94849b2b4e6456e887efe70","modified":1635769946277},{"_id":"public/images/cc-zero.svg","hash":"9bfb52b2f63527a7049247bf00d44e6dc1170e7d","modified":1635769946277},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1635769946277},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1635769946277},{"_id":"public/images/logo.svg","hash":"169f56fd82941591dad3abd734a50ec7259be950","modified":1635769946277},{"_id":"public/lib/font-awesome/webfonts/fa-regular-400.woff2","hash":"260bb01acd44d88dcb7f501a238ab968f86bef9e","modified":1635769946277},{"_id":"public/2021/11/01/webpack/webpack-1.png","hash":"72ee00932ec7530b11c7cf90700e77d76ec8104c","modified":1635769946277},{"_id":"public/2021/11/01/webpack/webpack-2.png","hash":"4788a42f1aa2063fa0fba15c631838b54b5257d1","modified":1635769946277},{"_id":"public/lib/font-awesome/webfonts/fa-brands-400.woff2","hash":"509988477da79c146cb93fb728405f18e923c2de","modified":1635769946277},{"_id":"public/lib/font-awesome/webfonts/fa-solid-900.woff2","hash":"75a88815c47a249eadb5f0edc1675957f860cca7","modified":1635769946277},{"_id":"public/js/bookmark.js","hash":"9734ebcb9b83489686f5c2da67dc9e6157e988ad","modified":1635769946277},{"_id":"public/js/algolia-search.js","hash":"498d233eb5c7af6940baf94c1a1c36fdf1dd2636","modified":1635769946277},{"_id":"public/js/local-search.js","hash":"35ccf100d8f9c0fd6bfbb7fa88c2a76c42a69110","modified":1635769946277},{"_id":"public/js/motion.js","hash":"72df86f6dfa29cce22abeff9d814c9dddfcf13a9","modified":1635769946277},{"_id":"public/js/next-boot.js","hash":"a1b0636423009d4a4e4cea97bcbf1842bfab582c","modified":1635769946277},{"_id":"public/js/schemes/muse.js","hash":"1eb9b88103ddcf8827b1a7cbc56471a9c5592d53","modified":1635769946277},{"_id":"public/js/schemes/pisces.js","hash":"0ac5ce155bc58c972fe21c4c447f85e6f8755c62","modified":1635769946277},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1635769946277},{"_id":"public/css/main.css","hash":"e1e89789eb25c1bdf229587aa4ddc332a3605d93","modified":1635769946277},{"_id":"public/js/utils.js","hash":"730cca7f164eaf258661a61ff3f769851ff1e5da","modified":1635769946277},{"_id":"public/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1635769946277},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1635769946277},{"_id":"public/lib/font-awesome/css/all.min.css","hash":"0038dc97c79451578b7bd48af60ba62282b4082b","modified":1635769946277}],"Category":[{"name":"webpack","_id":"ckvgn6y8a001onwlwdeeeagxn"}],"Data":[],"Page":[{"title":"about","date":"2021-10-30T07:52:46.000Z","type":"about","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2021-10-30 15:52:46\ntype: about\n---\n","updated":"2021-10-30T07:56:32.276Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckvgn6y3h0000nwlwhebg5ozt","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"categories","date":"2021-10-30T07:53:18.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2021-10-30 15:53:18\ntype: categories\n---\n","updated":"2021-10-30T07:56:54.550Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckvgn6y3m0001nwlwfy7j3n6f","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","date":"2021-10-30T07:53:29.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2021-10-30 15:53:29\ntype: tags\n---\n","updated":"2021-10-30T07:56:54.548Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckvgn6y3o0002nwlw5syy6i0c","content":"","site":{"data":{}},"excerpt":"","more":""},{"_content":"# 0.2.8 - 2019-03-09\n\n- Fixed: Edge form support.\n  ([#178](https://github.com/MoOx/pjax/pull/178) - @robinnorth)\n- Fixed: Removed keyup event listener for forms.\n  ([#184](https://github.com/MoOx/pjax/pull/184) - @BehindTheMath)\n- Fixed: Bugs in evalScripts().\n  ([#186](https://github.com/MoOx/pjax/pull/186) - @BehindTheMath)\n- Fixed: Handle non-string HTML passed to loadContent().\n  ([#200](https://github.com/MoOx/pjax/pull/200) - @BehindTheMath)\n- Tooling: Switch linting to ESLint and Prettier.\n  ([#191](https://github.com/MoOx/pjax/pull/191) - @BehindTheMath)\n\n# 0.2.7 - 2018-08-15\n\n- Fixed: Parsing values of option elements in forms.\n  ([#162](https://github.com/MoOx/pjax/pull/162) - @BehindTheMath)\n- Fixed: Added index.d.ts to package.json so it will be installed by npm.\n  ([c589ab9](https://github.com/MoOx/pjax/commit/c589ab9c25bee6161bf3e557eaca44e51c14fb89) - @BehindTheMath)\n- Fixed: `options.history` to correctly parse being set to false.\n  ([#165](https://github.com/MoOx/pjax/pull/165) - @BehindTheMath).\n- Fixed: Pass the current `options` object to `loadContent()`.\n  ([#171](https://github.com/MoOx/pjax/pull/171) - @BehindTheMath)\n- Fixed: Ensure correct XHR encoding for multipart/form-data forms\n  ([#174](https://github.com/MoOx/pjax/pull/174) - @BehindTheMath)\n- Added: More documentation.\n  ([#160](https://github.com/MoOx/pjax/pull/160), [#171](https://github.com/MoOx/pjax/pull/171) - @robinnorth, @BehindTheMath)\n\n# 0.2.6 - 2018-04-30\n\n- Fixed: Form submission for GET requests.\n  ([#129](https://github.com/MoOx/pjax/pull/129) - @robinnorth)\n- Fixed: Refactor `loadUrl()` to make manually calling simpler.\n  ([#134](https://github.com/MoOx/pjax/pull/134) - @robinnorth)\n- Fixed: Support multiple select fields in form submissions.\n  ([#147](https://github.com/MoOx/pjax/pull/147) - @robinnorth)\n- Fixed: Use the same options object in `handle-response` as in `send-request`. This way, `pjax.state.options` will also have the request options.\n  ([#148](https://github.com/MoOx/pjax/pull/148) - @BehindTheMath)\n- Added: Move the XHR callback to a separate method, and trigger an error event if the response cannot be parsed.\n  ([#137](https://github.com/MoOx/pjax/pull/137) - @BehindTheMath)\n- Added: TypeScript definitions.\n  ([#138](https://github.com/MoOx/pjax/pull/138) - @BehindTheMath)\n- Added: `replaceNode` switch, as an alternative to the `outerHTML` switch.\n  ([#141](https://github.com/MoOx/pjax/pull/141) - @BehindTheMath)\n- Added: `X-PJAX-Selectors` HTTP header. This is a serialized JSON array of selectors, taken from `options.selectors`. You can use this to send back only the elements that Pjax will use to switch, instead of sending the whole page.\n  ([#144](https://github.com/MoOx/pjax/pull/144) - @BehindTheMath)\n- Added: An option to use `FormData` to submit forms.\n  ([#153](https://github.com/MoOx/pjax/pull/153) - @BehindTheMath)\n- Added: Tests.\n  ([f98f2dd](https://github.com/MoOx/pjax/commit/f98f2dd63b48113ff91b6bd8808257bfc723ef6b), [#145](https://github.com/MoOx/pjax/pull/145) - @robinnorth, @BehindTheMath)\n\n# 0.2.5 - 2018-02-02\n\n- Fixed: Async switch functions now work correctly, because the DOM is now parsed after all the switches finish.\n  ([#79](https://github.com/MoOx/pjax/pull/79), [#110](https://github.com/MoOx/pjax/pull/110) - @oskarrough, @BehindTheMath, @robinnorth)\n- Fixed: Bug on IE11 preventing AJAX page refresh.\n  ([#81](https://github.com/MoOx/pjax/pull/81) - @CPTechnikVX)\n- Fixed: Default switches are now available as `Pjax.switches`.\n  ([#92](https://github.com/MoOx/pjax/pull/92) - @BehindTheMath)\n- Fixed: An error that was caused by a missing `switchElementsAlt`.\n  ([#93](https://github.com/MoOx/pjax/pull/93), [#104](https://github.com/MoOx/pjax/pull/104) - @BehindTheMath, @robinnorth)\n- Fixed: Incorrect `main` field in npm package\n  ([#105](https://github.com/MoOx/pjax/pull/105) - @robinnorth)\n- Fixed: A pending XHR is now aborted if the user navigates somewhere else before the request is finished.\n  ([#114](https://github.com/MoOx/pjax/pull/114) - @robinnorth)\n- Fixed: When rendering new content, focus will now be removed only from elements within one of the containers manipulated by Pjax.\n  ([#116](https://github.com/MoOx/pjax/pull/116) - @BehindTheMath)\n- Fixed: Stop dispatching extraneous `pjax:complete` events when external scripts load\n  ([#118](https://github.com/MoOx/pjax/pull/118) - @robinnorth)\n- Added: Send the `X-PJAX` header with XHR requests.\n  ([#80](https://github.com/MoOx/pjax/pull/80) - @bram1028)\n- Added: Direct download link for script tags. (@MoOx)\n- Added: Pass the element that triggered Pjax to the `pjax:send` event.\n  ([#94](https://github.com/MoOx/pjax/pull/94) - @BehindTheMath)\n- Added: An option to set a timeout for XHR requests.\n  ([#95](https://github.com/MoOx/pjax/pull/95) - @BehindTheMath)\n- Added: Checks for XHR redirects\n  ([#101](https://github.com/MoOx/pjax/pull/101) - @BehindTheMath)\n- Added: Save scroll position with history, and restore when navigating backwards or forwards.\n  ([#110](https://github.com/MoOx/pjax/pull/110), [#119](https://github.com/MoOx/pjax/pull/119) - @BehindTheMath, @robinnorth)\n- Added: Scroll to element position when URL contains a hash\n  ([#110](https://github.com/MoOx/pjax/pull/110) - @BehindTheMath)\n- Added: Minified version of the Pjax bundle.\n  ([#115](https://github.com/MoOx/pjax/pull/115) - @BehindTheMath)\n- Changed: Miscellaneous code and tests cleanup.\n  ([#96](https://github.com/MoOx/pjax/pull/96), [#98](https://github.com/MoOx/pjax/pull/98), [#99](https://github.com/MoOx/pjax/pull/99), [#100](https://github.com/MoOx/pjax/pull/1070), [#107](https://github.com/MoOx/pjax/pull/107), [#113](https://github.com/MoOx/pjax/pull/113), [#120](https://github.com/MoOx/pjax/pull/120) - @BehindTheMath, @MoOx, @robinnorth)\n\n# 0.2.4 - 2016-06-28\n\n- Fixed: ``refresh`` should now work (use `this.parseDOM` for refresh)\n  ([#67](https://github.com/MoOx/pjax/pull/67) - @compressed)\n- Fixed: Some attributes, such as `itemscope` have no corresponding value.\n  This change allows them to still be set.\n  ([#67](https://github.com/MoOx/pjax/pull/67) - @compressed)\n- Added: ``cacheBust`` option\n  ([#71](https://github.com/MoOx/pjax/pull/71) - @tremby)\n\n# 0.2.3 - 2016-03-24\n\n- Fixed: ``currentUrlFullReload`` option now works\n- Fixed: ``this.reload`` is now a Function\n  ([#65](https://github.com/MoOx/pjax/issues/65))\n\n# 0.2.2 - 2016-03-12\n\n- Fixed: added back standalone version in `./pjax.js`\n([#57](https://github.com/MoOx/pjax/issues/57)\n- Fixed: error when using pjax with google analytics (``options`` was undefined)\n([#59](https://github.com/MoOx/pjax/pull/59))\n- Fixed: HierarchyRequestError error\n([#49](https://github.com/MoOx/pjax/pull/49))\n- Fixed: ``TypeError: Pjax.forEachEls is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Fixed: ``TypeError: Pjax.executeScripts is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Fixed: ``TypeError: Pjax.clone is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Added: Ignore events with prevented defaults\n([#50](https://github.com/MoOx/pjax/pull/50))\n\n# 0.2.1 - 2015-02-04\n\n- Fixed: it's better when a release have actual files.\n\n# 0.2.0 - 2015-02-04\n\n- Fixed: prevent scrollTo from being converted from false to 0 ([#33](https://github.com/MoOx/pjax/pull/33))\n- Changed: code exploded in commonjs style\n- Added: lots of tests\n- Added: `refresh` method to force update a DOM element ([#36](https://github.com/MoOx/pjax/pull/36))\n\n# 0.1.4 - 2014-10-14\n\n- Fixed: allow to load pages without any attributes on `<html>` element (fix [#6](https://github.com/MoOx/pjax/issues/6))\n- Fixed: make `Pjax.switches.sideBySide` method usable (fix [#13](https://github.com/MoOx/pjax/issues/13))\n\n# 0.1.3 - 2014-09-16\n\n- Fixed: clicking on the current url somewhere does not produce a full reload by default (see option `currentUrlFullReload`)\n- Fixed: `document.implementation.createHTMLDocument` error (in IE10, ref [#16](https://github.com/MoOx/pjax/pull/16))\n\n# 0.1.2 - 2014-04-03\n\n- Changed: `pjax.js` relocated in `src/`\n- Fixed: `<html>` attributes of pjaxified document are now available\n\n# 0.1.1 - 2014-04-02\n\n- Fixed: safer UMD wrapper (fix concat issue)\n\n# 0.1.0 - 2014-03-24\n\n✨ Initial release\n","source":"lib/pjax/CHANGELOG.md","raw":"# 0.2.8 - 2019-03-09\n\n- Fixed: Edge form support.\n  ([#178](https://github.com/MoOx/pjax/pull/178) - @robinnorth)\n- Fixed: Removed keyup event listener for forms.\n  ([#184](https://github.com/MoOx/pjax/pull/184) - @BehindTheMath)\n- Fixed: Bugs in evalScripts().\n  ([#186](https://github.com/MoOx/pjax/pull/186) - @BehindTheMath)\n- Fixed: Handle non-string HTML passed to loadContent().\n  ([#200](https://github.com/MoOx/pjax/pull/200) - @BehindTheMath)\n- Tooling: Switch linting to ESLint and Prettier.\n  ([#191](https://github.com/MoOx/pjax/pull/191) - @BehindTheMath)\n\n# 0.2.7 - 2018-08-15\n\n- Fixed: Parsing values of option elements in forms.\n  ([#162](https://github.com/MoOx/pjax/pull/162) - @BehindTheMath)\n- Fixed: Added index.d.ts to package.json so it will be installed by npm.\n  ([c589ab9](https://github.com/MoOx/pjax/commit/c589ab9c25bee6161bf3e557eaca44e51c14fb89) - @BehindTheMath)\n- Fixed: `options.history` to correctly parse being set to false.\n  ([#165](https://github.com/MoOx/pjax/pull/165) - @BehindTheMath).\n- Fixed: Pass the current `options` object to `loadContent()`.\n  ([#171](https://github.com/MoOx/pjax/pull/171) - @BehindTheMath)\n- Fixed: Ensure correct XHR encoding for multipart/form-data forms\n  ([#174](https://github.com/MoOx/pjax/pull/174) - @BehindTheMath)\n- Added: More documentation.\n  ([#160](https://github.com/MoOx/pjax/pull/160), [#171](https://github.com/MoOx/pjax/pull/171) - @robinnorth, @BehindTheMath)\n\n# 0.2.6 - 2018-04-30\n\n- Fixed: Form submission for GET requests.\n  ([#129](https://github.com/MoOx/pjax/pull/129) - @robinnorth)\n- Fixed: Refactor `loadUrl()` to make manually calling simpler.\n  ([#134](https://github.com/MoOx/pjax/pull/134) - @robinnorth)\n- Fixed: Support multiple select fields in form submissions.\n  ([#147](https://github.com/MoOx/pjax/pull/147) - @robinnorth)\n- Fixed: Use the same options object in `handle-response` as in `send-request`. This way, `pjax.state.options` will also have the request options.\n  ([#148](https://github.com/MoOx/pjax/pull/148) - @BehindTheMath)\n- Added: Move the XHR callback to a separate method, and trigger an error event if the response cannot be parsed.\n  ([#137](https://github.com/MoOx/pjax/pull/137) - @BehindTheMath)\n- Added: TypeScript definitions.\n  ([#138](https://github.com/MoOx/pjax/pull/138) - @BehindTheMath)\n- Added: `replaceNode` switch, as an alternative to the `outerHTML` switch.\n  ([#141](https://github.com/MoOx/pjax/pull/141) - @BehindTheMath)\n- Added: `X-PJAX-Selectors` HTTP header. This is a serialized JSON array of selectors, taken from `options.selectors`. You can use this to send back only the elements that Pjax will use to switch, instead of sending the whole page.\n  ([#144](https://github.com/MoOx/pjax/pull/144) - @BehindTheMath)\n- Added: An option to use `FormData` to submit forms.\n  ([#153](https://github.com/MoOx/pjax/pull/153) - @BehindTheMath)\n- Added: Tests.\n  ([f98f2dd](https://github.com/MoOx/pjax/commit/f98f2dd63b48113ff91b6bd8808257bfc723ef6b), [#145](https://github.com/MoOx/pjax/pull/145) - @robinnorth, @BehindTheMath)\n\n# 0.2.5 - 2018-02-02\n\n- Fixed: Async switch functions now work correctly, because the DOM is now parsed after all the switches finish.\n  ([#79](https://github.com/MoOx/pjax/pull/79), [#110](https://github.com/MoOx/pjax/pull/110) - @oskarrough, @BehindTheMath, @robinnorth)\n- Fixed: Bug on IE11 preventing AJAX page refresh.\n  ([#81](https://github.com/MoOx/pjax/pull/81) - @CPTechnikVX)\n- Fixed: Default switches are now available as `Pjax.switches`.\n  ([#92](https://github.com/MoOx/pjax/pull/92) - @BehindTheMath)\n- Fixed: An error that was caused by a missing `switchElementsAlt`.\n  ([#93](https://github.com/MoOx/pjax/pull/93), [#104](https://github.com/MoOx/pjax/pull/104) - @BehindTheMath, @robinnorth)\n- Fixed: Incorrect `main` field in npm package\n  ([#105](https://github.com/MoOx/pjax/pull/105) - @robinnorth)\n- Fixed: A pending XHR is now aborted if the user navigates somewhere else before the request is finished.\n  ([#114](https://github.com/MoOx/pjax/pull/114) - @robinnorth)\n- Fixed: When rendering new content, focus will now be removed only from elements within one of the containers manipulated by Pjax.\n  ([#116](https://github.com/MoOx/pjax/pull/116) - @BehindTheMath)\n- Fixed: Stop dispatching extraneous `pjax:complete` events when external scripts load\n  ([#118](https://github.com/MoOx/pjax/pull/118) - @robinnorth)\n- Added: Send the `X-PJAX` header with XHR requests.\n  ([#80](https://github.com/MoOx/pjax/pull/80) - @bram1028)\n- Added: Direct download link for script tags. (@MoOx)\n- Added: Pass the element that triggered Pjax to the `pjax:send` event.\n  ([#94](https://github.com/MoOx/pjax/pull/94) - @BehindTheMath)\n- Added: An option to set a timeout for XHR requests.\n  ([#95](https://github.com/MoOx/pjax/pull/95) - @BehindTheMath)\n- Added: Checks for XHR redirects\n  ([#101](https://github.com/MoOx/pjax/pull/101) - @BehindTheMath)\n- Added: Save scroll position with history, and restore when navigating backwards or forwards.\n  ([#110](https://github.com/MoOx/pjax/pull/110), [#119](https://github.com/MoOx/pjax/pull/119) - @BehindTheMath, @robinnorth)\n- Added: Scroll to element position when URL contains a hash\n  ([#110](https://github.com/MoOx/pjax/pull/110) - @BehindTheMath)\n- Added: Minified version of the Pjax bundle.\n  ([#115](https://github.com/MoOx/pjax/pull/115) - @BehindTheMath)\n- Changed: Miscellaneous code and tests cleanup.\n  ([#96](https://github.com/MoOx/pjax/pull/96), [#98](https://github.com/MoOx/pjax/pull/98), [#99](https://github.com/MoOx/pjax/pull/99), [#100](https://github.com/MoOx/pjax/pull/1070), [#107](https://github.com/MoOx/pjax/pull/107), [#113](https://github.com/MoOx/pjax/pull/113), [#120](https://github.com/MoOx/pjax/pull/120) - @BehindTheMath, @MoOx, @robinnorth)\n\n# 0.2.4 - 2016-06-28\n\n- Fixed: ``refresh`` should now work (use `this.parseDOM` for refresh)\n  ([#67](https://github.com/MoOx/pjax/pull/67) - @compressed)\n- Fixed: Some attributes, such as `itemscope` have no corresponding value.\n  This change allows them to still be set.\n  ([#67](https://github.com/MoOx/pjax/pull/67) - @compressed)\n- Added: ``cacheBust`` option\n  ([#71](https://github.com/MoOx/pjax/pull/71) - @tremby)\n\n# 0.2.3 - 2016-03-24\n\n- Fixed: ``currentUrlFullReload`` option now works\n- Fixed: ``this.reload`` is now a Function\n  ([#65](https://github.com/MoOx/pjax/issues/65))\n\n# 0.2.2 - 2016-03-12\n\n- Fixed: added back standalone version in `./pjax.js`\n([#57](https://github.com/MoOx/pjax/issues/57)\n- Fixed: error when using pjax with google analytics (``options`` was undefined)\n([#59](https://github.com/MoOx/pjax/pull/59))\n- Fixed: HierarchyRequestError error\n([#49](https://github.com/MoOx/pjax/pull/49))\n- Fixed: ``TypeError: Pjax.forEachEls is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Fixed: ``TypeError: Pjax.executeScripts is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Fixed: ``TypeError: Pjax.clone is not a function``\n([#52](https://github.com/MoOx/pjax/pull/52))\n- Added: Ignore events with prevented defaults\n([#50](https://github.com/MoOx/pjax/pull/50))\n\n# 0.2.1 - 2015-02-04\n\n- Fixed: it's better when a release have actual files.\n\n# 0.2.0 - 2015-02-04\n\n- Fixed: prevent scrollTo from being converted from false to 0 ([#33](https://github.com/MoOx/pjax/pull/33))\n- Changed: code exploded in commonjs style\n- Added: lots of tests\n- Added: `refresh` method to force update a DOM element ([#36](https://github.com/MoOx/pjax/pull/36))\n\n# 0.1.4 - 2014-10-14\n\n- Fixed: allow to load pages without any attributes on `<html>` element (fix [#6](https://github.com/MoOx/pjax/issues/6))\n- Fixed: make `Pjax.switches.sideBySide` method usable (fix [#13](https://github.com/MoOx/pjax/issues/13))\n\n# 0.1.3 - 2014-09-16\n\n- Fixed: clicking on the current url somewhere does not produce a full reload by default (see option `currentUrlFullReload`)\n- Fixed: `document.implementation.createHTMLDocument` error (in IE10, ref [#16](https://github.com/MoOx/pjax/pull/16))\n\n# 0.1.2 - 2014-04-03\n\n- Changed: `pjax.js` relocated in `src/`\n- Fixed: `<html>` attributes of pjaxified document are now available\n\n# 0.1.1 - 2014-04-02\n\n- Fixed: safer UMD wrapper (fix concat issue)\n\n# 0.1.0 - 2014-03-24\n\n✨ Initial release\n","date":"2021-10-30T06:38:12.546Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/CHANGELOG.html","title":"","comments":1,"layout":"page","_id":"ckvgn6y3r0003nwlw4rkgaev4","content":"<h1 id=\"0-2-8-2019-03-09\"><a href=\"#0-2-8-2019-03-09\" class=\"headerlink\" title=\"0.2.8 - 2019-03-09\"></a>0.2.8 - 2019-03-09</h1><ul>\n<li>Fixed: Edge form support.<br>(<a href=\"https://github.com/MoOx/pjax/pull/178\">#178</a> - @robinnorth)</li>\n<li>Fixed: Removed keyup event listener for forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/184\">#184</a> - @BehindTheMath)</li>\n<li>Fixed: Bugs in evalScripts().<br>(<a href=\"https://github.com/MoOx/pjax/pull/186\">#186</a> - @BehindTheMath)</li>\n<li>Fixed: Handle non-string HTML passed to loadContent().<br>(<a href=\"https://github.com/MoOx/pjax/pull/200\">#200</a> - @BehindTheMath)</li>\n<li>Tooling: Switch linting to ESLint and Prettier.<br>(<a href=\"https://github.com/MoOx/pjax/pull/191\">#191</a> - @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-7-2018-08-15\"><a href=\"#0-2-7-2018-08-15\" class=\"headerlink\" title=\"0.2.7 - 2018-08-15\"></a>0.2.7 - 2018-08-15</h1><ul>\n<li>Fixed: Parsing values of option elements in forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/162\">#162</a> - @BehindTheMath)</li>\n<li>Fixed: Added index.d.ts to package.json so it will be installed by npm.<br>(<a href=\"https://github.com/MoOx/pjax/commit/c589ab9c25bee6161bf3e557eaca44e51c14fb89\">c589ab9</a> - @BehindTheMath)</li>\n<li>Fixed: <code>options.history</code> to correctly parse being set to false.<br>(<a href=\"https://github.com/MoOx/pjax/pull/165\">#165</a> - @BehindTheMath).</li>\n<li>Fixed: Pass the current <code>options</code> object to <code>loadContent()</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/171\">#171</a> - @BehindTheMath)</li>\n<li>Fixed: Ensure correct XHR encoding for multipart/form-data forms<br>(<a href=\"https://github.com/MoOx/pjax/pull/174\">#174</a> - @BehindTheMath)</li>\n<li>Added: More documentation.<br>(<a href=\"https://github.com/MoOx/pjax/pull/160\">#160</a>, <a href=\"https://github.com/MoOx/pjax/pull/171\">#171</a> - @robinnorth, @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-6-2018-04-30\"><a href=\"#0-2-6-2018-04-30\" class=\"headerlink\" title=\"0.2.6 - 2018-04-30\"></a>0.2.6 - 2018-04-30</h1><ul>\n<li>Fixed: Form submission for GET requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/129\">#129</a> - @robinnorth)</li>\n<li>Fixed: Refactor <code>loadUrl()</code> to make manually calling simpler.<br>(<a href=\"https://github.com/MoOx/pjax/pull/134\">#134</a> - @robinnorth)</li>\n<li>Fixed: Support multiple select fields in form submissions.<br>(<a href=\"https://github.com/MoOx/pjax/pull/147\">#147</a> - @robinnorth)</li>\n<li>Fixed: Use the same options object in <code>handle-response</code> as in <code>send-request</code>. This way, <code>pjax.state.options</code> will also have the request options.<br>(<a href=\"https://github.com/MoOx/pjax/pull/148\">#148</a> - @BehindTheMath)</li>\n<li>Added: Move the XHR callback to a separate method, and trigger an error event if the response cannot be parsed.<br>(<a href=\"https://github.com/MoOx/pjax/pull/137\">#137</a> - @BehindTheMath)</li>\n<li>Added: TypeScript definitions.<br>(<a href=\"https://github.com/MoOx/pjax/pull/138\">#138</a> - @BehindTheMath)</li>\n<li>Added: <code>replaceNode</code> switch, as an alternative to the <code>outerHTML</code> switch.<br>(<a href=\"https://github.com/MoOx/pjax/pull/141\">#141</a> - @BehindTheMath)</li>\n<li>Added: <code>X-PJAX-Selectors</code> HTTP header. This is a serialized JSON array of selectors, taken from <code>options.selectors</code>. You can use this to send back only the elements that Pjax will use to switch, instead of sending the whole page.<br>(<a href=\"https://github.com/MoOx/pjax/pull/144\">#144</a> - @BehindTheMath)</li>\n<li>Added: An option to use <code>FormData</code> to submit forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/153\">#153</a> - @BehindTheMath)</li>\n<li>Added: Tests.<br>(<a href=\"https://github.com/MoOx/pjax/commit/f98f2dd63b48113ff91b6bd8808257bfc723ef6b\">f98f2dd</a>, <a href=\"https://github.com/MoOx/pjax/pull/145\">#145</a> - @robinnorth, @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-5-2018-02-02\"><a href=\"#0-2-5-2018-02-02\" class=\"headerlink\" title=\"0.2.5 - 2018-02-02\"></a>0.2.5 - 2018-02-02</h1><ul>\n<li>Fixed: Async switch functions now work correctly, because the DOM is now parsed after all the switches finish.<br>(<a href=\"https://github.com/MoOx/pjax/pull/79\">#79</a>, <a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a> - @oskarrough, @BehindTheMath, @robinnorth)</li>\n<li>Fixed: Bug on IE11 preventing AJAX page refresh.<br>(<a href=\"https://github.com/MoOx/pjax/pull/81\">#81</a> - @CPTechnikVX)</li>\n<li>Fixed: Default switches are now available as <code>Pjax.switches</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/92\">#92</a> - @BehindTheMath)</li>\n<li>Fixed: An error that was caused by a missing <code>switchElementsAlt</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/93\">#93</a>, <a href=\"https://github.com/MoOx/pjax/pull/104\">#104</a> - @BehindTheMath, @robinnorth)</li>\n<li>Fixed: Incorrect <code>main</code> field in npm package<br>(<a href=\"https://github.com/MoOx/pjax/pull/105\">#105</a> - @robinnorth)</li>\n<li>Fixed: A pending XHR is now aborted if the user navigates somewhere else before the request is finished.<br>(<a href=\"https://github.com/MoOx/pjax/pull/114\">#114</a> - @robinnorth)</li>\n<li>Fixed: When rendering new content, focus will now be removed only from elements within one of the containers manipulated by Pjax.<br>(<a href=\"https://github.com/MoOx/pjax/pull/116\">#116</a> - @BehindTheMath)</li>\n<li>Fixed: Stop dispatching extraneous <code>pjax:complete</code> events when external scripts load<br>(<a href=\"https://github.com/MoOx/pjax/pull/118\">#118</a> - @robinnorth)</li>\n<li>Added: Send the <code>X-PJAX</code> header with XHR requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/80\">#80</a> - @bram1028)</li>\n<li>Added: Direct download link for script tags. (@MoOx)</li>\n<li>Added: Pass the element that triggered Pjax to the <code>pjax:send</code> event.<br>(<a href=\"https://github.com/MoOx/pjax/pull/94\">#94</a> - @BehindTheMath)</li>\n<li>Added: An option to set a timeout for XHR requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/95\">#95</a> - @BehindTheMath)</li>\n<li>Added: Checks for XHR redirects<br>(<a href=\"https://github.com/MoOx/pjax/pull/101\">#101</a> - @BehindTheMath)</li>\n<li>Added: Save scroll position with history, and restore when navigating backwards or forwards.<br>(<a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a>, <a href=\"https://github.com/MoOx/pjax/pull/119\">#119</a> - @BehindTheMath, @robinnorth)</li>\n<li>Added: Scroll to element position when URL contains a hash<br>(<a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a> - @BehindTheMath)</li>\n<li>Added: Minified version of the Pjax bundle.<br>(<a href=\"https://github.com/MoOx/pjax/pull/115\">#115</a> - @BehindTheMath)</li>\n<li>Changed: Miscellaneous code and tests cleanup.<br>(<a href=\"https://github.com/MoOx/pjax/pull/96\">#96</a>, <a href=\"https://github.com/MoOx/pjax/pull/98\">#98</a>, <a href=\"https://github.com/MoOx/pjax/pull/99\">#99</a>, <a href=\"https://github.com/MoOx/pjax/pull/1070\">#100</a>, <a href=\"https://github.com/MoOx/pjax/pull/107\">#107</a>, <a href=\"https://github.com/MoOx/pjax/pull/113\">#113</a>, <a href=\"https://github.com/MoOx/pjax/pull/120\">#120</a> - @BehindTheMath, @MoOx, @robinnorth)</li>\n</ul>\n<h1 id=\"0-2-4-2016-06-28\"><a href=\"#0-2-4-2016-06-28\" class=\"headerlink\" title=\"0.2.4 - 2016-06-28\"></a>0.2.4 - 2016-06-28</h1><ul>\n<li>Fixed: <code>refresh</code> should now work (use <code>this.parseDOM</code> for refresh)<br>(<a href=\"https://github.com/MoOx/pjax/pull/67\">#67</a> - @compressed)</li>\n<li>Fixed: Some attributes, such as <code>itemscope</code> have no corresponding value.<br>This change allows them to still be set.<br>(<a href=\"https://github.com/MoOx/pjax/pull/67\">#67</a> - @compressed)</li>\n<li>Added: <code>cacheBust</code> option<br>(<a href=\"https://github.com/MoOx/pjax/pull/71\">#71</a> - @tremby)</li>\n</ul>\n<h1 id=\"0-2-3-2016-03-24\"><a href=\"#0-2-3-2016-03-24\" class=\"headerlink\" title=\"0.2.3 - 2016-03-24\"></a>0.2.3 - 2016-03-24</h1><ul>\n<li>Fixed: <code>currentUrlFullReload</code> option now works</li>\n<li>Fixed: <code>this.reload</code> is now a Function<br>(<a href=\"https://github.com/MoOx/pjax/issues/65\">#65</a>)</li>\n</ul>\n<h1 id=\"0-2-2-2016-03-12\"><a href=\"#0-2-2-2016-03-12\" class=\"headerlink\" title=\"0.2.2 - 2016-03-12\"></a>0.2.2 - 2016-03-12</h1><ul>\n<li>Fixed: added back standalone version in <code>./pjax.js</code><br>(<a href=\"https://github.com/MoOx/pjax/issues/57\">#57</a></li>\n<li>Fixed: error when using pjax with google analytics (<code>options</code> was undefined)<br>(<a href=\"https://github.com/MoOx/pjax/pull/59\">#59</a>)</li>\n<li>Fixed: HierarchyRequestError error<br>(<a href=\"https://github.com/MoOx/pjax/pull/49\">#49</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.forEachEls is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.executeScripts is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.clone is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Added: Ignore events with prevented defaults<br>(<a href=\"https://github.com/MoOx/pjax/pull/50\">#50</a>)</li>\n</ul>\n<h1 id=\"0-2-1-2015-02-04\"><a href=\"#0-2-1-2015-02-04\" class=\"headerlink\" title=\"0.2.1 - 2015-02-04\"></a>0.2.1 - 2015-02-04</h1><ul>\n<li>Fixed: it’s better when a release have actual files.</li>\n</ul>\n<h1 id=\"0-2-0-2015-02-04\"><a href=\"#0-2-0-2015-02-04\" class=\"headerlink\" title=\"0.2.0 - 2015-02-04\"></a>0.2.0 - 2015-02-04</h1><ul>\n<li>Fixed: prevent scrollTo from being converted from false to 0 (<a href=\"https://github.com/MoOx/pjax/pull/33\">#33</a>)</li>\n<li>Changed: code exploded in commonjs style</li>\n<li>Added: lots of tests</li>\n<li>Added: <code>refresh</code> method to force update a DOM element (<a href=\"https://github.com/MoOx/pjax/pull/36\">#36</a>)</li>\n</ul>\n<h1 id=\"0-1-4-2014-10-14\"><a href=\"#0-1-4-2014-10-14\" class=\"headerlink\" title=\"0.1.4 - 2014-10-14\"></a>0.1.4 - 2014-10-14</h1><ul>\n<li>Fixed: allow to load pages without any attributes on <code>&lt;html&gt;</code> element (fix <a href=\"https://github.com/MoOx/pjax/issues/6\">#6</a>)</li>\n<li>Fixed: make <code>Pjax.switches.sideBySide</code> method usable (fix <a href=\"https://github.com/MoOx/pjax/issues/13\">#13</a>)</li>\n</ul>\n<h1 id=\"0-1-3-2014-09-16\"><a href=\"#0-1-3-2014-09-16\" class=\"headerlink\" title=\"0.1.3 - 2014-09-16\"></a>0.1.3 - 2014-09-16</h1><ul>\n<li>Fixed: clicking on the current url somewhere does not produce a full reload by default (see option <code>currentUrlFullReload</code>)</li>\n<li>Fixed: <code>document.implementation.createHTMLDocument</code> error (in IE10, ref <a href=\"https://github.com/MoOx/pjax/pull/16\">#16</a>)</li>\n</ul>\n<h1 id=\"0-1-2-2014-04-03\"><a href=\"#0-1-2-2014-04-03\" class=\"headerlink\" title=\"0.1.2 - 2014-04-03\"></a>0.1.2 - 2014-04-03</h1><ul>\n<li>Changed: <code>pjax.js</code> relocated in <code>src/</code></li>\n<li>Fixed: <code>&lt;html&gt;</code> attributes of pjaxified document are now available</li>\n</ul>\n<h1 id=\"0-1-1-2014-04-02\"><a href=\"#0-1-1-2014-04-02\" class=\"headerlink\" title=\"0.1.1 - 2014-04-02\"></a>0.1.1 - 2014-04-02</h1><ul>\n<li>Fixed: safer UMD wrapper (fix concat issue)</li>\n</ul>\n<h1 id=\"0-1-0-2014-03-24\"><a href=\"#0-1-0-2014-03-24\" class=\"headerlink\" title=\"0.1.0 - 2014-03-24\"></a>0.1.0 - 2014-03-24</h1><p>✨ Initial release</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"0-2-8-2019-03-09\"><a href=\"#0-2-8-2019-03-09\" class=\"headerlink\" title=\"0.2.8 - 2019-03-09\"></a>0.2.8 - 2019-03-09</h1><ul>\n<li>Fixed: Edge form support.<br>(<a href=\"https://github.com/MoOx/pjax/pull/178\">#178</a> - @robinnorth)</li>\n<li>Fixed: Removed keyup event listener for forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/184\">#184</a> - @BehindTheMath)</li>\n<li>Fixed: Bugs in evalScripts().<br>(<a href=\"https://github.com/MoOx/pjax/pull/186\">#186</a> - @BehindTheMath)</li>\n<li>Fixed: Handle non-string HTML passed to loadContent().<br>(<a href=\"https://github.com/MoOx/pjax/pull/200\">#200</a> - @BehindTheMath)</li>\n<li>Tooling: Switch linting to ESLint and Prettier.<br>(<a href=\"https://github.com/MoOx/pjax/pull/191\">#191</a> - @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-7-2018-08-15\"><a href=\"#0-2-7-2018-08-15\" class=\"headerlink\" title=\"0.2.7 - 2018-08-15\"></a>0.2.7 - 2018-08-15</h1><ul>\n<li>Fixed: Parsing values of option elements in forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/162\">#162</a> - @BehindTheMath)</li>\n<li>Fixed: Added index.d.ts to package.json so it will be installed by npm.<br>(<a href=\"https://github.com/MoOx/pjax/commit/c589ab9c25bee6161bf3e557eaca44e51c14fb89\">c589ab9</a> - @BehindTheMath)</li>\n<li>Fixed: <code>options.history</code> to correctly parse being set to false.<br>(<a href=\"https://github.com/MoOx/pjax/pull/165\">#165</a> - @BehindTheMath).</li>\n<li>Fixed: Pass the current <code>options</code> object to <code>loadContent()</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/171\">#171</a> - @BehindTheMath)</li>\n<li>Fixed: Ensure correct XHR encoding for multipart/form-data forms<br>(<a href=\"https://github.com/MoOx/pjax/pull/174\">#174</a> - @BehindTheMath)</li>\n<li>Added: More documentation.<br>(<a href=\"https://github.com/MoOx/pjax/pull/160\">#160</a>, <a href=\"https://github.com/MoOx/pjax/pull/171\">#171</a> - @robinnorth, @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-6-2018-04-30\"><a href=\"#0-2-6-2018-04-30\" class=\"headerlink\" title=\"0.2.6 - 2018-04-30\"></a>0.2.6 - 2018-04-30</h1><ul>\n<li>Fixed: Form submission for GET requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/129\">#129</a> - @robinnorth)</li>\n<li>Fixed: Refactor <code>loadUrl()</code> to make manually calling simpler.<br>(<a href=\"https://github.com/MoOx/pjax/pull/134\">#134</a> - @robinnorth)</li>\n<li>Fixed: Support multiple select fields in form submissions.<br>(<a href=\"https://github.com/MoOx/pjax/pull/147\">#147</a> - @robinnorth)</li>\n<li>Fixed: Use the same options object in <code>handle-response</code> as in <code>send-request</code>. This way, <code>pjax.state.options</code> will also have the request options.<br>(<a href=\"https://github.com/MoOx/pjax/pull/148\">#148</a> - @BehindTheMath)</li>\n<li>Added: Move the XHR callback to a separate method, and trigger an error event if the response cannot be parsed.<br>(<a href=\"https://github.com/MoOx/pjax/pull/137\">#137</a> - @BehindTheMath)</li>\n<li>Added: TypeScript definitions.<br>(<a href=\"https://github.com/MoOx/pjax/pull/138\">#138</a> - @BehindTheMath)</li>\n<li>Added: <code>replaceNode</code> switch, as an alternative to the <code>outerHTML</code> switch.<br>(<a href=\"https://github.com/MoOx/pjax/pull/141\">#141</a> - @BehindTheMath)</li>\n<li>Added: <code>X-PJAX-Selectors</code> HTTP header. This is a serialized JSON array of selectors, taken from <code>options.selectors</code>. You can use this to send back only the elements that Pjax will use to switch, instead of sending the whole page.<br>(<a href=\"https://github.com/MoOx/pjax/pull/144\">#144</a> - @BehindTheMath)</li>\n<li>Added: An option to use <code>FormData</code> to submit forms.<br>(<a href=\"https://github.com/MoOx/pjax/pull/153\">#153</a> - @BehindTheMath)</li>\n<li>Added: Tests.<br>(<a href=\"https://github.com/MoOx/pjax/commit/f98f2dd63b48113ff91b6bd8808257bfc723ef6b\">f98f2dd</a>, <a href=\"https://github.com/MoOx/pjax/pull/145\">#145</a> - @robinnorth, @BehindTheMath)</li>\n</ul>\n<h1 id=\"0-2-5-2018-02-02\"><a href=\"#0-2-5-2018-02-02\" class=\"headerlink\" title=\"0.2.5 - 2018-02-02\"></a>0.2.5 - 2018-02-02</h1><ul>\n<li>Fixed: Async switch functions now work correctly, because the DOM is now parsed after all the switches finish.<br>(<a href=\"https://github.com/MoOx/pjax/pull/79\">#79</a>, <a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a> - @oskarrough, @BehindTheMath, @robinnorth)</li>\n<li>Fixed: Bug on IE11 preventing AJAX page refresh.<br>(<a href=\"https://github.com/MoOx/pjax/pull/81\">#81</a> - @CPTechnikVX)</li>\n<li>Fixed: Default switches are now available as <code>Pjax.switches</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/92\">#92</a> - @BehindTheMath)</li>\n<li>Fixed: An error that was caused by a missing <code>switchElementsAlt</code>.<br>(<a href=\"https://github.com/MoOx/pjax/pull/93\">#93</a>, <a href=\"https://github.com/MoOx/pjax/pull/104\">#104</a> - @BehindTheMath, @robinnorth)</li>\n<li>Fixed: Incorrect <code>main</code> field in npm package<br>(<a href=\"https://github.com/MoOx/pjax/pull/105\">#105</a> - @robinnorth)</li>\n<li>Fixed: A pending XHR is now aborted if the user navigates somewhere else before the request is finished.<br>(<a href=\"https://github.com/MoOx/pjax/pull/114\">#114</a> - @robinnorth)</li>\n<li>Fixed: When rendering new content, focus will now be removed only from elements within one of the containers manipulated by Pjax.<br>(<a href=\"https://github.com/MoOx/pjax/pull/116\">#116</a> - @BehindTheMath)</li>\n<li>Fixed: Stop dispatching extraneous <code>pjax:complete</code> events when external scripts load<br>(<a href=\"https://github.com/MoOx/pjax/pull/118\">#118</a> - @robinnorth)</li>\n<li>Added: Send the <code>X-PJAX</code> header with XHR requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/80\">#80</a> - @bram1028)</li>\n<li>Added: Direct download link for script tags. (@MoOx)</li>\n<li>Added: Pass the element that triggered Pjax to the <code>pjax:send</code> event.<br>(<a href=\"https://github.com/MoOx/pjax/pull/94\">#94</a> - @BehindTheMath)</li>\n<li>Added: An option to set a timeout for XHR requests.<br>(<a href=\"https://github.com/MoOx/pjax/pull/95\">#95</a> - @BehindTheMath)</li>\n<li>Added: Checks for XHR redirects<br>(<a href=\"https://github.com/MoOx/pjax/pull/101\">#101</a> - @BehindTheMath)</li>\n<li>Added: Save scroll position with history, and restore when navigating backwards or forwards.<br>(<a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a>, <a href=\"https://github.com/MoOx/pjax/pull/119\">#119</a> - @BehindTheMath, @robinnorth)</li>\n<li>Added: Scroll to element position when URL contains a hash<br>(<a href=\"https://github.com/MoOx/pjax/pull/110\">#110</a> - @BehindTheMath)</li>\n<li>Added: Minified version of the Pjax bundle.<br>(<a href=\"https://github.com/MoOx/pjax/pull/115\">#115</a> - @BehindTheMath)</li>\n<li>Changed: Miscellaneous code and tests cleanup.<br>(<a href=\"https://github.com/MoOx/pjax/pull/96\">#96</a>, <a href=\"https://github.com/MoOx/pjax/pull/98\">#98</a>, <a href=\"https://github.com/MoOx/pjax/pull/99\">#99</a>, <a href=\"https://github.com/MoOx/pjax/pull/1070\">#100</a>, <a href=\"https://github.com/MoOx/pjax/pull/107\">#107</a>, <a href=\"https://github.com/MoOx/pjax/pull/113\">#113</a>, <a href=\"https://github.com/MoOx/pjax/pull/120\">#120</a> - @BehindTheMath, @MoOx, @robinnorth)</li>\n</ul>\n<h1 id=\"0-2-4-2016-06-28\"><a href=\"#0-2-4-2016-06-28\" class=\"headerlink\" title=\"0.2.4 - 2016-06-28\"></a>0.2.4 - 2016-06-28</h1><ul>\n<li>Fixed: <code>refresh</code> should now work (use <code>this.parseDOM</code> for refresh)<br>(<a href=\"https://github.com/MoOx/pjax/pull/67\">#67</a> - @compressed)</li>\n<li>Fixed: Some attributes, such as <code>itemscope</code> have no corresponding value.<br>This change allows them to still be set.<br>(<a href=\"https://github.com/MoOx/pjax/pull/67\">#67</a> - @compressed)</li>\n<li>Added: <code>cacheBust</code> option<br>(<a href=\"https://github.com/MoOx/pjax/pull/71\">#71</a> - @tremby)</li>\n</ul>\n<h1 id=\"0-2-3-2016-03-24\"><a href=\"#0-2-3-2016-03-24\" class=\"headerlink\" title=\"0.2.3 - 2016-03-24\"></a>0.2.3 - 2016-03-24</h1><ul>\n<li>Fixed: <code>currentUrlFullReload</code> option now works</li>\n<li>Fixed: <code>this.reload</code> is now a Function<br>(<a href=\"https://github.com/MoOx/pjax/issues/65\">#65</a>)</li>\n</ul>\n<h1 id=\"0-2-2-2016-03-12\"><a href=\"#0-2-2-2016-03-12\" class=\"headerlink\" title=\"0.2.2 - 2016-03-12\"></a>0.2.2 - 2016-03-12</h1><ul>\n<li>Fixed: added back standalone version in <code>./pjax.js</code><br>(<a href=\"https://github.com/MoOx/pjax/issues/57\">#57</a></li>\n<li>Fixed: error when using pjax with google analytics (<code>options</code> was undefined)<br>(<a href=\"https://github.com/MoOx/pjax/pull/59\">#59</a>)</li>\n<li>Fixed: HierarchyRequestError error<br>(<a href=\"https://github.com/MoOx/pjax/pull/49\">#49</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.forEachEls is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.executeScripts is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Fixed: <code>TypeError: Pjax.clone is not a function</code><br>(<a href=\"https://github.com/MoOx/pjax/pull/52\">#52</a>)</li>\n<li>Added: Ignore events with prevented defaults<br>(<a href=\"https://github.com/MoOx/pjax/pull/50\">#50</a>)</li>\n</ul>\n<h1 id=\"0-2-1-2015-02-04\"><a href=\"#0-2-1-2015-02-04\" class=\"headerlink\" title=\"0.2.1 - 2015-02-04\"></a>0.2.1 - 2015-02-04</h1><ul>\n<li>Fixed: it’s better when a release have actual files.</li>\n</ul>\n<h1 id=\"0-2-0-2015-02-04\"><a href=\"#0-2-0-2015-02-04\" class=\"headerlink\" title=\"0.2.0 - 2015-02-04\"></a>0.2.0 - 2015-02-04</h1><ul>\n<li>Fixed: prevent scrollTo from being converted from false to 0 (<a href=\"https://github.com/MoOx/pjax/pull/33\">#33</a>)</li>\n<li>Changed: code exploded in commonjs style</li>\n<li>Added: lots of tests</li>\n<li>Added: <code>refresh</code> method to force update a DOM element (<a href=\"https://github.com/MoOx/pjax/pull/36\">#36</a>)</li>\n</ul>\n<h1 id=\"0-1-4-2014-10-14\"><a href=\"#0-1-4-2014-10-14\" class=\"headerlink\" title=\"0.1.4 - 2014-10-14\"></a>0.1.4 - 2014-10-14</h1><ul>\n<li>Fixed: allow to load pages without any attributes on <code>&lt;html&gt;</code> element (fix <a href=\"https://github.com/MoOx/pjax/issues/6\">#6</a>)</li>\n<li>Fixed: make <code>Pjax.switches.sideBySide</code> method usable (fix <a href=\"https://github.com/MoOx/pjax/issues/13\">#13</a>)</li>\n</ul>\n<h1 id=\"0-1-3-2014-09-16\"><a href=\"#0-1-3-2014-09-16\" class=\"headerlink\" title=\"0.1.3 - 2014-09-16\"></a>0.1.3 - 2014-09-16</h1><ul>\n<li>Fixed: clicking on the current url somewhere does not produce a full reload by default (see option <code>currentUrlFullReload</code>)</li>\n<li>Fixed: <code>document.implementation.createHTMLDocument</code> error (in IE10, ref <a href=\"https://github.com/MoOx/pjax/pull/16\">#16</a>)</li>\n</ul>\n<h1 id=\"0-1-2-2014-04-03\"><a href=\"#0-1-2-2014-04-03\" class=\"headerlink\" title=\"0.1.2 - 2014-04-03\"></a>0.1.2 - 2014-04-03</h1><ul>\n<li>Changed: <code>pjax.js</code> relocated in <code>src/</code></li>\n<li>Fixed: <code>&lt;html&gt;</code> attributes of pjaxified document are now available</li>\n</ul>\n<h1 id=\"0-1-1-2014-04-02\"><a href=\"#0-1-1-2014-04-02\" class=\"headerlink\" title=\"0.1.1 - 2014-04-02\"></a>0.1.1 - 2014-04-02</h1><ul>\n<li>Fixed: safer UMD wrapper (fix concat issue)</li>\n</ul>\n<h1 id=\"0-1-0-2014-03-24\"><a href=\"#0-1-0-2014-03-24\" class=\"headerlink\" title=\"0.1.0 - 2014-03-24\"></a>0.1.0 - 2014-03-24</h1><p>✨ Initial release</p>\n"},{"_content":"// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n","source":"lib/pjax/index.js","raw":"// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n","date":"2021-10-30T06:38:12.562Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/index.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y3t0004nwlwhvlkbndh","content":"// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n</html[^></html>","site":{"data":{}},"excerpt":"","more":"// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n</html[^></html>"},{"_content":"{\n  \"name\": \"pjax\",\n  \"version\": \"0.2.8\",\n  \"description\": \"Easily enable fast AJAX navigation on any website (using pushState + XHR)\",\n  \"keywords\": [\n    \"pjax\",\n    \"pushstate\",\n    \"ajax\",\n    \"navigation\",\n    \"transition\",\n    \"animation\"\n  ],\n  \"repository\": \"https://github.com/MoOx/pjax.git\",\n  \"author\": \"Maxime Thirouin\",\n  \"contributors\": [\n    \"BehindTheMath\",\n    \"Robin North (http://robinnorth.co.uk)\"\n  ],\n  \"license\": \"MIT\",\n  \"main\": \"index.js\",\n  \"files\": [\n    \"index.js\",\n    \"lib\",\n    \"pjax.js\",\n    \"pjax.min.js\",\n    \"index.d.ts\"\n  ],\n  \"types\": \"index.d.ts\",\n  \"devDependencies\": {\n    \"browserify\": \"^16.5.0\",\n    \"eslint\": \"^6.6.0\",\n    \"eslint-config-i-am-meticulous\": \"^11.0.0\",\n    \"husky\": \"^3.1.0\",\n    \"jsdom\": \"^15.2.1\",\n    \"jsdom-global\": \"^3.0.2\",\n    \"lint-staged\": \"^9.4.3\",\n    \"npmpub\": \"^5.0.0\",\n    \"nyc\": \"^14.1.1\",\n    \"opn-cli\": \"^5.0.0\",\n    \"prettier\": \"^1.19.1\",\n    \"serve\": \"^11.2.0\",\n    \"tap-nyc\": \"^1.0.3\",\n    \"tap-spec\": \"^5.0.0\",\n    \"tape\": \"^4.11.0\",\n    \"uglify-js\": \"^3.6.9\"\n  },\n  \"scripts\": {\n    \"lint\": \"eslint .\",\n    \"standalone\": \"browserify index.js --standalone Pjax > pjax.js\",\n    \"build\": \"npm run standalone && uglifyjs pjax.js -o pjax.min.js\",\n    \"build-debug\": \"browserify index.js --debug --standalone Pjax > pjax.js\",\n    \"tests\": \"tape -r ./tests/setup.js \\\"./tests/**/*.js\\\"\",\n    \"test\": \"npm run lint && npm run tests | tap-spec\",\n    \"coverage-tests\": \"npm run tests | tap-nyc\",\n    \"coverage\": \"nyc -x \\\"tests/**\\\" npm run coverage-tests\",\n    \"example\": \"open http://localhost:3000/example/ && serve -p 3000 .\",\n    \"prepublish\": \"npm run build\",\n    \"release\": \"npmpub\"\n  },\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"npm test && lint-staged\"\n    }\n  },\n  \"lint-staged\": {\n    \"*.js\": [\n      \"eslint --fix\",\n      \"prettier --write\",\n      \"git add\"\n    ]\n  }\n}\n","source":"lib/pjax/package.json","raw":"{\n  \"name\": \"pjax\",\n  \"version\": \"0.2.8\",\n  \"description\": \"Easily enable fast AJAX navigation on any website (using pushState + XHR)\",\n  \"keywords\": [\n    \"pjax\",\n    \"pushstate\",\n    \"ajax\",\n    \"navigation\",\n    \"transition\",\n    \"animation\"\n  ],\n  \"repository\": \"https://github.com/MoOx/pjax.git\",\n  \"author\": \"Maxime Thirouin\",\n  \"contributors\": [\n    \"BehindTheMath\",\n    \"Robin North (http://robinnorth.co.uk)\"\n  ],\n  \"license\": \"MIT\",\n  \"main\": \"index.js\",\n  \"files\": [\n    \"index.js\",\n    \"lib\",\n    \"pjax.js\",\n    \"pjax.min.js\",\n    \"index.d.ts\"\n  ],\n  \"types\": \"index.d.ts\",\n  \"devDependencies\": {\n    \"browserify\": \"^16.5.0\",\n    \"eslint\": \"^6.6.0\",\n    \"eslint-config-i-am-meticulous\": \"^11.0.0\",\n    \"husky\": \"^3.1.0\",\n    \"jsdom\": \"^15.2.1\",\n    \"jsdom-global\": \"^3.0.2\",\n    \"lint-staged\": \"^9.4.3\",\n    \"npmpub\": \"^5.0.0\",\n    \"nyc\": \"^14.1.1\",\n    \"opn-cli\": \"^5.0.0\",\n    \"prettier\": \"^1.19.1\",\n    \"serve\": \"^11.2.0\",\n    \"tap-nyc\": \"^1.0.3\",\n    \"tap-spec\": \"^5.0.0\",\n    \"tape\": \"^4.11.0\",\n    \"uglify-js\": \"^3.6.9\"\n  },\n  \"scripts\": {\n    \"lint\": \"eslint .\",\n    \"standalone\": \"browserify index.js --standalone Pjax > pjax.js\",\n    \"build\": \"npm run standalone && uglifyjs pjax.js -o pjax.min.js\",\n    \"build-debug\": \"browserify index.js --debug --standalone Pjax > pjax.js\",\n    \"tests\": \"tape -r ./tests/setup.js \\\"./tests/**/*.js\\\"\",\n    \"test\": \"npm run lint && npm run tests | tap-spec\",\n    \"coverage-tests\": \"npm run tests | tap-nyc\",\n    \"coverage\": \"nyc -x \\\"tests/**\\\" npm run coverage-tests\",\n    \"example\": \"open http://localhost:3000/example/ && serve -p 3000 .\",\n    \"prepublish\": \"npm run build\",\n    \"release\": \"npmpub\"\n  },\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"npm test && lint-staged\"\n    }\n  },\n  \"lint-staged\": {\n    \"*.js\": [\n      \"eslint --fix\",\n      \"prettier --write\",\n      \"git add\"\n    ]\n  }\n}\n","date":"2021-10-30T06:38:12.625Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/package.json","layout":"false","title":"","comments":1,"_id":"ckvgn6y3u0005nwlwflryhk0t","content":"{\"name\":\"pjax\",\"version\":\"0.2.8\",\"description\":\"Easily enable fast AJAX navigation on any website (using pushState + XHR)\",\"keywords\":[\"pjax\",\"pushstate\",\"ajax\",\"navigation\",\"transition\",\"animation\"],\"repository\":\"https://github.com/MoOx/pjax.git\",\"author\":\"Maxime Thirouin\",\"contributors\":[\"BehindTheMath\",\"Robin North (http://robinnorth.co.uk)\"],\"license\":\"MIT\",\"main\":\"index.js\",\"files\":[\"index.js\",\"lib\",\"pjax.js\",\"pjax.min.js\",\"index.d.ts\"],\"types\":\"index.d.ts\",\"devDependencies\":{\"browserify\":\"^16.5.0\",\"eslint\":\"^6.6.0\",\"eslint-config-i-am-meticulous\":\"^11.0.0\",\"husky\":\"^3.1.0\",\"jsdom\":\"^15.2.1\",\"jsdom-global\":\"^3.0.2\",\"lint-staged\":\"^9.4.3\",\"npmpub\":\"^5.0.0\",\"nyc\":\"^14.1.1\",\"opn-cli\":\"^5.0.0\",\"prettier\":\"^1.19.1\",\"serve\":\"^11.2.0\",\"tap-nyc\":\"^1.0.3\",\"tap-spec\":\"^5.0.0\",\"tape\":\"^4.11.0\",\"uglify-js\":\"^3.6.9\"},\"scripts\":{\"lint\":\"eslint .\",\"standalone\":\"browserify index.js --standalone Pjax > pjax.js\",\"build\":\"npm run standalone && uglifyjs pjax.js -o pjax.min.js\",\"build-debug\":\"browserify index.js --debug --standalone Pjax > pjax.js\",\"tests\":\"tape -r ./tests/setup.js \\\"./tests/**/*.js\\\"\",\"test\":\"npm run lint && npm run tests | tap-spec\",\"coverage-tests\":\"npm run tests | tap-nyc\",\"coverage\":\"nyc -x \\\"tests/**\\\" npm run coverage-tests\",\"example\":\"open http://localhost:3000/example/ && serve -p 3000 .\",\"prepublish\":\"npm run build\",\"release\":\"npmpub\"},\"husky\":{\"hooks\":{\"pre-commit\":\"npm test && lint-staged\"}},\"lint-staged\":{\"*.js\":[\"eslint --fix\",\"prettier --write\",\"git add\"]}}","site":{"data":{}},"excerpt":"","more":"{\"name\":\"pjax\",\"version\":\"0.2.8\",\"description\":\"Easily enable fast AJAX navigation on any website (using pushState + XHR)\",\"keywords\":[\"pjax\",\"pushstate\",\"ajax\",\"navigation\",\"transition\",\"animation\"],\"repository\":\"https://github.com/MoOx/pjax.git\",\"author\":\"Maxime Thirouin\",\"contributors\":[\"BehindTheMath\",\"Robin North (http://robinnorth.co.uk)\"],\"license\":\"MIT\",\"main\":\"index.js\",\"files\":[\"index.js\",\"lib\",\"pjax.js\",\"pjax.min.js\",\"index.d.ts\"],\"types\":\"index.d.ts\",\"devDependencies\":{\"browserify\":\"^16.5.0\",\"eslint\":\"^6.6.0\",\"eslint-config-i-am-meticulous\":\"^11.0.0\",\"husky\":\"^3.1.0\",\"jsdom\":\"^15.2.1\",\"jsdom-global\":\"^3.0.2\",\"lint-staged\":\"^9.4.3\",\"npmpub\":\"^5.0.0\",\"nyc\":\"^14.1.1\",\"opn-cli\":\"^5.0.0\",\"prettier\":\"^1.19.1\",\"serve\":\"^11.2.0\",\"tap-nyc\":\"^1.0.3\",\"tap-spec\":\"^5.0.0\",\"tape\":\"^4.11.0\",\"uglify-js\":\"^3.6.9\"},\"scripts\":{\"lint\":\"eslint .\",\"standalone\":\"browserify index.js --standalone Pjax > pjax.js\",\"build\":\"npm run standalone && uglifyjs pjax.js -o pjax.min.js\",\"build-debug\":\"browserify index.js --debug --standalone Pjax > pjax.js\",\"tests\":\"tape -r ./tests/setup.js \\\"./tests/**/*.js\\\"\",\"test\":\"npm run lint && npm run tests | tap-spec\",\"coverage-tests\":\"npm run tests | tap-nyc\",\"coverage\":\"nyc -x \\\"tests/**\\\" npm run coverage-tests\",\"example\":\"open http://localhost:3000/example/ && serve -p 3000 .\",\"prepublish\":\"npm run build\",\"release\":\"npmpub\"},\"husky\":{\"hooks\":{\"pre-commit\":\"npm test && lint-staged\"}},\"lint-staged\":{\"*.js\":[\"eslint --fix\",\"prettier --write\",\"git add\"]}}"},{"_content":"/* global Pjax */\nvar pjax;\nvar initButtons = function() {\n  var buttons = document.querySelectorAll(\"button[data-manual-trigger]\");\n\n  if (!buttons) {\n    return;\n  }\n\n  // jshint -W083\n  for (var i = 0; i < buttons.length; i++) {\n    buttons[i].addEventListener(\"click\", function(e) {\n      var el = e.currentTarget;\n\n      if (el.getAttribute(\"data-manual-trigger-override\") === \"true\") {\n        // Manually load URL with overridden Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\", { cacheBust: false });\n      } else {\n        // Manually load URL with current Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\");\n      }\n    });\n  }\n  // jshint +W083\n};\n\nconsole.log(\"Document initialized:\", window.location.href);\n\ndocument.addEventListener(\"pjax:send\", function() {\n  console.log(\"Event: pjax:send\", arguments);\n});\n\ndocument.addEventListener(\"pjax:complete\", function() {\n  console.log(\"Event: pjax:complete\", arguments);\n});\n\ndocument.addEventListener(\"pjax:error\", function() {\n  console.log(\"Event: pjax:error\", arguments);\n});\n\ndocument.addEventListener(\"pjax:success\", function() {\n  console.log(\"Event: pjax:success\", arguments);\n\n  // Init page content\n  initButtons();\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  // Init Pjax instance\n  pjax = new Pjax({\n    elements: [\".js-Pjax\"],\n    selectors: [\".body\", \"title\"],\n    cacheBust: true\n  });\n  console.log(\"Pjax initialized.\", pjax);\n\n  // Init page content\n  initButtons();\n});\n","source":"lib/pjax/example/example.js","raw":"/* global Pjax */\nvar pjax;\nvar initButtons = function() {\n  var buttons = document.querySelectorAll(\"button[data-manual-trigger]\");\n\n  if (!buttons) {\n    return;\n  }\n\n  // jshint -W083\n  for (var i = 0; i < buttons.length; i++) {\n    buttons[i].addEventListener(\"click\", function(e) {\n      var el = e.currentTarget;\n\n      if (el.getAttribute(\"data-manual-trigger-override\") === \"true\") {\n        // Manually load URL with overridden Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\", { cacheBust: false });\n      } else {\n        // Manually load URL with current Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\");\n      }\n    });\n  }\n  // jshint +W083\n};\n\nconsole.log(\"Document initialized:\", window.location.href);\n\ndocument.addEventListener(\"pjax:send\", function() {\n  console.log(\"Event: pjax:send\", arguments);\n});\n\ndocument.addEventListener(\"pjax:complete\", function() {\n  console.log(\"Event: pjax:complete\", arguments);\n});\n\ndocument.addEventListener(\"pjax:error\", function() {\n  console.log(\"Event: pjax:error\", arguments);\n});\n\ndocument.addEventListener(\"pjax:success\", function() {\n  console.log(\"Event: pjax:success\", arguments);\n\n  // Init page content\n  initButtons();\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  // Init Pjax instance\n  pjax = new Pjax({\n    elements: [\".js-Pjax\"],\n    selectors: [\".body\", \"title\"],\n    cacheBust: true\n  });\n  console.log(\"Pjax initialized.\", pjax);\n\n  // Init page content\n  initButtons();\n});\n","date":"2021-10-30T06:38:12.551Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/example/example.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y3u0006nwlw4enuekcy","content":"/* global Pjax */\nvar pjax;\nvar initButtons = function() {\n  var buttons = document.querySelectorAll(\"button[data-manual-trigger]\");\n\n  if (!buttons) {\n    return;\n  }\n\n  // jshint -W083\n  for (var i = 0; i < buttons.length; i++) {\n    buttons[i].addEventListener(\"click\", function(e) {\n      var el = e.currentTarget;\n\n      if (el.getAttribute(\"data-manual-trigger-override\") === \"true\") {\n        // Manually load URL with overridden Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\", { cacheBust: false });\n      } else {\n        // Manually load URL with current Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\");\n      }\n    });\n  }\n  // jshint +W083\n};\n\nconsole.log(\"Document initialized:\", window.location.href);\n\ndocument.addEventListener(\"pjax:send\", function() {\n  console.log(\"Event: pjax:send\", arguments);\n});\n\ndocument.addEventListener(\"pjax:complete\", function() {\n  console.log(\"Event: pjax:complete\", arguments);\n});\n\ndocument.addEventListener(\"pjax:error\", function() {\n  console.log(\"Event: pjax:error\", arguments);\n});\n\ndocument.addEventListener(\"pjax:success\", function() {\n  console.log(\"Event: pjax:success\", arguments);\n\n  // Init page content\n  initButtons();\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  // Init Pjax instance\n  pjax = new Pjax({\n    elements: [\".js-Pjax\"],\n    selectors: [\".body\", \"title\"],\n    cacheBust: true\n  });\n  console.log(\"Pjax initialized.\", pjax);\n\n  // Init page content\n  initButtons();\n});\n","site":{"data":{}},"excerpt":"","more":"/* global Pjax */\nvar pjax;\nvar initButtons = function() {\n  var buttons = document.querySelectorAll(\"button[data-manual-trigger]\");\n\n  if (!buttons) {\n    return;\n  }\n\n  // jshint -W083\n  for (var i = 0; i < buttons.length; i++) {\n    buttons[i].addEventListener(\"click\", function(e) {\n      var el = e.currentTarget;\n\n      if (el.getAttribute(\"data-manual-trigger-override\") === \"true\") {\n        // Manually load URL with overridden Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\", { cacheBust: false });\n      } else {\n        // Manually load URL with current Pjax instance options\n        pjax.loadUrl(\"/example/page2.html\");\n      }\n    });\n  }\n  // jshint +W083\n};\n\nconsole.log(\"Document initialized:\", window.location.href);\n\ndocument.addEventListener(\"pjax:send\", function() {\n  console.log(\"Event: pjax:send\", arguments);\n});\n\ndocument.addEventListener(\"pjax:complete\", function() {\n  console.log(\"Event: pjax:complete\", arguments);\n});\n\ndocument.addEventListener(\"pjax:error\", function() {\n  console.log(\"Event: pjax:error\", arguments);\n});\n\ndocument.addEventListener(\"pjax:success\", function() {\n  console.log(\"Event: pjax:success\", arguments);\n\n  // Init page content\n  initButtons();\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  // Init Pjax instance\n  pjax = new Pjax({\n    elements: [\".js-Pjax\"],\n    selectors: [\".body\", \"title\"],\n    cacheBust: true\n  });\n  console.log(\"Pjax initialized.\", pjax);\n\n  // Init page content\n  initButtons();\n});\n"},{"_content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Forms</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Forms</h1>\n      Hello. Try out the examples below and inspect the results in your browser's developer tools, or go to the <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n\n      <h3>GET form</h3>\n\n      <form action=\"\" method=\"get\" class=\"js-Pjax\" id=\"get-form\">\n        <label for=\"get-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"get-form-text\" value=\"Foobar\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"get-form-number\" value=\"1\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"get-form-email\" value=\"example@example.com\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"get-form-textarea\">This is some text</textarea>\n\n        <br />\n        <br />\n\n        <fieldset>\n          <label for=\"get-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"get-form-radio-1\" />\n\n          <label for=\"get-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"get-form-radio-2\" />\n        </fieldset>\n\n        <br />\n        <br />\n\n        <label for=\"get-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"get-form-checkbox\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"get-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br />\n        <br />\n\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n\n      <br />\n      <br />\n\n      <h3>POST form</h3>\n\n      <form action=\"\" method=\"post\" class=\"js-Pjax\" id=\"post-form\">\n        <label for=\"post-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"post-form-text\" value=\"Foobar\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"post-form-number\" value=\"1\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"post-form-email\" value=\"example@example.com\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"post-form-textarea\">This is some text</textarea>\n\n        <br />\n        <br />\n\n        <fieldset>\n          <label for=\"post-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"post-form-radio-1\" />\n\n          <label for=\"post-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"post-form-radio-2\" />\n        </fieldset>\n\n        <br />\n        <br />\n\n        <label for=\"post-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"post-form-checkbox\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"post-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br />\n        <br />\n\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n    </div>\n  </body>\n</html>\n","source":"lib/pjax/example/forms.html","raw":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Forms</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Forms</h1>\n      Hello. Try out the examples below and inspect the results in your browser's developer tools, or go to the <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n\n      <h3>GET form</h3>\n\n      <form action=\"\" method=\"get\" class=\"js-Pjax\" id=\"get-form\">\n        <label for=\"get-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"get-form-text\" value=\"Foobar\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"get-form-number\" value=\"1\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"get-form-email\" value=\"example@example.com\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"get-form-textarea\">This is some text</textarea>\n\n        <br />\n        <br />\n\n        <fieldset>\n          <label for=\"get-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"get-form-radio-1\" />\n\n          <label for=\"get-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"get-form-radio-2\" />\n        </fieldset>\n\n        <br />\n        <br />\n\n        <label for=\"get-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"get-form-checkbox\" />\n\n        <br />\n        <br />\n\n        <label for=\"get-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"get-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br />\n        <br />\n\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n\n      <br />\n      <br />\n\n      <h3>POST form</h3>\n\n      <form action=\"\" method=\"post\" class=\"js-Pjax\" id=\"post-form\">\n        <label for=\"post-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"post-form-text\" value=\"Foobar\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"post-form-number\" value=\"1\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"post-form-email\" value=\"example@example.com\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"post-form-textarea\">This is some text</textarea>\n\n        <br />\n        <br />\n\n        <fieldset>\n          <label for=\"post-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"post-form-radio-1\" />\n\n          <label for=\"post-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"post-form-radio-2\" />\n        </fieldset>\n\n        <br />\n        <br />\n\n        <label for=\"post-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"post-form-checkbox\" />\n\n        <br />\n        <br />\n\n        <label for=\"post-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"post-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br />\n        <br />\n\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n    </div>\n  </body>\n</html>\n","date":"2021-10-30T06:38:12.552Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/example/forms.html","title":"","comments":1,"layout":"page","_id":"ckvgn6y3v0007nwlwffpw5zr0","content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Forms</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Forms</h1>\n      Hello. Try out the examples below and inspect the results in your browser's developer tools, or go to the <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n\n      <h3>GET form</h3>\n\n      <form action method=\"get\" class=\"js-Pjax\" id=\"get-form\">\n        <label for=\"get-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"get-form-text\" value=\"Foobar\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"get-form-number\" value=\"1\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"get-form-email\" value=\"example@example.com\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"get-form-textarea\">This is some text</textarea>\n\n        <br>\n        <br>\n\n        <fieldset>\n          <label for=\"get-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"get-form-radio-1\">\n\n          <label for=\"get-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"get-form-radio-2\">\n        </fieldset>\n\n        <br>\n        <br>\n\n        <label for=\"get-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"get-form-checkbox\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"get-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br>\n        <br>\n\n        <input type=\"submit\" value=\"Submit\">\n      </form>\n\n      <br>\n      <br>\n\n      <h3>POST form</h3>\n\n      <form action method=\"post\" class=\"js-Pjax\" id=\"post-form\">\n        <label for=\"post-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"post-form-text\" value=\"Foobar\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"post-form-number\" value=\"1\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"post-form-email\" value=\"example@example.com\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"post-form-textarea\">This is some text</textarea>\n\n        <br>\n        <br>\n\n        <fieldset>\n          <label for=\"post-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"post-form-radio-1\">\n\n          <label for=\"post-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"post-form-radio-2\">\n        </fieldset>\n\n        <br>\n        <br>\n\n        <label for=\"post-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"post-form-checkbox\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"post-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br>\n        <br>\n\n        <input type=\"submit\" value=\"Submit\">\n      </form>\n    </div>\n  </body>\n</html>\n","site":{"data":{}},"excerpt":"","more":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Forms</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Forms</h1>\n      Hello. Try out the examples below and inspect the results in your browser's developer tools, or go to the <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n\n      <h3>GET form</h3>\n\n      <form action method=\"get\" class=\"js-Pjax\" id=\"get-form\">\n        <label for=\"get-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"get-form-text\" value=\"Foobar\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"get-form-number\" value=\"1\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"get-form-email\" value=\"example@example.com\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"get-form-textarea\">This is some text</textarea>\n\n        <br>\n        <br>\n\n        <fieldset>\n          <label for=\"get-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"get-form-radio-1\">\n\n          <label for=\"get-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"get-form-radio-2\">\n        </fieldset>\n\n        <br>\n        <br>\n\n        <label for=\"get-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"get-form-checkbox\">\n\n        <br>\n        <br>\n\n        <label for=\"get-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"get-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br>\n        <br>\n\n        <input type=\"submit\" value=\"Submit\">\n      </form>\n\n      <br>\n      <br>\n\n      <h3>POST form</h3>\n\n      <form action method=\"post\" class=\"js-Pjax\" id=\"post-form\">\n        <label for=\"post-form-text\">Text input:</label>\n        <input type=\"text\" name=\"textInput\" id=\"post-form-text\" value=\"Foobar\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-number\">Number input:</label>\n        <input type=\"number\" name=\"numberInput\" id=\"post-form-number\" value=\"1\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-email\">Email input:</label>\n        <input type=\"email\" name=\"emailInput\" id=\"post-form-email\" value=\"example@example.com\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-textarea\">Textarea:</label>\n        <textarea name=\"textarea\" id=\"post-form-textarea\">This is some text</textarea>\n\n        <br>\n        <br>\n\n        <fieldset>\n          <label for=\"post-form-radio-1\">Radio input:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-1\" checked id=\"post-form-radio-1\">\n\n          <label for=\"post-form-radio-2\">Radio input alt:</label>\n          <input type=\"radio\" name=\"radioInput\" value=\"radio-2\" id=\"post-form-radio-2\">\n        </fieldset>\n\n        <br>\n        <br>\n\n        <label for=\"post-form-checkbox\">Checkbox input:</label>\n        <input type=\"checkbox\" name=\"checkboxInput\" checked id=\"post-form-checkbox\">\n\n        <br>\n        <br>\n\n        <label for=\"post-form-select\">Select list:</label>\n        <select multiple name=\"select\" id=\"post-form-select\">\n          <option>\n            Option 1\n          </option>\n          <option>\n            Option 2\n          </option>\n        </select>\n\n        <br>\n        <br>\n\n        <input type=\"submit\" value=\"Submit\">\n      </form>\n    </div>\n  </body>\n</html>\n"},{"_content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hello</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Index</h1>\n      Hello.\n      Go to <a href=\"page2.html\" class=\"js-Pjax\">Page 2</a> or <a href=\"page3.html\" class=\"js-Pjax\">Page 3</a> and view your console to see Pjax events.\n      Clicking on <a href=\"index.html\">this page</a> will do nothing.\n\n      <h2>Manual URL loading</h2>\n\n      You can use Pjax's <i>loadUrl</i> method to manually load a URL. Click the buttons below to try it out!<br /><br />\n\n      <button data-manual-trigger>loadUrl with current options</button><br /><br />\n      <button data-manual-trigger data-manual-trigger-override=\"true\">loadUrl with overridden options (no cache busting)</button>\n\n      <h2>Forms</h2>\n\n      You can submit GET or POST forms with Pjax! Go to the <a href=\"forms.html\">form examples</a> to try it out.\n\n    </div>\n  </body>\n</html>\n","source":"lib/pjax/example/index.html","raw":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hello</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Index</h1>\n      Hello.\n      Go to <a href=\"page2.html\" class=\"js-Pjax\">Page 2</a> or <a href=\"page3.html\" class=\"js-Pjax\">Page 3</a> and view your console to see Pjax events.\n      Clicking on <a href=\"index.html\">this page</a> will do nothing.\n\n      <h2>Manual URL loading</h2>\n\n      You can use Pjax's <i>loadUrl</i> method to manually load a URL. Click the buttons below to try it out!<br /><br />\n\n      <button data-manual-trigger>loadUrl with current options</button><br /><br />\n      <button data-manual-trigger data-manual-trigger-override=\"true\">loadUrl with overridden options (no cache busting)</button>\n\n      <h2>Forms</h2>\n\n      You can submit GET or POST forms with Pjax! Go to the <a href=\"forms.html\">form examples</a> to try it out.\n\n    </div>\n  </body>\n</html>\n","date":"2021-10-30T06:38:12.553Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/example/index.html","title":"","comments":1,"layout":"page","_id":"ckvgn6y3w0008nwlw67l8bmtz","content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hello</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Index</h1>\n      Hello.\n      Go to <a href=\"page2.html\" class=\"js-Pjax\">Page 2</a> or <a href=\"page3.html\" class=\"js-Pjax\">Page 3</a> and view your console to see Pjax events.\n      Clicking on <a href=\"index.html\">this page</a> will do nothing.\n\n      <h2>Manual URL loading</h2>\n\n      You can use Pjax's <i>loadUrl</i> method to manually load a URL. Click the buttons below to try it out!<br><br>\n\n      <button data-manual-trigger>loadUrl with current options</button><br><br>\n      <button data-manual-trigger data-manual-trigger-override=\"true\">loadUrl with overridden options (no cache busting)</button>\n\n      <h2>Forms</h2>\n\n      You can submit GET or POST forms with Pjax! Go to the <a href=\"forms.html\">form examples</a> to try it out.\n\n    </div>\n  </body>\n</html>\n","site":{"data":{}},"excerpt":"","more":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hello</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Index</h1>\n      Hello.\n      Go to <a href=\"page2.html\" class=\"js-Pjax\">Page 2</a> or <a href=\"page3.html\" class=\"js-Pjax\">Page 3</a> and view your console to see Pjax events.\n      Clicking on <a href=\"index.html\">this page</a> will do nothing.\n\n      <h2>Manual URL loading</h2>\n\n      You can use Pjax's <i>loadUrl</i> method to manually load a URL. Click the buttons below to try it out!<br><br>\n\n      <button data-manual-trigger>loadUrl with current options</button><br><br>\n      <button data-manual-trigger data-manual-trigger-override=\"true\">loadUrl with overridden options (no cache busting)</button>\n\n      <h2>Forms</h2>\n\n      You can submit GET or POST forms with Pjax! Go to the <a href=\"forms.html\">form examples</a> to try it out.\n\n    </div>\n  </body>\n</html>\n"},{"_content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 3</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 3</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","source":"lib/pjax/example/page3.html","raw":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 3</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 3</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","date":"2021-10-30T06:38:12.558Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/example/page3.html","title":"","comments":1,"layout":"page","_id":"ckvgn6y3x0009nwlw0rjsew0i","content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 3</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 3</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","site":{"data":{}},"excerpt":"","more":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 3</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 3</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n"},{"_content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 2</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 2</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","source":"lib/pjax/example/page2.html","raw":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 2</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 2</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","date":"2021-10-30T06:38:12.557Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/example/page2.html","title":"","comments":1,"layout":"page","_id":"ckvgn6y3z000anwlwhaxsfqx0","content":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 2</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 2</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n","site":{"data":{}},"excerpt":"","more":"<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Page 2</title>\n    <script src=\"../pjax.js\"></script>\n    <script src=\"example.js\"></script>\n  </head>\n  <body>\n    <div class=\"body\">\n      <h1>Page 2</h1>\n      Hello. Go to <a href=\"index.html\" class=\"js-Pjax\">Index</a>.\n    </div>\n  </body>\n</html>\n"},{"_content":"var noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n","source":"lib/pjax/lib/abort-request.js","raw":"var noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n","date":"2021-10-30T06:38:12.568Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/abort-request.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y40000bnwlwgvh8hm7k","content":"var noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n","site":{"data":{}},"excerpt":"","more":"var noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n"},{"_content":"module.exports = function(el) {\n  var code = el.text || el.textContent || el.innerHTML || \"\";\n  var src = el.src || \"\";\n  var parent =\n    el.parentNode || document.querySelector(\"head\") || document.documentElement;\n  var script = document.createElement(\"script\");\n\n  if (code.match(\"document.write\")) {\n    if (console && console.log) {\n      console.log(\n        \"Script contains document.write. Can’t be executed correctly. Code skipped \",\n        el\n      );\n    }\n    return false;\n  }\n\n  script.type = \"text/javascript\";\n  script.id = el.id;\n\n  /* istanbul ignore if */\n  if (src !== \"\") {\n    script.src = src;\n    script.async = false; // force synchronous loading of peripheral JS\n  }\n\n  if (code !== \"\") {\n    try {\n      script.appendChild(document.createTextNode(code));\n    } catch (e) {\n      /* istanbul ignore next */\n      // old IEs have funky script nodes\n      script.text = code;\n    }\n  }\n\n  // execute\n  parent.appendChild(script);\n  // avoid pollution only in head or body tags\n  if (\n    (parent instanceof HTMLHeadElement || parent instanceof HTMLBodyElement) &&\n    parent.contains(script)\n  ) {\n    parent.removeChild(script);\n  }\n\n  return true;\n};\n","source":"lib/pjax/lib/eval-script.js","raw":"module.exports = function(el) {\n  var code = el.text || el.textContent || el.innerHTML || \"\";\n  var src = el.src || \"\";\n  var parent =\n    el.parentNode || document.querySelector(\"head\") || document.documentElement;\n  var script = document.createElement(\"script\");\n\n  if (code.match(\"document.write\")) {\n    if (console && console.log) {\n      console.log(\n        \"Script contains document.write. Can’t be executed correctly. Code skipped \",\n        el\n      );\n    }\n    return false;\n  }\n\n  script.type = \"text/javascript\";\n  script.id = el.id;\n\n  /* istanbul ignore if */\n  if (src !== \"\") {\n    script.src = src;\n    script.async = false; // force synchronous loading of peripheral JS\n  }\n\n  if (code !== \"\") {\n    try {\n      script.appendChild(document.createTextNode(code));\n    } catch (e) {\n      /* istanbul ignore next */\n      // old IEs have funky script nodes\n      script.text = code;\n    }\n  }\n\n  // execute\n  parent.appendChild(script);\n  // avoid pollution only in head or body tags\n  if (\n    (parent instanceof HTMLHeadElement || parent instanceof HTMLBodyElement) &&\n    parent.contains(script)\n  ) {\n    parent.removeChild(script);\n  }\n\n  return true;\n};\n","date":"2021-10-30T06:38:12.569Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/eval-script.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y40000cnwlwfc4cdv1p","content":"module.exports = function(el) {\n  var code = el.text || el.textContent || el.innerHTML || \"\";\n  var src = el.src || \"\";\n  var parent =\n    el.parentNode || document.querySelector(\"head\") || document.documentElement;\n  var script = document.createElement(\"script\");\n\n  if (code.match(\"document.write\")) {\n    if (console && console.log) {\n      console.log(\n        \"Script contains document.write. Can’t be executed correctly. Code skipped \",\n        el\n      );\n    }\n    return false;\n  }\n\n  script.type = \"text/javascript\";\n  script.id = el.id;\n\n  /* istanbul ignore if */\n  if (src !== \"\") {\n    script.src = src;\n    script.async = false; // force synchronous loading of peripheral JS\n  }\n\n  if (code !== \"\") {\n    try {\n      script.appendChild(document.createTextNode(code));\n    } catch (e) {\n      /* istanbul ignore next */\n      // old IEs have funky script nodes\n      script.text = code;\n    }\n  }\n\n  // execute\n  parent.appendChild(script);\n  // avoid pollution only in head or body tags\n  if (\n    (parent instanceof HTMLHeadElement || parent instanceof HTMLBodyElement) &&\n    parent.contains(script)\n  ) {\n    parent.removeChild(script);\n  }\n\n  return true;\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function(el) {\n  var code = el.text || el.textContent || el.innerHTML || \"\";\n  var src = el.src || \"\";\n  var parent =\n    el.parentNode || document.querySelector(\"head\") || document.documentElement;\n  var script = document.createElement(\"script\");\n\n  if (code.match(\"document.write\")) {\n    if (console && console.log) {\n      console.log(\n        \"Script contains document.write. Can’t be executed correctly. Code skipped \",\n        el\n      );\n    }\n    return false;\n  }\n\n  script.type = \"text/javascript\";\n  script.id = el.id;\n\n  /* istanbul ignore if */\n  if (src !== \"\") {\n    script.src = src;\n    script.async = false; // force synchronous loading of peripheral JS\n  }\n\n  if (code !== \"\") {\n    try {\n      script.appendChild(document.createTextNode(code));\n    } catch (e) {\n      /* istanbul ignore next */\n      // old IEs have funky script nodes\n      script.text = code;\n    }\n  }\n\n  // execute\n  parent.appendChild(script);\n  // avoid pollution only in head or body tags\n  if (\n    (parent instanceof HTMLHeadElement || parent instanceof HTMLBodyElement) &&\n    parent.contains(script)\n  ) {\n    parent.removeChild(script);\n  }\n\n  return true;\n};\n"},{"_content":"var forEachEls = require(\"./foreach-els\");\nvar evalScript = require(\"./eval-script\");\n// Finds and executes scripts (used for newly added elements)\n// Needed since innerHTML does not run scripts\nmodule.exports = function(el) {\n  if (el.tagName.toLowerCase() === \"script\") {\n    evalScript(el);\n  }\n\n  forEachEls(el.querySelectorAll(\"script\"), function(script) {\n    if (!script.type || script.type.toLowerCase() === \"text/javascript\") {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n      evalScript(script);\n    }\n  });\n};\n","source":"lib/pjax/lib/execute-scripts.js","raw":"var forEachEls = require(\"./foreach-els\");\nvar evalScript = require(\"./eval-script\");\n// Finds and executes scripts (used for newly added elements)\n// Needed since innerHTML does not run scripts\nmodule.exports = function(el) {\n  if (el.tagName.toLowerCase() === \"script\") {\n    evalScript(el);\n  }\n\n  forEachEls(el.querySelectorAll(\"script\"), function(script) {\n    if (!script.type || script.type.toLowerCase() === \"text/javascript\") {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n      evalScript(script);\n    }\n  });\n};\n","date":"2021-10-30T06:38:12.575Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/execute-scripts.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y41000dnwlw8btqebxq","content":"var forEachEls = require(\"./foreach-els\");\nvar evalScript = require(\"./eval-script\");\n// Finds and executes scripts (used for newly added elements)\n// Needed since innerHTML does not run scripts\nmodule.exports = function(el) {\n  if (el.tagName.toLowerCase() === \"script\") {\n    evalScript(el);\n  }\n\n  forEachEls(el.querySelectorAll(\"script\"), function(script) {\n    if (!script.type || script.type.toLowerCase() === \"text/javascript\") {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n      evalScript(script);\n    }\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"./foreach-els\");\nvar evalScript = require(\"./eval-script\");\n// Finds and executes scripts (used for newly added elements)\n// Needed since innerHTML does not run scripts\nmodule.exports = function(el) {\n  if (el.tagName.toLowerCase() === \"script\") {\n    evalScript(el);\n  }\n\n  forEachEls(el.querySelectorAll(\"script\"), function(script) {\n    if (!script.type || script.type.toLowerCase() === \"text/javascript\") {\n      if (script.parentNode) {\n        script.parentNode.removeChild(script);\n      }\n      evalScript(script);\n    }\n  });\n};\n"},{"_content":"/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n","source":"lib/pjax/lib/foreach-els.js","raw":"/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n","date":"2021-10-30T06:38:12.576Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/foreach-els.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y42000enwlwcssv3ryz","content":"/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n","site":{"data":{}},"excerpt":"","more":"/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n"},{"_content":"var forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n","source":"lib/pjax/lib/foreach-selectors.js","raw":"var forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n","date":"2021-10-30T06:38:12.577Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/foreach-selectors.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y43000fnwlwc808dryr","content":"var forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n"},{"_content":"module.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n","source":"lib/pjax/lib/is-supported.js","raw":"module.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n","date":"2021-10-30T06:38:12.578Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/is-supported.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y44000gnwlw1xnndg2n","content":"module.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n"},{"_content":"/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n","source":"lib/pjax/lib/parse-options.js","raw":"/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n","date":"2021-10-30T06:38:12.579Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/parse-options.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y47000hnwlwdgeb2zjd","content":"/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n","site":{"data":{}},"excerpt":"","more":"/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n"},{"_content":"var updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n","source":"lib/pjax/lib/send-request.js","raw":"var updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n","date":"2021-10-30T06:38:12.612Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/send-request.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y48000inwlw30apba7t","content":"var updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n","site":{"data":{}},"excerpt":"","more":"var updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n"},{"_content":"var forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n","source":"lib/pjax/lib/switches-selectors.js","raw":"var forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n","date":"2021-10-30T06:38:12.613Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/switches-selectors.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4a000jnwlwf26g233w","content":"var forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n"},{"_content":"var on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and <body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber <= 0 && elsToRemove) {\n        elsToRemove.forEach(function(el) {\n          // browsing quickly can make the el\n          // already removed by last page update ?\n          if (el.parentNode) {\n            el.parentNode.removeChild(el);\n          }\n        });\n\n        elsToAdd.forEach(function(el) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        });\n\n        elsToAdd = null; // free memory\n        elsToRemove = null; // free memory\n\n        // this is to trigger some repaint (example: picturefill)\n        this.onSwitch();\n      }\n    }.bind(this);\n\n    switchOptions = switchOptions || {};\n\n    forEach.call(oldEl.childNodes, function(el) {\n      elsToRemove.push(el);\n      if (el.classList && !el.classList.contains(\"js-Pjax-remove\")) {\n        // for fast switch, clean element that just have been added, & not cleaned yet.\n        if (el.hasAttribute(\"data-pjax-classes\")) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        }\n        el.classList.add(\"js-Pjax-remove\");\n        if (switchOptions.callbacks && switchOptions.callbacks.removeElement) {\n          switchOptions.callbacks.removeElement(el);\n        }\n        if (switchOptions.classNames) {\n          el.className +=\n            \" \" +\n            switchOptions.classNames.remove +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.backward\n              : switchOptions.classNames.forward);\n        }\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    forEach.call(newEl.childNodes, function(el) {\n      if (el.classList) {\n        var addClasses = \"\";\n        if (switchOptions.classNames) {\n          addClasses =\n            \" js-Pjax-add \" +\n            switchOptions.classNames.add +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.forward\n              : switchOptions.classNames.backward);\n        }\n        if (switchOptions.callbacks && switchOptions.callbacks.addElement) {\n          switchOptions.callbacks.addElement(el);\n        }\n        el.className += addClasses;\n        el.setAttribute(\"data-pjax-classes\", addClasses);\n        elsToAdd.push(el);\n        fragToAppend.appendChild(el);\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    // pass all className of the parent\n    oldEl.className = newEl.className;\n    oldEl.appendChild(fragToAppend);\n  }\n};\n","source":"lib/pjax/lib/switches.js","raw":"var on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and <body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber <= 0 && elsToRemove) {\n        elsToRemove.forEach(function(el) {\n          // browsing quickly can make the el\n          // already removed by last page update ?\n          if (el.parentNode) {\n            el.parentNode.removeChild(el);\n          }\n        });\n\n        elsToAdd.forEach(function(el) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        });\n\n        elsToAdd = null; // free memory\n        elsToRemove = null; // free memory\n\n        // this is to trigger some repaint (example: picturefill)\n        this.onSwitch();\n      }\n    }.bind(this);\n\n    switchOptions = switchOptions || {};\n\n    forEach.call(oldEl.childNodes, function(el) {\n      elsToRemove.push(el);\n      if (el.classList && !el.classList.contains(\"js-Pjax-remove\")) {\n        // for fast switch, clean element that just have been added, & not cleaned yet.\n        if (el.hasAttribute(\"data-pjax-classes\")) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        }\n        el.classList.add(\"js-Pjax-remove\");\n        if (switchOptions.callbacks && switchOptions.callbacks.removeElement) {\n          switchOptions.callbacks.removeElement(el);\n        }\n        if (switchOptions.classNames) {\n          el.className +=\n            \" \" +\n            switchOptions.classNames.remove +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.backward\n              : switchOptions.classNames.forward);\n        }\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    forEach.call(newEl.childNodes, function(el) {\n      if (el.classList) {\n        var addClasses = \"\";\n        if (switchOptions.classNames) {\n          addClasses =\n            \" js-Pjax-add \" +\n            switchOptions.classNames.add +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.forward\n              : switchOptions.classNames.backward);\n        }\n        if (switchOptions.callbacks && switchOptions.callbacks.addElement) {\n          switchOptions.callbacks.addElement(el);\n        }\n        el.className += addClasses;\n        el.setAttribute(\"data-pjax-classes\", addClasses);\n        elsToAdd.push(el);\n        fragToAppend.appendChild(el);\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    // pass all className of the parent\n    oldEl.className = newEl.className;\n    oldEl.appendChild(fragToAppend);\n  }\n};\n","date":"2021-10-30T06:38:12.614Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/switches.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4c000knwlw2dp786m1","content":"var on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and </head><body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber </body>","site":{"data":{}},"excerpt":"","more":"var on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and </head><body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber </body>"},{"_content":"module.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n","source":"lib/pjax/lib/uniqueid.js","raw":"module.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n","date":"2021-10-30T06:38:12.615Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/uniqueid.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4c000lnwlw81lneauy","content":"module.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n","site":{"data":{}},"excerpt":"","more":"module.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n"},{"_content":"var jsdomOptions = {\n  url: \"https://example.org/\",\n  runScripts: \"dangerously\"\n};\n\nrequire(\"jsdom-global\")(\"\", jsdomOptions);\n","source":"lib/pjax/tests/setup.js","raw":"var jsdomOptions = {\n  url: \"https://example.org/\",\n  runScripts: \"dangerously\"\n};\n\nrequire(\"jsdom-global\")(\"\", jsdomOptions);\n","date":"2021-10-30T06:38:12.809Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/setup.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4d000mnwlwb2kv8u51","content":"var jsdomOptions = {\n  url: \"https://example.org/\",\n  runScripts: \"dangerously\"\n};\n\nrequire(\"jsdom-global\")(\"\", jsdomOptions);\n","site":{"data":{}},"excerpt":"","more":"var jsdomOptions = {\n  url: \"https://example.org/\",\n  runScripts: \"dangerously\"\n};\n\nrequire(\"jsdom-global\")(\"\", jsdomOptions);\n"},{"_content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.removeEventListener(e, listener, useCapture);\n    });\n  });\n};\n","source":"lib/pjax/lib/events/off.js","raw":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.removeEventListener(e, listener, useCapture);\n    });\n  });\n};\n","date":"2021-10-30T06:38:12.571Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/events/off.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4d000nnwlwdd6l0tri","content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.removeEventListener(e, listener, useCapture);\n    });\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.removeEventListener(e, listener, useCapture);\n    });\n  });\n};\n"},{"_content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n","source":"lib/pjax/lib/events/on.js","raw":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n","date":"2021-10-30T06:38:12.572Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/events/on.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4e000onwlw4t22eazg","content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n"},{"_content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n","source":"lib/pjax/lib/events/trigger.js","raw":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n","date":"2021-10-30T06:38:12.573Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/events/trigger.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4e000pnwlw3wn9103z","content":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n"},{"_content":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n","source":"lib/pjax/lib/proto/attach-form.js","raw":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n","date":"2021-10-30T06:38:12.581Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/proto/attach-form.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4i000qnwlwhi1ihj6r","content":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n","site":{"data":{}},"excerpt":"","more":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n"},{"_content":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n","source":"lib/pjax/lib/proto/attach-link.js","raw":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n","date":"2021-10-30T06:38:12.582Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/proto/attach-link.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4i000rnwlw5jjt68w9","content":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n","site":{"data":{}},"excerpt":"","more":"var on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n"},{"_content":"var clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n","source":"lib/pjax/lib/proto/handle-response.js","raw":"var clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n","date":"2021-10-30T06:38:12.583Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/proto/handle-response.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4j000snwlw9tjme59u","content":"var clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n","site":{"data":{}},"excerpt":"","more":"var clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n"},{"_content":"module.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n","source":"lib/pjax/lib/proto/log.js","raw":"module.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n","date":"2021-10-30T06:38:12.584Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/proto/log.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4l000tnwlw5hen4e1f","content":"module.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n"},{"_content":"var attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n","source":"lib/pjax/lib/proto/parse-element.js","raw":"var attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n","date":"2021-10-30T06:38:12.610Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/proto/parse-element.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4n000unwlw46kl4gwa","content":"var attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n</form></a>","site":{"data":{}},"excerpt":"","more":"var attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n</form></a>"},{"_content":"module.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n","source":"lib/pjax/lib/util/clone.js","raw":"module.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n","date":"2021-10-30T06:38:12.617Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/util/clone.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4p000vnwlw2s576fct","content":"module.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n"},{"_content":"module.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n","source":"lib/pjax/lib/util/contains.js","raw":"module.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n","date":"2021-10-30T06:38:12.618Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/util/contains.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4q000wnwlw3v5s43xg","content":"module.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n"},{"_content":"module.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n","source":"lib/pjax/lib/util/extend.js","raw":"module.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n","date":"2021-10-30T06:38:12.619Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/util/extend.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4r000xnwlw9jxp49y8","content":"module.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n"},{"_content":"module.exports = function() {};\n","source":"lib/pjax/lib/util/noop.js","raw":"module.exports = function() {};\n","date":"2021-10-30T06:38:12.620Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/util/noop.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4s000ynwlwejyrh6n8","content":"module.exports = function() {};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function() {};\n"},{"_content":"module.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n","source":"lib/pjax/lib/util/update-query-string.js","raw":"module.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n","date":"2021-10-30T06:38:12.624Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/lib/util/update-query-string.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4s000znwlw8ua5cgyv","content":"module.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n","site":{"data":{}},"excerpt":"","more":"module.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n"},{"_content":"var tape = require(\"tape\");\n\nvar abortRequest = require(\"../../lib/abort-request.js\");\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test aborting xhr request\", function(t) {\n  var requestCacheBust = sendRequest.bind({\n    options: {\n      cacheBust: true\n    }\n  });\n\n  t.test(\"- pending request is aborted\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/delay/10\", {}, function() {\n      t.fail(\"xhr was not aborted\");\n    });\n    t.equal(r.readyState, 1, \"xhr readyState is '1' (SENT)\");\n    abortRequest(r);\n    t.equal(r.readyState, 0, \"xhr readyState is '0' (ABORTED)\");\n    t.equal(r.status, 0, \"xhr HTTP status is '0' (ABORTED)\");\n    t.equal(r.responseText, \"\", \"xhr response is empty\");\n    t.end();\n  });\n  t.test(\"- request is not aborted if it has already completed\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/get\", {}, function() {\n      abortRequest(r);\n      t.equal(r.readyState, 4, \"xhr readyState is '4' (DONE)\");\n      t.equal(r.status, 200, \"xhr HTTP status is '200' (OK)\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not aborted if it is undefined\", function(t) {\n    var r;\n    try {\n      abortRequest(r);\n    } catch (e) {\n      t.fail(\"aborting an undefined request threw an error\");\n    }\n    t.equal(typeof r, \"undefined\", \"undefined xhr was ignored\");\n    t.end();\n  });\n  t.end();\n});\n","source":"lib/pjax/tests/lib/abort-request.js","raw":"var tape = require(\"tape\");\n\nvar abortRequest = require(\"../../lib/abort-request.js\");\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test aborting xhr request\", function(t) {\n  var requestCacheBust = sendRequest.bind({\n    options: {\n      cacheBust: true\n    }\n  });\n\n  t.test(\"- pending request is aborted\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/delay/10\", {}, function() {\n      t.fail(\"xhr was not aborted\");\n    });\n    t.equal(r.readyState, 1, \"xhr readyState is '1' (SENT)\");\n    abortRequest(r);\n    t.equal(r.readyState, 0, \"xhr readyState is '0' (ABORTED)\");\n    t.equal(r.status, 0, \"xhr HTTP status is '0' (ABORTED)\");\n    t.equal(r.responseText, \"\", \"xhr response is empty\");\n    t.end();\n  });\n  t.test(\"- request is not aborted if it has already completed\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/get\", {}, function() {\n      abortRequest(r);\n      t.equal(r.readyState, 4, \"xhr readyState is '4' (DONE)\");\n      t.equal(r.status, 200, \"xhr HTTP status is '200' (OK)\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not aborted if it is undefined\", function(t) {\n    var r;\n    try {\n      abortRequest(r);\n    } catch (e) {\n      t.fail(\"aborting an undefined request threw an error\");\n    }\n    t.equal(typeof r, \"undefined\", \"undefined xhr was ignored\");\n    t.end();\n  });\n  t.end();\n});\n","date":"2021-10-30T06:38:12.630Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/abort-request.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4t0010nwlwh8l2ff97","content":"var tape = require(\"tape\");\n\nvar abortRequest = require(\"../../lib/abort-request.js\");\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test aborting xhr request\", function(t) {\n  var requestCacheBust = sendRequest.bind({\n    options: {\n      cacheBust: true\n    }\n  });\n\n  t.test(\"- pending request is aborted\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/delay/10\", {}, function() {\n      t.fail(\"xhr was not aborted\");\n    });\n    t.equal(r.readyState, 1, \"xhr readyState is '1' (SENT)\");\n    abortRequest(r);\n    t.equal(r.readyState, 0, \"xhr readyState is '0' (ABORTED)\");\n    t.equal(r.status, 0, \"xhr HTTP status is '0' (ABORTED)\");\n    t.equal(r.responseText, \"\", \"xhr response is empty\");\n    t.end();\n  });\n  t.test(\"- request is not aborted if it has already completed\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/get\", {}, function() {\n      abortRequest(r);\n      t.equal(r.readyState, 4, \"xhr readyState is '4' (DONE)\");\n      t.equal(r.status, 200, \"xhr HTTP status is '200' (OK)\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not aborted if it is undefined\", function(t) {\n    var r;\n    try {\n      abortRequest(r);\n    } catch (e) {\n      t.fail(\"aborting an undefined request threw an error\");\n    }\n    t.equal(typeof r, \"undefined\", \"undefined xhr was ignored\");\n    t.end();\n  });\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar abortRequest = require(\"../../lib/abort-request.js\");\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test aborting xhr request\", function(t) {\n  var requestCacheBust = sendRequest.bind({\n    options: {\n      cacheBust: true\n    }\n  });\n\n  t.test(\"- pending request is aborted\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/delay/10\", {}, function() {\n      t.fail(\"xhr was not aborted\");\n    });\n    t.equal(r.readyState, 1, \"xhr readyState is '1' (SENT)\");\n    abortRequest(r);\n    t.equal(r.readyState, 0, \"xhr readyState is '0' (ABORTED)\");\n    t.equal(r.status, 0, \"xhr HTTP status is '0' (ABORTED)\");\n    t.equal(r.responseText, \"\", \"xhr response is empty\");\n    t.end();\n  });\n  t.test(\"- request is not aborted if it has already completed\", function(t) {\n    var r = requestCacheBust(\"https://httpbin.org/get\", {}, function() {\n      abortRequest(r);\n      t.equal(r.readyState, 4, \"xhr readyState is '4' (DONE)\");\n      t.equal(r.status, 200, \"xhr HTTP status is '200' (OK)\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not aborted if it is undefined\", function(t) {\n    var r;\n    try {\n      abortRequest(r);\n    } catch (e) {\n      t.fail(\"aborting an undefined request threw an error\");\n    }\n    t.equal(typeof r, \"undefined\", \"undefined xhr was ignored\");\n    t.end();\n  });\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar evalScript = require(\"../../lib/eval-script\");\n\ntape(\"test evalScript method\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed'\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n\n  evalScript(script);\n  t.equal(\n    document.body.className,\n    \"executed\",\n    \"script has been properly executed\"\n  );\n\n  script.innerHTML = \"document.write('failure')\";\n  var bodyText = \"document.write hasn't been executed\";\n  document.body.text = bodyText;\n  evalScript(script);\n  t.equal(document.body.text, bodyText, \"document.write hasn't been executed\");\n\n  t.end();\n});\n\ntape(\n  \"evalScript should not throw an error if the script removed itself\",\n  function(t) {\n    var script = document.createElement(\"script\");\n    script.id = \"myScript\";\n    script.innerHTML =\n      \"const script = document.querySelector('#myScript');\" +\n      \"script.parentNode.removeChild(script);\";\n\n    try {\n      evalScript(script);\n\n      t.pass(\"Missing script tested successfully\");\n    } catch (e) {\n      console.error(e);\n      t.fail(\"Attempted to remove missing script\");\n    }\n\n    t.end();\n  }\n);\n","source":"lib/pjax/tests/lib/eval-scripts.js","raw":"var tape = require(\"tape\");\n\nvar evalScript = require(\"../../lib/eval-script\");\n\ntape(\"test evalScript method\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed'\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n\n  evalScript(script);\n  t.equal(\n    document.body.className,\n    \"executed\",\n    \"script has been properly executed\"\n  );\n\n  script.innerHTML = \"document.write('failure')\";\n  var bodyText = \"document.write hasn't been executed\";\n  document.body.text = bodyText;\n  evalScript(script);\n  t.equal(document.body.text, bodyText, \"document.write hasn't been executed\");\n\n  t.end();\n});\n\ntape(\n  \"evalScript should not throw an error if the script removed itself\",\n  function(t) {\n    var script = document.createElement(\"script\");\n    script.id = \"myScript\";\n    script.innerHTML =\n      \"const script = document.querySelector('#myScript');\" +\n      \"script.parentNode.removeChild(script);\";\n\n    try {\n      evalScript(script);\n\n      t.pass(\"Missing script tested successfully\");\n    } catch (e) {\n      console.error(e);\n      t.fail(\"Attempted to remove missing script\");\n    }\n\n    t.end();\n  }\n);\n","date":"2021-10-30T06:38:12.631Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/eval-scripts.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4u0011nwlw9lq76js2","content":"var tape = require(\"tape\");\n\nvar evalScript = require(\"../../lib/eval-script\");\n\ntape(\"test evalScript method\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed'\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n\n  evalScript(script);\n  t.equal(\n    document.body.className,\n    \"executed\",\n    \"script has been properly executed\"\n  );\n\n  script.innerHTML = \"document.write('failure')\";\n  var bodyText = \"document.write hasn't been executed\";\n  document.body.text = bodyText;\n  evalScript(script);\n  t.equal(document.body.text, bodyText, \"document.write hasn't been executed\");\n\n  t.end();\n});\n\ntape(\n  \"evalScript should not throw an error if the script removed itself\",\n  function(t) {\n    var script = document.createElement(\"script\");\n    script.id = \"myScript\";\n    script.innerHTML =\n      \"const script = document.querySelector('#myScript');\" +\n      \"script.parentNode.removeChild(script);\";\n\n    try {\n      evalScript(script);\n\n      t.pass(\"Missing script tested successfully\");\n    } catch (e) {\n      console.error(e);\n      t.fail(\"Attempted to remove missing script\");\n    }\n\n    t.end();\n  }\n);\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar evalScript = require(\"../../lib/eval-script\");\n\ntape(\"test evalScript method\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed'\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n\n  evalScript(script);\n  t.equal(\n    document.body.className,\n    \"executed\",\n    \"script has been properly executed\"\n  );\n\n  script.innerHTML = \"document.write('failure')\";\n  var bodyText = \"document.write hasn't been executed\";\n  document.body.text = bodyText;\n  evalScript(script);\n  t.equal(document.body.text, bodyText, \"document.write hasn't been executed\");\n\n  t.end();\n});\n\ntape(\n  \"evalScript should not throw an error if the script removed itself\",\n  function(t) {\n    var script = document.createElement(\"script\");\n    script.id = \"myScript\";\n    script.innerHTML =\n      \"const script = document.querySelector('#myScript');\" +\n      \"script.parentNode.removeChild(script);\";\n\n    try {\n      evalScript(script);\n\n      t.pass(\"Missing script tested successfully\");\n    } catch (e) {\n      console.error(e);\n      t.fail(\"Attempted to remove missing script\");\n    }\n\n    t.end();\n  }\n);\n"},{"_content":"var tape = require(\"tape\");\n\nvar on = require(\"../../lib/events/on\");\nvar off = require(\"../../lib/events/off\");\nvar trigger = require(\"../../lib/events/trigger\");\n\nvar el = document.createElement(\"div\");\nvar el2 = document.createElement(\"span\");\nvar els = [el, el2];\n\nvar classCb = function() {\n  this.className += \"on\";\n};\nvar attrCb = function() {\n  this.setAttribute(\"data-state\", this.getAttribute(\"data-state\") + \"ON\");\n};\n\ntape(\"test events on/off/trigger for one element, one event\", function(t) {\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"on\", \"attached callback has been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"off\", \"triggered event didn't fire detached callback\");\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for multiple elements, one event\", function(\n  t\n) {\n  el.className = \"\";\n  el2.className = \"\";\n\n  on(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"on\",\n    \"attached callback has been fired properly on the second element\"\n  );\n\n  el.className = \"off\";\n  el2.className = \"off\";\n  off(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the second element\"\n  );\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for one element, multiple events\", function(\n  t\n) {\n  el.className = \"\";\n  on(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(el.className, \"onon\", \"attached callbacks have been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered events didn't fire detached callback\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events on/off/trigger for multiple elements, multiple events\",\n  function(t) {\n    el.className = \"\";\n    el2.className = \"\";\n    el.setAttribute(\"data-state\", \"\");\n    el2.setAttribute(\"data-state\", \"\");\n    on(els, \"click mouseover\", classCb);\n    on(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n\n    el.className = \"off\";\n    el2.className = \"off\";\n    el.setAttribute(\"data-state\", \"off\");\n    el2.setAttribute(\"data-state\", \"off\");\n    off(els, \"click mouseover\", classCb);\n    off(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test events on top level elements\", function(t) {\n  var el = document;\n\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on document\"\n  );\n\n  el = window;\n\n  el.className = \"\";\n  // With jsdom, the default this is global, not window, so we need to explicitly bind to window.\n  on(el, \"click\", classCb.bind(window));\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on window\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/events.js","raw":"var tape = require(\"tape\");\n\nvar on = require(\"../../lib/events/on\");\nvar off = require(\"../../lib/events/off\");\nvar trigger = require(\"../../lib/events/trigger\");\n\nvar el = document.createElement(\"div\");\nvar el2 = document.createElement(\"span\");\nvar els = [el, el2];\n\nvar classCb = function() {\n  this.className += \"on\";\n};\nvar attrCb = function() {\n  this.setAttribute(\"data-state\", this.getAttribute(\"data-state\") + \"ON\");\n};\n\ntape(\"test events on/off/trigger for one element, one event\", function(t) {\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"on\", \"attached callback has been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"off\", \"triggered event didn't fire detached callback\");\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for multiple elements, one event\", function(\n  t\n) {\n  el.className = \"\";\n  el2.className = \"\";\n\n  on(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"on\",\n    \"attached callback has been fired properly on the second element\"\n  );\n\n  el.className = \"off\";\n  el2.className = \"off\";\n  off(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the second element\"\n  );\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for one element, multiple events\", function(\n  t\n) {\n  el.className = \"\";\n  on(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(el.className, \"onon\", \"attached callbacks have been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered events didn't fire detached callback\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events on/off/trigger for multiple elements, multiple events\",\n  function(t) {\n    el.className = \"\";\n    el2.className = \"\";\n    el.setAttribute(\"data-state\", \"\");\n    el2.setAttribute(\"data-state\", \"\");\n    on(els, \"click mouseover\", classCb);\n    on(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n\n    el.className = \"off\";\n    el2.className = \"off\";\n    el.setAttribute(\"data-state\", \"off\");\n    el2.setAttribute(\"data-state\", \"off\");\n    off(els, \"click mouseover\", classCb);\n    off(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test events on top level elements\", function(t) {\n  var el = document;\n\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on document\"\n  );\n\n  el = window;\n\n  el.className = \"\";\n  // With jsdom, the default this is global, not window, so we need to explicitly bind to window.\n  on(el, \"click\", classCb.bind(window));\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on window\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.684Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/events.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4v0012nwlwcqpl5gnz","content":"var tape = require(\"tape\");\n\nvar on = require(\"../../lib/events/on\");\nvar off = require(\"../../lib/events/off\");\nvar trigger = require(\"../../lib/events/trigger\");\n\nvar el = document.createElement(\"div\");\nvar el2 = document.createElement(\"span\");\nvar els = [el, el2];\n\nvar classCb = function() {\n  this.className += \"on\";\n};\nvar attrCb = function() {\n  this.setAttribute(\"data-state\", this.getAttribute(\"data-state\") + \"ON\");\n};\n\ntape(\"test events on/off/trigger for one element, one event\", function(t) {\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"on\", \"attached callback has been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"off\", \"triggered event didn't fire detached callback\");\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for multiple elements, one event\", function(\n  t\n) {\n  el.className = \"\";\n  el2.className = \"\";\n\n  on(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"on\",\n    \"attached callback has been fired properly on the second element\"\n  );\n\n  el.className = \"off\";\n  el2.className = \"off\";\n  off(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the second element\"\n  );\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for one element, multiple events\", function(\n  t\n) {\n  el.className = \"\";\n  on(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(el.className, \"onon\", \"attached callbacks have been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered events didn't fire detached callback\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events on/off/trigger for multiple elements, multiple events\",\n  function(t) {\n    el.className = \"\";\n    el2.className = \"\";\n    el.setAttribute(\"data-state\", \"\");\n    el2.setAttribute(\"data-state\", \"\");\n    on(els, \"click mouseover\", classCb);\n    on(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n\n    el.className = \"off\";\n    el2.className = \"off\";\n    el.setAttribute(\"data-state\", \"off\");\n    el2.setAttribute(\"data-state\", \"off\");\n    off(els, \"click mouseover\", classCb);\n    off(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test events on top level elements\", function(t) {\n  var el = document;\n\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on document\"\n  );\n\n  el = window;\n\n  el.className = \"\";\n  // With jsdom, the default this is global, not window, so we need to explicitly bind to window.\n  on(el, \"click\", classCb.bind(window));\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on window\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar on = require(\"../../lib/events/on\");\nvar off = require(\"../../lib/events/off\");\nvar trigger = require(\"../../lib/events/trigger\");\n\nvar el = document.createElement(\"div\");\nvar el2 = document.createElement(\"span\");\nvar els = [el, el2];\n\nvar classCb = function() {\n  this.className += \"on\";\n};\nvar attrCb = function() {\n  this.setAttribute(\"data-state\", this.getAttribute(\"data-state\") + \"ON\");\n};\n\ntape(\"test events on/off/trigger for one element, one event\", function(t) {\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"on\", \"attached callback has been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(el.className, \"off\", \"triggered event didn't fire detached callback\");\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for multiple elements, one event\", function(\n  t\n) {\n  el.className = \"\";\n  el2.className = \"\";\n\n  on(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"on\",\n    \"attached callback has been fired properly on the second element\"\n  );\n\n  el.className = \"off\";\n  el2.className = \"off\";\n  off(els, \"click\", classCb);\n  trigger(els, \"click\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the first element\"\n  );\n  t.equal(\n    el2.className,\n    \"off\",\n    \"triggered event didn't fire detached callback on the second element\"\n  );\n\n  t.end();\n});\n\ntape(\"test events on/off/trigger for one element, multiple events\", function(\n  t\n) {\n  el.className = \"\";\n  on(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(el.className, \"onon\", \"attached callbacks have been fired properly\");\n\n  el.className = \"off\";\n  off(el, \"click mouseover\", classCb);\n  trigger(el, \"click mouseover\");\n  t.equal(\n    el.className,\n    \"off\",\n    \"triggered events didn't fire detached callback\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events on/off/trigger for multiple elements, multiple events\",\n  function(t) {\n    el.className = \"\";\n    el2.className = \"\";\n    el.setAttribute(\"data-state\", \"\");\n    el2.setAttribute(\"data-state\", \"\");\n    on(els, \"click mouseover\", classCb);\n    on(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"onon\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"ONON\",\n      \"attached callbacks has been fired properly on the second element\"\n    );\n\n    el.className = \"off\";\n    el2.className = \"off\";\n    el.setAttribute(\"data-state\", \"off\");\n    el2.setAttribute(\"data-state\", \"off\");\n    off(els, \"click mouseover\", classCb);\n    off(els, \"resize scroll\", attrCb);\n    trigger(els, \"click mouseover resize scroll\");\n    t.equal(\n      el.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.className,\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n    t.equal(\n      el2.getAttribute(\"data-state\"),\n      \"off\",\n      \"triggered events didn't fire detached callbacks on the first element\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test events on top level elements\", function(t) {\n  var el = document;\n\n  el.className = \"\";\n  on(el, \"click\", classCb);\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on document\"\n  );\n\n  el = window;\n\n  el.className = \"\";\n  // With jsdom, the default this is global, not window, so we need to explicitly bind to window.\n  on(el, \"click\", classCb.bind(window));\n  trigger(el, \"click\");\n  t.equal(\n    el.className,\n    \"on\",\n    \"attached callback has been fired properly on window\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-els.js\");\n\nvar div = document.createElement(\"div\");\nvar span = document.createElement(\"span\");\nvar cb = function(el) {\n  el.innerHTML = \"boom\";\n};\n\ntape(\"test forEachEls on one element\", function(t) {\n  div.innerHTML = \"div tag\";\n  forEachEls(div, cb);\n\n  t.equal(div.innerHTML, \"boom\", \"works correctly on one element\");\n  t.end();\n});\n\ntape(\"test forEachEls on an array\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  forEachEls([div, span], cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the array\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the array\"\n  );\n\n  t.end();\n});\n\ntape(\"test forEachEls on a NodeList\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  var frag = document.createDocumentFragment();\n  frag.appendChild(div);\n  frag.appendChild(span);\n  forEachEls(frag.childNodes, cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the document fragment\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the document fragment\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/foreach-els.js","raw":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-els.js\");\n\nvar div = document.createElement(\"div\");\nvar span = document.createElement(\"span\");\nvar cb = function(el) {\n  el.innerHTML = \"boom\";\n};\n\ntape(\"test forEachEls on one element\", function(t) {\n  div.innerHTML = \"div tag\";\n  forEachEls(div, cb);\n\n  t.equal(div.innerHTML, \"boom\", \"works correctly on one element\");\n  t.end();\n});\n\ntape(\"test forEachEls on an array\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  forEachEls([div, span], cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the array\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the array\"\n  );\n\n  t.end();\n});\n\ntape(\"test forEachEls on a NodeList\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  var frag = document.createDocumentFragment();\n  frag.appendChild(div);\n  frag.appendChild(span);\n  forEachEls(frag.childNodes, cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the document fragment\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the document fragment\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.691Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/foreach-els.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4w0013nwlwabuxhdx0","content":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-els.js\");\n\nvar div = document.createElement(\"div\");\nvar span = document.createElement(\"span\");\nvar cb = function(el) {\n  el.innerHTML = \"boom\";\n};\n\ntape(\"test forEachEls on one element\", function(t) {\n  div.innerHTML = \"div tag\";\n  forEachEls(div, cb);\n\n  t.equal(div.innerHTML, \"boom\", \"works correctly on one element\");\n  t.end();\n});\n\ntape(\"test forEachEls on an array\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  forEachEls([div, span], cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the array\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the array\"\n  );\n\n  t.end();\n});\n\ntape(\"test forEachEls on a NodeList\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  var frag = document.createDocumentFragment();\n  frag.appendChild(div);\n  frag.appendChild(span);\n  forEachEls(frag.childNodes, cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the document fragment\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the document fragment\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-els.js\");\n\nvar div = document.createElement(\"div\");\nvar span = document.createElement(\"span\");\nvar cb = function(el) {\n  el.innerHTML = \"boom\";\n};\n\ntape(\"test forEachEls on one element\", function(t) {\n  div.innerHTML = \"div tag\";\n  forEachEls(div, cb);\n\n  t.equal(div.innerHTML, \"boom\", \"works correctly on one element\");\n  t.end();\n});\n\ntape(\"test forEachEls on an array\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  forEachEls([div, span], cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the array\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the array\"\n  );\n\n  t.end();\n});\n\ntape(\"test forEachEls on a NodeList\", function(t) {\n  div.innerHTML = \"div tag\";\n  span.innerHTML = \"span tag\";\n\n  var frag = document.createDocumentFragment();\n  frag.appendChild(div);\n  frag.appendChild(span);\n  forEachEls(frag.childNodes, cb);\n\n  t.equal(\n    div.innerHTML,\n    \"boom\",\n    \"works correctly on the first element of the document fragment\"\n  );\n  t.equal(\n    span.innerHTML,\n    \"boom\",\n    \"works correctly on the last element of the document fragment\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar executeScripts = require(\"../../lib/execute-scripts\");\n\ntape(\n  \"test executeScripts method when the script tag is inside a container\",\n  function(t) {\n    document.body.className = \"\";\n\n    var container = document.createElement(\"div\");\n    container.innerHTML =\n      \"<\" +\n      \"script\" +\n      \">document.body.className = 'executed';</\" +\n      \"script\" +\n      \"><\" +\n      \"script\" +\n      \">document.body.className += ' correctly';</\" +\n      \"script\" +\n      \">\";\n\n    t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n    executeScripts(container);\n    t.equal(\n      document.body.className,\n      \"executed correctly\",\n      \"script has been properly executed\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test executeScripts method with just a script tag\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed correctly';\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n  executeScripts(script);\n  t.equal(\n    document.body.className,\n    \"executed correctly\",\n    \"script has been properly executed\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/execute-scripts.js","raw":"var tape = require(\"tape\");\n\nvar executeScripts = require(\"../../lib/execute-scripts\");\n\ntape(\n  \"test executeScripts method when the script tag is inside a container\",\n  function(t) {\n    document.body.className = \"\";\n\n    var container = document.createElement(\"div\");\n    container.innerHTML =\n      \"<\" +\n      \"script\" +\n      \">document.body.className = 'executed';</\" +\n      \"script\" +\n      \"><\" +\n      \"script\" +\n      \">document.body.className += ' correctly';</\" +\n      \"script\" +\n      \">\";\n\n    t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n    executeScripts(container);\n    t.equal(\n      document.body.className,\n      \"executed correctly\",\n      \"script has been properly executed\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test executeScripts method with just a script tag\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed correctly';\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n  executeScripts(script);\n  t.equal(\n    document.body.className,\n    \"executed correctly\",\n    \"script has been properly executed\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.688Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/execute-scripts.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4w0014nwlwaqvqd7zx","content":"var tape = require(\"tape\");\n\nvar executeScripts = require(\"../../lib/execute-scripts\");\n\ntape(\n  \"test executeScripts method when the script tag is inside a container\",\n  function(t) {\n    document.body.className = \"\";\n\n    var container = document.createElement(\"div\");\n    container.innerHTML =\n      \"<\" + \"script\" \">document.body.className = 'executed';</\"><\" + \"script\" \">document.body.className += ' correctly';</\">\";\n\n    t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n    executeScripts(container);\n    t.equal(\n      document.body.className,\n      \"executed correctly\",\n      \"script has been properly executed\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test executeScripts method with just a script tag\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed correctly';\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n  executeScripts(script);\n  t.equal(\n    document.body.className,\n    \"executed correctly\",\n    \"script has been properly executed\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar executeScripts = require(\"../../lib/execute-scripts\");\n\ntape(\n  \"test executeScripts method when the script tag is inside a container\",\n  function(t) {\n    document.body.className = \"\";\n\n    var container = document.createElement(\"div\");\n    container.innerHTML =\n      \"<\" + \"script\" \">document.body.className = 'executed';</\"><\" + \"script\" \">document.body.className += ' correctly';</\">\";\n\n    t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n    executeScripts(container);\n    t.equal(\n      document.body.className,\n      \"executed correctly\",\n      \"script has been properly executed\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test executeScripts method with just a script tag\", function(t) {\n  document.body.className = \"\";\n\n  var script = document.createElement(\"script\");\n  script.innerHTML = \"document.body.className = 'executed correctly';\";\n\n  t.equal(document.body.className, \"\", \"script hasn't been executed yet\");\n  executeScripts(script);\n  t.equal(\n    document.body.className,\n    \"executed correctly\",\n    \"script has been properly executed\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-selectors.js\");\n\nvar cb = function(el) {\n  el.className = \"modified\";\n};\n\ntape(\"test forEachSelector\", function(t) {\n  forEachEls([\"html\", \"body\"], cb);\n\n  t.equal(\n    document.documentElement.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n\n  document.documentElement.className = \"\";\n  document.body.className = \"\";\n\n  forEachEls([\"html\", \"body\"], cb, null, document.documentElement);\n\n  t.equal(\n    document.documentElement.className,\n    \"\",\n    \"callback has not been executed on first selector when context is used\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector when context is used\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/foreach-selectors.js","raw":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-selectors.js\");\n\nvar cb = function(el) {\n  el.className = \"modified\";\n};\n\ntape(\"test forEachSelector\", function(t) {\n  forEachEls([\"html\", \"body\"], cb);\n\n  t.equal(\n    document.documentElement.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n\n  document.documentElement.className = \"\";\n  document.body.className = \"\";\n\n  forEachEls([\"html\", \"body\"], cb, null, document.documentElement);\n\n  t.equal(\n    document.documentElement.className,\n    \"\",\n    \"callback has not been executed on first selector when context is used\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector when context is used\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.692Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/foreach-selectors.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4x0015nwlw6clg6b9g","content":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-selectors.js\");\n\nvar cb = function(el) {\n  el.className = \"modified\";\n};\n\ntape(\"test forEachSelector\", function(t) {\n  forEachEls([\"html\", \"body\"], cb);\n\n  t.equal(\n    document.documentElement.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n\n  document.documentElement.className = \"\";\n  document.body.className = \"\";\n\n  forEachEls([\"html\", \"body\"], cb, null, document.documentElement);\n\n  t.equal(\n    document.documentElement.className,\n    \"\",\n    \"callback has not been executed on first selector when context is used\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector when context is used\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar forEachEls = require(\"../../lib/foreach-selectors.js\");\n\nvar cb = function(el) {\n  el.className = \"modified\";\n};\n\ntape(\"test forEachSelector\", function(t) {\n  forEachEls([\"html\", \"body\"], cb);\n\n  t.equal(\n    document.documentElement.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector\"\n  );\n\n  document.documentElement.className = \"\";\n  document.body.className = \"\";\n\n  forEachEls([\"html\", \"body\"], cb, null, document.documentElement);\n\n  t.equal(\n    document.documentElement.className,\n    \"\",\n    \"callback has not been executed on first selector when context is used\"\n  );\n  t.equal(\n    document.body.className,\n    \"modified\",\n    \"callback has been executed on first selector when context is used\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar isSupported = require(\"../../lib/is-supported.js\");\n\ntape(\"test isSupported method\", function(t) {\n  t.true(\n    isSupported(),\n    \"well, we run test on supported browser, so it should be ok here\"\n  );\n  t.end();\n});\n","source":"lib/pjax/tests/lib/is-supported.js","raw":"var tape = require(\"tape\");\n\nvar isSupported = require(\"../../lib/is-supported.js\");\n\ntape(\"test isSupported method\", function(t) {\n  t.true(\n    isSupported(),\n    \"well, we run test on supported browser, so it should be ok here\"\n  );\n  t.end();\n});\n","date":"2021-10-30T06:38:12.693Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/is-supported.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4y0016nwlwel2p31wr","content":"var tape = require(\"tape\");\n\nvar isSupported = require(\"../../lib/is-supported.js\");\n\ntape(\"test isSupported method\", function(t) {\n  t.true(\n    isSupported(),\n    \"well, we run test on supported browser, so it should be ok here\"\n  );\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar isSupported = require(\"../../lib/is-supported.js\");\n\ntape(\"test isSupported method\", function(t) {\n  t.true(\n    isSupported(),\n    \"well, we run test on supported browser, so it should be ok here\"\n  );\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar parseOptions = require(\"../../lib/parse-options.js\");\n\ntape(\"test parse initalization options function\", function(t) {\n  t.test(\"- default options\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({});\n\n    t.equal(pjax.options.elements, \"a[href], form[action]\");\n    t.equal(pjax.options.selectors.length, 2, \"selectors length\");\n    t.equal(pjax.options.selectors[0], \"title\");\n    t.equal(pjax.options.selectors[1], \".js-Pjax\");\n\n    t.equal(typeof pjax.options.switches, \"object\");\n    t.equal(Object.keys(pjax.options.switches).length, 2); // head and body\n\n    t.equal(typeof pjax.options.switchesOptions, \"object\");\n    t.equal(Object.keys(pjax.options.switchesOptions).length, 0);\n\n    t.equal(pjax.options.history, true);\n    t.equal(typeof pjax.options.analytics, \"function\");\n    t.equal(pjax.options.scrollTo, 0);\n    t.equal(pjax.options.scrollRestoration, true);\n    t.equal(pjax.options.cacheBust, true);\n    t.equal(pjax.options.debug, false);\n    t.equal(pjax.options.currentUrlFullReload, false);\n    t.end();\n  });\n\n  // verify analytics always ends up as a function even when passed not a function\n  t.test(\"- analytics is a function\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ analytics: \"some string\" });\n\n    t.deepEqual(typeof pjax.options.analytics, \"function\");\n    t.end();\n  });\n\n  // verify that the value false for scrollTo is not squashed\n  t.test(\"- scrollTo remains false\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ scrollTo: false });\n\n    t.deepEqual(pjax.options.scrollTo, false);\n    t.end();\n  });\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/parse-options.js","raw":"var tape = require(\"tape\");\n\nvar parseOptions = require(\"../../lib/parse-options.js\");\n\ntape(\"test parse initalization options function\", function(t) {\n  t.test(\"- default options\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({});\n\n    t.equal(pjax.options.elements, \"a[href], form[action]\");\n    t.equal(pjax.options.selectors.length, 2, \"selectors length\");\n    t.equal(pjax.options.selectors[0], \"title\");\n    t.equal(pjax.options.selectors[1], \".js-Pjax\");\n\n    t.equal(typeof pjax.options.switches, \"object\");\n    t.equal(Object.keys(pjax.options.switches).length, 2); // head and body\n\n    t.equal(typeof pjax.options.switchesOptions, \"object\");\n    t.equal(Object.keys(pjax.options.switchesOptions).length, 0);\n\n    t.equal(pjax.options.history, true);\n    t.equal(typeof pjax.options.analytics, \"function\");\n    t.equal(pjax.options.scrollTo, 0);\n    t.equal(pjax.options.scrollRestoration, true);\n    t.equal(pjax.options.cacheBust, true);\n    t.equal(pjax.options.debug, false);\n    t.equal(pjax.options.currentUrlFullReload, false);\n    t.end();\n  });\n\n  // verify analytics always ends up as a function even when passed not a function\n  t.test(\"- analytics is a function\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ analytics: \"some string\" });\n\n    t.deepEqual(typeof pjax.options.analytics, \"function\");\n    t.end();\n  });\n\n  // verify that the value false for scrollTo is not squashed\n  t.test(\"- scrollTo remains false\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ scrollTo: false });\n\n    t.deepEqual(pjax.options.scrollTo, false);\n    t.end();\n  });\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.694Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/parse-options.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y4y0017nwlw4z75ebmq","content":"var tape = require(\"tape\");\n\nvar parseOptions = require(\"../../lib/parse-options.js\");\n\ntape(\"test parse initalization options function\", function(t) {\n  t.test(\"- default options\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({});\n\n    t.equal(pjax.options.elements, \"a[href], form[action]\");\n    t.equal(pjax.options.selectors.length, 2, \"selectors length\");\n    t.equal(pjax.options.selectors[0], \"title\");\n    t.equal(pjax.options.selectors[1], \".js-Pjax\");\n\n    t.equal(typeof pjax.options.switches, \"object\");\n    t.equal(Object.keys(pjax.options.switches).length, 2); // head and body\n\n    t.equal(typeof pjax.options.switchesOptions, \"object\");\n    t.equal(Object.keys(pjax.options.switchesOptions).length, 0);\n\n    t.equal(pjax.options.history, true);\n    t.equal(typeof pjax.options.analytics, \"function\");\n    t.equal(pjax.options.scrollTo, 0);\n    t.equal(pjax.options.scrollRestoration, true);\n    t.equal(pjax.options.cacheBust, true);\n    t.equal(pjax.options.debug, false);\n    t.equal(pjax.options.currentUrlFullReload, false);\n    t.end();\n  });\n\n  // verify analytics always ends up as a function even when passed not a function\n  t.test(\"- analytics is a function\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ analytics: \"some string\" });\n\n    t.deepEqual(typeof pjax.options.analytics, \"function\");\n    t.end();\n  });\n\n  // verify that the value false for scrollTo is not squashed\n  t.test(\"- scrollTo remains false\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ scrollTo: false });\n\n    t.deepEqual(pjax.options.scrollTo, false);\n    t.end();\n  });\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar parseOptions = require(\"../../lib/parse-options.js\");\n\ntape(\"test parse initalization options function\", function(t) {\n  t.test(\"- default options\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({});\n\n    t.equal(pjax.options.elements, \"a[href], form[action]\");\n    t.equal(pjax.options.selectors.length, 2, \"selectors length\");\n    t.equal(pjax.options.selectors[0], \"title\");\n    t.equal(pjax.options.selectors[1], \".js-Pjax\");\n\n    t.equal(typeof pjax.options.switches, \"object\");\n    t.equal(Object.keys(pjax.options.switches).length, 2); // head and body\n\n    t.equal(typeof pjax.options.switchesOptions, \"object\");\n    t.equal(Object.keys(pjax.options.switchesOptions).length, 0);\n\n    t.equal(pjax.options.history, true);\n    t.equal(typeof pjax.options.analytics, \"function\");\n    t.equal(pjax.options.scrollTo, 0);\n    t.equal(pjax.options.scrollRestoration, true);\n    t.equal(pjax.options.cacheBust, true);\n    t.equal(pjax.options.debug, false);\n    t.equal(pjax.options.currentUrlFullReload, false);\n    t.end();\n  });\n\n  // verify analytics always ends up as a function even when passed not a function\n  t.test(\"- analytics is a function\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ analytics: \"some string\" });\n\n    t.deepEqual(typeof pjax.options.analytics, \"function\");\n    t.end();\n  });\n\n  // verify that the value false for scrollTo is not squashed\n  t.test(\"- scrollTo remains false\", function(t) {\n    var pjax = {};\n    pjax.options = parseOptions({ scrollTo: false });\n\n    t.deepEqual(pjax.options.scrollTo, false);\n    t.end();\n  });\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test xhr request\", function(t) {\n  var url = \"https://httpbin.org/get\";\n\n  t.test(\"- request is made, gets a result, and is cache-busted\", function(t) {\n    var r = sendRequest(url, { cacheBust: true }, function(result) {\n      t.equal(\n        r.responseURL.indexOf(\"?\"),\n        url.length,\n        \"XHR URL is cache-busted when configured to be\"\n      );\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        t.fail(\"xhr doesn't get a JSON response\");\n      }\n      t.same(typeof result, \"object\", \"xhr request get a result\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not cache-busted when configured not to be\", function(\n    t\n  ) {\n    var r = sendRequest(url, {}, function() {\n      t.equal(r.responseURL, url, \"XHR URL is left untouched\");\n      t.end();\n    });\n  });\n  t.end();\n});\n\ntape(\"request headers are sent properly\", function(t) {\n  var url = \"https://httpbin.org/headers\";\n  var options = {\n    selectors: [\"div.pjax\", \"div.container\"]\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var headers = JSON.parse(responseText).headers;\n\n    t.equals(\n      headers[\"X-Requested-With\"],\n      \"XMLHttpRequest\",\n      \"X-Requested-With header is set correctly\"\n    );\n    // Httpbin.org changes the case to 'X-Pjax'\n    t.equals(headers[\"X-Pjax\"], \"true\", \"X-PJAX header is set correctly\");\n    t.equals(\n      headers[\"X-Pjax-Selectors\"],\n      '[\"div.pjax\",\"div.container\"]',\n      \"X-PJAX-Selectors header is set correctly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"HTTP status codes other than 200 are handled properly\", function(t) {\n  var url = \"https://httpbin.org/status/400\";\n\n  sendRequest(url, {}, function(responseText, request) {\n    t.equals(responseText, null, \"responseText is null\");\n    t.equals(request.status, 400, \"HTTP status code is correct\");\n\n    t.end();\n  });\n});\n\ntape.skip(\"XHR error is handled properly\", function(t) {\n  var url = \"https://encrypted.google.com/foobar\";\n\n  sendRequest(url, {}, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n\ntape(\"POST body data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/post\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestMethod: \"POST\",\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.form[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n    t.equals(\n      response.headers[\"Content-Type\"],\n      \"application/x-www-form-urlencoded\",\n      \"Content-Type header was set properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"GET query data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/get\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.args[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"XHR timeout is handled properly\", function(t) {\n  var url = \"https://httpbin.org/delay/5\";\n  var options = {\n    timeout: 1000\n  };\n\n  sendRequest(url, options, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n","source":"lib/pjax/tests/lib/send-request.js","raw":"var tape = require(\"tape\");\n\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test xhr request\", function(t) {\n  var url = \"https://httpbin.org/get\";\n\n  t.test(\"- request is made, gets a result, and is cache-busted\", function(t) {\n    var r = sendRequest(url, { cacheBust: true }, function(result) {\n      t.equal(\n        r.responseURL.indexOf(\"?\"),\n        url.length,\n        \"XHR URL is cache-busted when configured to be\"\n      );\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        t.fail(\"xhr doesn't get a JSON response\");\n      }\n      t.same(typeof result, \"object\", \"xhr request get a result\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not cache-busted when configured not to be\", function(\n    t\n  ) {\n    var r = sendRequest(url, {}, function() {\n      t.equal(r.responseURL, url, \"XHR URL is left untouched\");\n      t.end();\n    });\n  });\n  t.end();\n});\n\ntape(\"request headers are sent properly\", function(t) {\n  var url = \"https://httpbin.org/headers\";\n  var options = {\n    selectors: [\"div.pjax\", \"div.container\"]\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var headers = JSON.parse(responseText).headers;\n\n    t.equals(\n      headers[\"X-Requested-With\"],\n      \"XMLHttpRequest\",\n      \"X-Requested-With header is set correctly\"\n    );\n    // Httpbin.org changes the case to 'X-Pjax'\n    t.equals(headers[\"X-Pjax\"], \"true\", \"X-PJAX header is set correctly\");\n    t.equals(\n      headers[\"X-Pjax-Selectors\"],\n      '[\"div.pjax\",\"div.container\"]',\n      \"X-PJAX-Selectors header is set correctly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"HTTP status codes other than 200 are handled properly\", function(t) {\n  var url = \"https://httpbin.org/status/400\";\n\n  sendRequest(url, {}, function(responseText, request) {\n    t.equals(responseText, null, \"responseText is null\");\n    t.equals(request.status, 400, \"HTTP status code is correct\");\n\n    t.end();\n  });\n});\n\ntape.skip(\"XHR error is handled properly\", function(t) {\n  var url = \"https://encrypted.google.com/foobar\";\n\n  sendRequest(url, {}, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n\ntape(\"POST body data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/post\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestMethod: \"POST\",\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.form[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n    t.equals(\n      response.headers[\"Content-Type\"],\n      \"application/x-www-form-urlencoded\",\n      \"Content-Type header was set properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"GET query data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/get\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.args[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"XHR timeout is handled properly\", function(t) {\n  var url = \"https://httpbin.org/delay/5\";\n  var options = {\n    timeout: 1000\n  };\n\n  sendRequest(url, options, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n","date":"2021-10-30T06:38:12.701Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/send-request.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y530018nwlwfe8z220m","content":"var tape = require(\"tape\");\n\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test xhr request\", function(t) {\n  var url = \"https://httpbin.org/get\";\n\n  t.test(\"- request is made, gets a result, and is cache-busted\", function(t) {\n    var r = sendRequest(url, { cacheBust: true }, function(result) {\n      t.equal(\n        r.responseURL.indexOf(\"?\"),\n        url.length,\n        \"XHR URL is cache-busted when configured to be\"\n      );\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        t.fail(\"xhr doesn't get a JSON response\");\n      }\n      t.same(typeof result, \"object\", \"xhr request get a result\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not cache-busted when configured not to be\", function(\n    t\n  ) {\n    var r = sendRequest(url, {}, function() {\n      t.equal(r.responseURL, url, \"XHR URL is left untouched\");\n      t.end();\n    });\n  });\n  t.end();\n});\n\ntape(\"request headers are sent properly\", function(t) {\n  var url = \"https://httpbin.org/headers\";\n  var options = {\n    selectors: [\"div.pjax\", \"div.container\"]\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var headers = JSON.parse(responseText).headers;\n\n    t.equals(\n      headers[\"X-Requested-With\"],\n      \"XMLHttpRequest\",\n      \"X-Requested-With header is set correctly\"\n    );\n    // Httpbin.org changes the case to 'X-Pjax'\n    t.equals(headers[\"X-Pjax\"], \"true\", \"X-PJAX header is set correctly\");\n    t.equals(\n      headers[\"X-Pjax-Selectors\"],\n      '[\"div.pjax\",\"div.container\"]',\n      \"X-PJAX-Selectors header is set correctly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"HTTP status codes other than 200 are handled properly\", function(t) {\n  var url = \"https://httpbin.org/status/400\";\n\n  sendRequest(url, {}, function(responseText, request) {\n    t.equals(responseText, null, \"responseText is null\");\n    t.equals(request.status, 400, \"HTTP status code is correct\");\n\n    t.end();\n  });\n});\n\ntape.skip(\"XHR error is handled properly\", function(t) {\n  var url = \"https://encrypted.google.com/foobar\";\n\n  sendRequest(url, {}, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n\ntape(\"POST body data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/post\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestMethod: \"POST\",\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.form[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n    t.equals(\n      response.headers[\"Content-Type\"],\n      \"application/x-www-form-urlencoded\",\n      \"Content-Type header was set properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"GET query data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/get\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.args[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"XHR timeout is handled properly\", function(t) {\n  var url = \"https://httpbin.org/delay/5\";\n  var options = {\n    timeout: 1000\n  };\n\n  sendRequest(url, options, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar sendRequest = require(\"../../lib/send-request.js\");\n\n// Polyfill responseURL property into XMLHttpRequest if it doesn't exist,\n// just for the purposes of this test\n// This polyfill is not complete; it won't show the updated location if a\n// redirection occurred, but it's fine for our purposes.\nif (!(\"responseURL\" in XMLHttpRequest.prototype)) {\n  var nativeOpen = XMLHttpRequest.prototype.open;\n  XMLHttpRequest.prototype.open = function(method, url) {\n    this.responseURL = url;\n    return nativeOpen.apply(this, arguments);\n  };\n}\n\ntape(\"test xhr request\", function(t) {\n  var url = \"https://httpbin.org/get\";\n\n  t.test(\"- request is made, gets a result, and is cache-busted\", function(t) {\n    var r = sendRequest(url, { cacheBust: true }, function(result) {\n      t.equal(\n        r.responseURL.indexOf(\"?\"),\n        url.length,\n        \"XHR URL is cache-busted when configured to be\"\n      );\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        t.fail(\"xhr doesn't get a JSON response\");\n      }\n      t.same(typeof result, \"object\", \"xhr request get a result\");\n      t.end();\n    });\n  });\n  t.test(\"- request is not cache-busted when configured not to be\", function(\n    t\n  ) {\n    var r = sendRequest(url, {}, function() {\n      t.equal(r.responseURL, url, \"XHR URL is left untouched\");\n      t.end();\n    });\n  });\n  t.end();\n});\n\ntape(\"request headers are sent properly\", function(t) {\n  var url = \"https://httpbin.org/headers\";\n  var options = {\n    selectors: [\"div.pjax\", \"div.container\"]\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var headers = JSON.parse(responseText).headers;\n\n    t.equals(\n      headers[\"X-Requested-With\"],\n      \"XMLHttpRequest\",\n      \"X-Requested-With header is set correctly\"\n    );\n    // Httpbin.org changes the case to 'X-Pjax'\n    t.equals(headers[\"X-Pjax\"], \"true\", \"X-PJAX header is set correctly\");\n    t.equals(\n      headers[\"X-Pjax-Selectors\"],\n      '[\"div.pjax\",\"div.container\"]',\n      \"X-PJAX-Selectors header is set correctly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"HTTP status codes other than 200 are handled properly\", function(t) {\n  var url = \"https://httpbin.org/status/400\";\n\n  sendRequest(url, {}, function(responseText, request) {\n    t.equals(responseText, null, \"responseText is null\");\n    t.equals(request.status, 400, \"HTTP status code is correct\");\n\n    t.end();\n  });\n});\n\ntape.skip(\"XHR error is handled properly\", function(t) {\n  var url = \"https://encrypted.google.com/foobar\";\n\n  sendRequest(url, {}, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n\ntape(\"POST body data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/post\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestMethod: \"POST\",\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.form[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n    t.equals(\n      response.headers[\"Content-Type\"],\n      \"application/x-www-form-urlencoded\",\n      \"Content-Type header was set properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"GET query data is sent properly\", function(t) {\n  var url = \"https://httpbin.org/get\";\n  var params = [\n    {\n      name: \"test\",\n      value: \"1\"\n    }\n  ];\n  var options = {\n    requestOptions: {\n      requestParams: params\n    }\n  };\n\n  sendRequest(url, options, function(responseText) {\n    var response = JSON.parse(responseText);\n\n    t.same(\n      response.args[params[0].name],\n      params[0].value,\n      \"requestParams were sent properly\"\n    );\n\n    t.end();\n  });\n});\n\ntape(\"XHR timeout is handled properly\", function(t) {\n  var url = \"https://httpbin.org/delay/5\";\n  var options = {\n    timeout: 1000\n  };\n\n  sendRequest(url, options, function(responseText) {\n    t.equals(responseText, null, \"responseText is null\");\n\n    t.end();\n  });\n});\n"},{"_content":"var tape = require(\"tape\");\nvar switches = require(\"../../lib/switches\");\nvar noop = require(\"../../lib/util/noop\");\n\ntape(\"test outerHTML switch\", function(t) {\n  var outerHTML = switches.outerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id='p'>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  outerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.notEquals(\n    doc.querySelector(\"p\").id,\n    \"p\",\n    \"other attributes overwritten correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test innerHTML switch\", function(t) {\n  var innerHTML = switches.innerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id='p'>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n  p.className = \"p\";\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.equals(doc.querySelector(\"p\").className, \"p\", \"classname set correctly\");\n  t.equals(doc.querySelector(\"p\").id, \"p\", \"other attributes set correctly\");\n\n  p.removeAttribute(\"class\");\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(doc.querySelector(\"p\").className, \"\", \"classname set correctly\");\n\n  t.end();\n});\n\ntape(\"test replaceNode switch\", function(t) {\n  var replaceNode = switches.replaceNode;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  replaceNode.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"div\").innerHTML,\n    \"<p>New Text</p>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/switches.js","raw":"var tape = require(\"tape\");\nvar switches = require(\"../../lib/switches\");\nvar noop = require(\"../../lib/util/noop\");\n\ntape(\"test outerHTML switch\", function(t) {\n  var outerHTML = switches.outerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id='p'>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  outerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.notEquals(\n    doc.querySelector(\"p\").id,\n    \"p\",\n    \"other attributes overwritten correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test innerHTML switch\", function(t) {\n  var innerHTML = switches.innerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id='p'>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n  p.className = \"p\";\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.equals(doc.querySelector(\"p\").className, \"p\", \"classname set correctly\");\n  t.equals(doc.querySelector(\"p\").id, \"p\", \"other attributes set correctly\");\n\n  p.removeAttribute(\"class\");\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(doc.querySelector(\"p\").className, \"\", \"classname set correctly\");\n\n  t.end();\n});\n\ntape(\"test replaceNode switch\", function(t) {\n  var replaceNode = switches.replaceNode;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  replaceNode.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"div\").innerHTML,\n    \"<p>New Text</p>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.704Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/switches.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y550019nwlwdi313qay","content":"var tape = require(\"tape\");\nvar switches = require(\"../../lib/switches\");\nvar noop = require(\"../../lib/util/noop\");\n\ntape(\"test outerHTML switch\", function(t) {\n  var outerHTML = switches.outerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id=\"p\">Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  outerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.notEquals(\n    doc.querySelector(\"p\").id,\n    \"p\",\n    \"other attributes overwritten correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test innerHTML switch\", function(t) {\n  var innerHTML = switches.innerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id=\"p\">Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n  p.className = \"p\";\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.equals(doc.querySelector(\"p\").className, \"p\", \"classname set correctly\");\n  t.equals(doc.querySelector(\"p\").id, \"p\", \"other attributes set correctly\");\n\n  p.removeAttribute(\"class\");\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(doc.querySelector(\"p\").className, \"\", \"classname set correctly\");\n\n  t.end();\n});\n\ntape(\"test replaceNode switch\", function(t) {\n  var replaceNode = switches.replaceNode;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  replaceNode.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"div\").innerHTML,\n    \"<p>New Text</p>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\nvar switches = require(\"../../lib/switches\");\nvar noop = require(\"../../lib/util/noop\");\n\ntape(\"test outerHTML switch\", function(t) {\n  var outerHTML = switches.outerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id=\"p\">Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  outerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.notEquals(\n    doc.querySelector(\"p\").id,\n    \"p\",\n    \"other attributes overwritten correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test innerHTML switch\", function(t) {\n  var innerHTML = switches.innerHTML;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p id=\"p\">Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n  p.className = \"p\";\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"p\").innerHTML,\n    \"New Text\",\n    \"Elements correctly switched\"\n  );\n  t.equals(doc.querySelector(\"p\").className, \"p\", \"classname set correctly\");\n  t.equals(doc.querySelector(\"p\").id, \"p\", \"other attributes set correctly\");\n\n  p.removeAttribute(\"class\");\n\n  innerHTML.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(doc.querySelector(\"p\").className, \"\", \"classname set correctly\");\n\n  t.end();\n});\n\ntape(\"test replaceNode switch\", function(t) {\n  var replaceNode = switches.replaceNode;\n\n  var doc = document.implementation.createHTMLDocument();\n\n  var container = doc.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p>\";\n  doc.body.appendChild(container);\n\n  var p = doc.createElement(\"p\");\n  p.innerHTML = \"New Text\";\n\n  replaceNode.bind({\n    onSwitch: noop\n  })(doc.querySelector(\"p\"), p);\n\n  t.equals(\n    doc.querySelector(\"div\").innerHTML,\n    \"<p>New Text</p>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar switchesSelectors = require(\"../../lib/switches-selectors.js\");\nvar noop = require(\"../../lib/util/noop\");\n\nvar pjax = {\n  onSwitch: function() {\n    console.log(\"Switched\");\n  },\n  state: {},\n  log: noop\n};\n\n// @author darylteo\ntape(\"test switchesSelectors\", function(t) {\n  // switchesSelectors relies on a higher level function callback\n  // should really be passed in instead so I'll leave it here as a TODO:\n  var tmpEl = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = document.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p><span>No Change</span>\";\n  document.body.appendChild(container);\n\n  var container2 = tmpEl.createElement(\"div\");\n  container2.innerHTML = \"<p>New Text</p><span>New Span</span>\";\n  tmpEl.body.appendChild(container2);\n\n  switchesSelectors.bind(pjax)(\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    tmpEl, // fromEl\n    document, // toEl,\n    {} // options\n  );\n\n  t.equals(\n    container.innerHTML,\n    \"<p>New Text</p><span>No Change</span>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n\ntape(\"test switchesSelectors when number of elements don't match\", function(t) {\n  var newTempDoc = document.implementation.createHTMLDocument();\n  var originalTempDoc = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = originalTempDoc.createElement(\"div\");\n  container.innerHTML = \"<p>Original text</p><span>No change</span>\";\n  originalTempDoc.body.appendChild(container);\n\n  var container2 = newTempDoc.createElement(\"div\");\n  container2.innerHTML =\n    \"<p>New text</p><p>More new text</p><span>New span</span>\";\n  newTempDoc.body.appendChild(container2);\n\n  var switchSelectorsFn = switchesSelectors.bind(\n    pjax,\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    newTempDoc, // fromEl\n    originalTempDoc, // toEl,\n    {} // options\n  );\n\n  t.throws(\n    switchSelectorsFn,\n    null,\n    \"error was thrown properly since number of elements don't match\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/switch-selectors.js","raw":"var tape = require(\"tape\");\n\nvar switchesSelectors = require(\"../../lib/switches-selectors.js\");\nvar noop = require(\"../../lib/util/noop\");\n\nvar pjax = {\n  onSwitch: function() {\n    console.log(\"Switched\");\n  },\n  state: {},\n  log: noop\n};\n\n// @author darylteo\ntape(\"test switchesSelectors\", function(t) {\n  // switchesSelectors relies on a higher level function callback\n  // should really be passed in instead so I'll leave it here as a TODO:\n  var tmpEl = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = document.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p><span>No Change</span>\";\n  document.body.appendChild(container);\n\n  var container2 = tmpEl.createElement(\"div\");\n  container2.innerHTML = \"<p>New Text</p><span>New Span</span>\";\n  tmpEl.body.appendChild(container2);\n\n  switchesSelectors.bind(pjax)(\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    tmpEl, // fromEl\n    document, // toEl,\n    {} // options\n  );\n\n  t.equals(\n    container.innerHTML,\n    \"<p>New Text</p><span>No Change</span>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n\ntape(\"test switchesSelectors when number of elements don't match\", function(t) {\n  var newTempDoc = document.implementation.createHTMLDocument();\n  var originalTempDoc = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = originalTempDoc.createElement(\"div\");\n  container.innerHTML = \"<p>Original text</p><span>No change</span>\";\n  originalTempDoc.body.appendChild(container);\n\n  var container2 = newTempDoc.createElement(\"div\");\n  container2.innerHTML =\n    \"<p>New text</p><p>More new text</p><span>New span</span>\";\n  newTempDoc.body.appendChild(container2);\n\n  var switchSelectorsFn = switchesSelectors.bind(\n    pjax,\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    newTempDoc, // fromEl\n    originalTempDoc, // toEl,\n    {} // options\n  );\n\n  t.throws(\n    switchSelectorsFn,\n    null,\n    \"error was thrown properly since number of elements don't match\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.702Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/switch-selectors.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y57001anwlw2gz463ne","content":"var tape = require(\"tape\");\n\nvar switchesSelectors = require(\"../../lib/switches-selectors.js\");\nvar noop = require(\"../../lib/util/noop\");\n\nvar pjax = {\n  onSwitch: function() {\n    console.log(\"Switched\");\n  },\n  state: {},\n  log: noop\n};\n\n// @author darylteo\ntape(\"test switchesSelectors\", function(t) {\n  // switchesSelectors relies on a higher level function callback\n  // should really be passed in instead so I'll leave it here as a TODO:\n  var tmpEl = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = document.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p><span>No Change</span>\";\n  document.body.appendChild(container);\n\n  var container2 = tmpEl.createElement(\"div\");\n  container2.innerHTML = \"<p>New Text</p><span>New Span</span>\";\n  tmpEl.body.appendChild(container2);\n\n  switchesSelectors.bind(pjax)(\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    tmpEl, // fromEl\n    document, // toEl,\n    {} // options\n  );\n\n  t.equals(\n    container.innerHTML,\n    \"<p>New Text</p><span>No Change</span>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n\ntape(\"test switchesSelectors when number of elements don't match\", function(t) {\n  var newTempDoc = document.implementation.createHTMLDocument();\n  var originalTempDoc = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = originalTempDoc.createElement(\"div\");\n  container.innerHTML = \"<p>Original text</p><span>No change</span>\";\n  originalTempDoc.body.appendChild(container);\n\n  var container2 = newTempDoc.createElement(\"div\");\n  container2.innerHTML =\n    \"<p>New text</p><p>More new text</p><span>New span</span>\";\n  newTempDoc.body.appendChild(container2);\n\n  var switchSelectorsFn = switchesSelectors.bind(\n    pjax,\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    newTempDoc, // fromEl\n    originalTempDoc, // toEl,\n    {} // options\n  );\n\n  t.throws(\n    switchSelectorsFn,\n    null,\n    \"error was thrown properly since number of elements don't match\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar switchesSelectors = require(\"../../lib/switches-selectors.js\");\nvar noop = require(\"../../lib/util/noop\");\n\nvar pjax = {\n  onSwitch: function() {\n    console.log(\"Switched\");\n  },\n  state: {},\n  log: noop\n};\n\n// @author darylteo\ntape(\"test switchesSelectors\", function(t) {\n  // switchesSelectors relies on a higher level function callback\n  // should really be passed in instead so I'll leave it here as a TODO:\n  var tmpEl = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = document.createElement(\"div\");\n  container.innerHTML = \"<p>Original Text</p><span>No Change</span>\";\n  document.body.appendChild(container);\n\n  var container2 = tmpEl.createElement(\"div\");\n  container2.innerHTML = \"<p>New Text</p><span>New Span</span>\";\n  tmpEl.body.appendChild(container2);\n\n  switchesSelectors.bind(pjax)(\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    tmpEl, // fromEl\n    document, // toEl,\n    {} // options\n  );\n\n  t.equals(\n    container.innerHTML,\n    \"<p>New Text</p><span>No Change</span>\",\n    \"Elements correctly switched\"\n  );\n\n  t.end();\n});\n\ntape(\"test switchesSelectors when number of elements don't match\", function(t) {\n  var newTempDoc = document.implementation.createHTMLDocument();\n  var originalTempDoc = document.implementation.createHTMLDocument();\n\n  // a div container is used because swapping the containers\n  // will generate a new element, so things get weird\n  // using \"body\" generates a lot of testling cruft that I don't\n  // want so let's avoid that\n  var container = originalTempDoc.createElement(\"div\");\n  container.innerHTML = \"<p>Original text</p><span>No change</span>\";\n  originalTempDoc.body.appendChild(container);\n\n  var container2 = newTempDoc.createElement(\"div\");\n  container2.innerHTML =\n    \"<p>New text</p><p>More new text</p><span>New span</span>\";\n  newTempDoc.body.appendChild(container2);\n\n  var switchSelectorsFn = switchesSelectors.bind(\n    pjax,\n    {}, // switches\n    {}, // switchesOptions\n    [\"p\"], // selectors,\n    newTempDoc, // fromEl\n    originalTempDoc, // toEl,\n    {} // options\n  );\n\n  t.throws(\n    switchSelectorsFn,\n    null,\n    \"error was thrown properly since number of elements don't match\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar uniqueid = require(\"../../lib/uniqueid.js\");\n\ntape(\"test uniqueid\", function(t) {\n  var a = uniqueid();\n  var b = uniqueid();\n\n  t.notEqual(a, b, \"Two calls to uniqueid produce different values\");\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/uniqueid.js","raw":"var tape = require(\"tape\");\n\nvar uniqueid = require(\"../../lib/uniqueid.js\");\n\ntape(\"test uniqueid\", function(t) {\n  var a = uniqueid();\n  var b = uniqueid();\n\n  t.notEqual(a, b, \"Two calls to uniqueid produce different values\");\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.775Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/uniqueid.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y59001bnwlw3adf4x6r","content":"var tape = require(\"tape\");\n\nvar uniqueid = require(\"../../lib/uniqueid.js\");\n\ntape(\"test uniqueid\", function(t) {\n  var a = uniqueid();\n  var b = uniqueid();\n\n  t.notEqual(a, b, \"Two calls to uniqueid produce different values\");\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar uniqueid = require(\"../../lib/uniqueid.js\");\n\ntape(\"test uniqueid\", function(t) {\n  var a = uniqueid();\n  var b = uniqueid();\n\n  t.notEqual(a, b, \"Two calls to uniqueid produce different values\");\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachForm = require(\"../../../lib/proto/attach-form\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach form prototype method\", function(t) {\n  var form = document.createElement(\"form\");\n  var loadUrlCalled = false;\n\n  attachForm.call(\n    {\n      options: {\n        currentUrlFullReload: true\n      },\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  form.action = \"http://external.com/\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  form.action = internalUri + \"#anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  form.action = internalUri + \"#another-anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  form.action = internalUri + \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"anchor-empty\",\n    \"empty anchor stop behavior\"\n  );\n\n  form.action = window.location.href;\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"reload\",\n    \"submitting when currentUrlFullReload is true will submit normally, without XHR\"\n  );\n  t.equal(loadUrlCalled, false, \"loadUrl() not called\");\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"POST\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a POST request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  loadUrlCalled = false;\n  form.setAttribute(attr, \"\");\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a GET request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  t.end();\n});\n\ntape(\"test attach form preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var form = document.createElement(\"form\");\n\n  // This needs to be before the call to attachForm()\n  on(form, \"submit\", function(event) {\n    event.preventDefault();\n  });\n\n  attachForm.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  form.action = \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachForm\", function(t) {\n  var form = document.createElement(\"form\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachForm.call({ options: options, loadUrl: loadUrl }, form);\n\n  form.action =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test form elements parsed correctly\", function(t) {\n  t.plan(1);\n\n  var form = document.createElement(\"form\");\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var params = [\n    {\n      name: \"input\",\n      value: \"value\"\n    }\n  ];\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.same(\n        options.requestOptions.requestParams,\n        params,\n        \"form elements parsed correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape('test form.enctype=\"multipart/form-data\"', function(t) {\n  t.plan(4);\n\n  var form = document.createElement(\"form\");\n  form.enctype = \"multipart/form-data\";\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.equals(\n        options.requestOptions.requestParams,\n        undefined,\n        \"form elements not parsed manually\"\n      );\n      t.true(\n        options.requestOptions.formData instanceof FormData,\n        \"requestOptions.formData is a FormData\"\n      );\n      t.equals(\n        Array.from(options.requestOptions.formData.entries()).length,\n        1,\n        \"correct number of FormData elements\"\n      );\n      t.equals(\n        options.requestOptions.formData.get(\"input\"),\n        \"value\",\n        \"FormData element value set correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/proto/attach-form.js","raw":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachForm = require(\"../../../lib/proto/attach-form\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach form prototype method\", function(t) {\n  var form = document.createElement(\"form\");\n  var loadUrlCalled = false;\n\n  attachForm.call(\n    {\n      options: {\n        currentUrlFullReload: true\n      },\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  form.action = \"http://external.com/\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  form.action = internalUri + \"#anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  form.action = internalUri + \"#another-anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  form.action = internalUri + \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"anchor-empty\",\n    \"empty anchor stop behavior\"\n  );\n\n  form.action = window.location.href;\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"reload\",\n    \"submitting when currentUrlFullReload is true will submit normally, without XHR\"\n  );\n  t.equal(loadUrlCalled, false, \"loadUrl() not called\");\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"POST\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a POST request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  loadUrlCalled = false;\n  form.setAttribute(attr, \"\");\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a GET request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  t.end();\n});\n\ntape(\"test attach form preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var form = document.createElement(\"form\");\n\n  // This needs to be before the call to attachForm()\n  on(form, \"submit\", function(event) {\n    event.preventDefault();\n  });\n\n  attachForm.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  form.action = \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachForm\", function(t) {\n  var form = document.createElement(\"form\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachForm.call({ options: options, loadUrl: loadUrl }, form);\n\n  form.action =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test form elements parsed correctly\", function(t) {\n  t.plan(1);\n\n  var form = document.createElement(\"form\");\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var params = [\n    {\n      name: \"input\",\n      value: \"value\"\n    }\n  ];\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.same(\n        options.requestOptions.requestParams,\n        params,\n        \"form elements parsed correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape('test form.enctype=\"multipart/form-data\"', function(t) {\n  t.plan(4);\n\n  var form = document.createElement(\"form\");\n  form.enctype = \"multipart/form-data\";\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.equals(\n        options.requestOptions.requestParams,\n        undefined,\n        \"form elements not parsed manually\"\n      );\n      t.true(\n        options.requestOptions.formData instanceof FormData,\n        \"requestOptions.formData is a FormData\"\n      );\n      t.equals(\n        Array.from(options.requestOptions.formData.entries()).length,\n        1,\n        \"correct number of FormData elements\"\n      );\n      t.equals(\n        options.requestOptions.formData.get(\"input\"),\n        \"value\",\n        \"FormData element value set correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.696Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/proto/attach-form.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5a001cnwlwc0z889r9","content":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachForm = require(\"../../../lib/proto/attach-form\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach form prototype method\", function(t) {\n  var form = document.createElement(\"form\");\n  var loadUrlCalled = false;\n\n  attachForm.call(\n    {\n      options: {\n        currentUrlFullReload: true\n      },\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  form.action = \"http://external.com/\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  form.action = internalUri + \"#anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  form.action = internalUri + \"#another-anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  form.action = internalUri + \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"anchor-empty\",\n    \"empty anchor stop behavior\"\n  );\n\n  form.action = window.location.href;\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"reload\",\n    \"submitting when currentUrlFullReload is true will submit normally, without XHR\"\n  );\n  t.equal(loadUrlCalled, false, \"loadUrl() not called\");\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"POST\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a POST request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  loadUrlCalled = false;\n  form.setAttribute(attr, \"\");\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a GET request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  t.end();\n});\n\ntape(\"test attach form preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var form = document.createElement(\"form\");\n\n  // This needs to be before the call to attachForm()\n  on(form, \"submit\", function(event) {\n    event.preventDefault();\n  });\n\n  attachForm.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  form.action = \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachForm\", function(t) {\n  var form = document.createElement(\"form\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachForm.call({ options: options, loadUrl: loadUrl }, form);\n\n  form.action =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test form elements parsed correctly\", function(t) {\n  t.plan(1);\n\n  var form = document.createElement(\"form\");\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var params = [\n    {\n      name: \"input\",\n      value: \"value\"\n    }\n  ];\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.same(\n        options.requestOptions.requestParams,\n        params,\n        \"form elements parsed correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape('test form.enctype=\"multipart/form-data\"', function(t) {\n  t.plan(4);\n\n  var form = document.createElement(\"form\");\n  form.enctype = \"multipart/form-data\";\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.equals(\n        options.requestOptions.requestParams,\n        undefined,\n        \"form elements not parsed manually\"\n      );\n      t.true(\n        options.requestOptions.formData instanceof FormData,\n        \"requestOptions.formData is a FormData\"\n      );\n      t.equals(\n        Array.from(options.requestOptions.formData.entries()).length,\n        1,\n        \"correct number of FormData elements\"\n      );\n      t.equals(\n        options.requestOptions.formData.get(\"input\"),\n        \"value\",\n        \"FormData element value set correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachForm = require(\"../../../lib/proto/attach-form\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach form prototype method\", function(t) {\n  var form = document.createElement(\"form\");\n  var loadUrlCalled = false;\n\n  attachForm.call(\n    {\n      options: {\n        currentUrlFullReload: true\n      },\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  form.action = \"http://external.com/\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  form.action = internalUri + \"#anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  form.action = internalUri + \"#another-anchor\";\n  trigger(form, \"submit\");\n  t.equal(form.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  form.action = internalUri + \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"anchor-empty\",\n    \"empty anchor stop behavior\"\n  );\n\n  form.action = window.location.href;\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"reload\",\n    \"submitting when currentUrlFullReload is true will submit normally, without XHR\"\n  );\n  t.equal(loadUrlCalled, false, \"loadUrl() not called\");\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"POST\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a POST request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  loadUrlCalled = false;\n  form.setAttribute(attr, \"\");\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n  t.equal(\n    form.getAttribute(attr),\n    \"submit\",\n    \"triggering a GET request to the next page\"\n  );\n  t.equal(loadUrlCalled, true, \"loadUrl() called correctly\");\n\n  t.end();\n});\n\ntape(\"test attach form preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var form = document.createElement(\"form\");\n\n  // This needs to be before the call to attachForm()\n  on(form, \"submit\", function(event) {\n    event.preventDefault();\n  });\n\n  attachForm.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    form\n  );\n\n  form.action = \"#\";\n  trigger(form, \"submit\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachForm\", function(t) {\n  var form = document.createElement(\"form\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachForm.call({ options: options, loadUrl: loadUrl }, form);\n\n  form.action =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n  form.method = \"GET\";\n  trigger(form, \"submit\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test form elements parsed correctly\", function(t) {\n  t.plan(1);\n\n  var form = document.createElement(\"form\");\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var params = [\n    {\n      name: \"input\",\n      value: \"value\"\n    }\n  ];\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.same(\n        options.requestOptions.requestParams,\n        params,\n        \"form elements parsed correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape('test form.enctype=\"multipart/form-data\"', function(t) {\n  t.plan(4);\n\n  var form = document.createElement(\"form\");\n  form.enctype = \"multipart/form-data\";\n  var input = document.createElement(\"input\");\n  input.name = \"input\";\n  input.value = \"value\";\n  form.appendChild(input);\n\n  var pjax = {\n    options: {},\n    loadUrl: function(href, options) {\n      t.equals(\n        options.requestOptions.requestParams,\n        undefined,\n        \"form elements not parsed manually\"\n      );\n      t.true(\n        options.requestOptions.formData instanceof FormData,\n        \"requestOptions.formData is a FormData\"\n      );\n      t.equals(\n        Array.from(options.requestOptions.formData.entries()).length,\n        1,\n        \"correct number of FormData elements\"\n      );\n      t.equals(\n        options.requestOptions.formData.get(\"input\"),\n        \"value\",\n        \"FormData element value set correctly\"\n      );\n    }\n  };\n\n  attachForm.call(pjax, form);\n\n  form.action =\n    window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(form, \"submit\");\n  // see loadUrl defined above\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar handleResponse = require(\"../../../lib/proto/handle-response\");\nvar noop = require(\"../../../lib/util/noop\");\nvar loadContent = require(\"../../../index\").prototype.loadContent;\n\nvar href = \"https://example.org/\";\n\nvar storeEventHandler;\nvar pjaxErrorEventTriggerTest;\n\ntape(\"test events triggered when handleResponse(false) is called\", function(t) {\n  t.plan(3);\n\n  var pjax = {\n    options: {\n      test: 1\n    }\n  };\n\n  var events = [];\n\n  storeEventHandler = function(e) {\n    events.push(e.type);\n\n    t.equal(e.test, 1);\n  };\n\n  document.addEventListener(\"pjax:complete\", storeEventHandler);\n  document.addEventListener(\"pjax:error\", storeEventHandler);\n\n  handleResponse.bind(pjax)(false, null);\n\n  t.same(\n    events,\n    [\"pjax:complete\", \"pjax:error\"],\n    \"calling handleResponse(false) triggers 'pjax:complete' and 'pjax:error'\"\n  );\n\n  document.removeEventListener(\"pjax:complete\", storeEventHandler);\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n  t.end();\n});\n\ntape(\"test when handleResponse() is called normally\", function(t) {\n  var pjax = {\n    options: {\n      test: 1\n    },\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"href\");\n\n  delete window.history.state.uid;\n  t.same(\n    window.history.state,\n    {\n      url: href,\n      title: \"\",\n      scrollPos: [0, 0]\n    },\n    \"window.history.state is set correctly\"\n  );\n  t.equals(pjax.state.href, \"href\", \"this.state.href is set correctly\");\n  t.equals(\n    Object.keys(pjax.state.options).length,\n    2,\n    \"this.state.options is set correctly\"\n  );\n  t.same(\n    pjax.state.options.request,\n    request,\n    \"this.state.options is set correctly\"\n  );\n  t.equals(pjax.state.options.test, 1, \"this.state.options is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with request.responseURL\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      responseURL: href + \"1\",\n      getResponseHeader: noop\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(\n      pjax.state.href,\n      request.responseURL,\n      \"this.state.href is set correctly\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with X-PJAX-URL\", function(\n  t\n) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: function(header) {\n      if (header === \"X-PJAX-URL\") {\n        return href + \"2\";\n      }\n    }\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"\");\n\n  t.equals(pjax.state.href, href + \"2\", \"this.state.href is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with X-XHR-Redirected-To\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      getResponseHeader: function(header) {\n        if (header === \"X-XHR-Redirected-To\") {\n          return href + \"3\";\n        }\n      }\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(pjax.state.href, href + \"3\", \"this.state.href is set correctly\");\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with a hash\", function(t) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    responseURL: href + \"2\",\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, href + \"1#test\");\n\n  t.equals(\n    pjax.state.href,\n    href + \"2#test\",\n    \"this.state.href is set correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent() when options.debug is true\", function(\n  t\n) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.options.debug = true;\n\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n  pjaxErrorEventTriggerTest = function() {\n    t.pass(\"pjax:error event triggered\");\n  };\n  document.addEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.throws(\n    function() {\n      handleResponse.bind(pjax)(\"\", request, \"\");\n    },\n    Error,\n    \"error is rethrown\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent()\", function(t) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.latestChance = function() {\n    return true;\n  };\n  pjax.options.debug = false;\n\n  document.removeEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.doesNotThrow(\n    function() {\n      t.equals(\n        handleResponse.bind(pjax)(\"\", request, \"\"),\n        true,\n        \"this.latestChance() is called\"\n      );\n    },\n    Error,\n    \"error is not thrown\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events triggered when loadContent() is called with a non-string html argument\",\n  function(t) {\n    t.plan(3);\n\n    var options = {\n      test: 1\n    };\n\n    var events = [];\n\n    storeEventHandler = function(e) {\n      events.push(e.type);\n\n      t.equal(e.test, 1);\n    };\n\n    document.addEventListener(\"pjax:complete\", storeEventHandler);\n    document.addEventListener(\"pjax:error\", storeEventHandler);\n\n    loadContent(null, options);\n\n    t.same(\n      events,\n      [\"pjax:complete\", \"pjax:error\"],\n      \"calling loadContent() with a non-string html argument triggers 'pjax:complete' and 'pjax:error'\"\n    );\n\n    document.removeEventListener(\"pjax:complete\", storeEventHandler);\n    document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n    t.end();\n  }\n);\n","source":"lib/pjax/tests/lib/proto/handle-response.js","raw":"var tape = require(\"tape\");\n\nvar handleResponse = require(\"../../../lib/proto/handle-response\");\nvar noop = require(\"../../../lib/util/noop\");\nvar loadContent = require(\"../../../index\").prototype.loadContent;\n\nvar href = \"https://example.org/\";\n\nvar storeEventHandler;\nvar pjaxErrorEventTriggerTest;\n\ntape(\"test events triggered when handleResponse(false) is called\", function(t) {\n  t.plan(3);\n\n  var pjax = {\n    options: {\n      test: 1\n    }\n  };\n\n  var events = [];\n\n  storeEventHandler = function(e) {\n    events.push(e.type);\n\n    t.equal(e.test, 1);\n  };\n\n  document.addEventListener(\"pjax:complete\", storeEventHandler);\n  document.addEventListener(\"pjax:error\", storeEventHandler);\n\n  handleResponse.bind(pjax)(false, null);\n\n  t.same(\n    events,\n    [\"pjax:complete\", \"pjax:error\"],\n    \"calling handleResponse(false) triggers 'pjax:complete' and 'pjax:error'\"\n  );\n\n  document.removeEventListener(\"pjax:complete\", storeEventHandler);\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n  t.end();\n});\n\ntape(\"test when handleResponse() is called normally\", function(t) {\n  var pjax = {\n    options: {\n      test: 1\n    },\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"href\");\n\n  delete window.history.state.uid;\n  t.same(\n    window.history.state,\n    {\n      url: href,\n      title: \"\",\n      scrollPos: [0, 0]\n    },\n    \"window.history.state is set correctly\"\n  );\n  t.equals(pjax.state.href, \"href\", \"this.state.href is set correctly\");\n  t.equals(\n    Object.keys(pjax.state.options).length,\n    2,\n    \"this.state.options is set correctly\"\n  );\n  t.same(\n    pjax.state.options.request,\n    request,\n    \"this.state.options is set correctly\"\n  );\n  t.equals(pjax.state.options.test, 1, \"this.state.options is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with request.responseURL\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      responseURL: href + \"1\",\n      getResponseHeader: noop\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(\n      pjax.state.href,\n      request.responseURL,\n      \"this.state.href is set correctly\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with X-PJAX-URL\", function(\n  t\n) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: function(header) {\n      if (header === \"X-PJAX-URL\") {\n        return href + \"2\";\n      }\n    }\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"\");\n\n  t.equals(pjax.state.href, href + \"2\", \"this.state.href is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with X-XHR-Redirected-To\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      getResponseHeader: function(header) {\n        if (header === \"X-XHR-Redirected-To\") {\n          return href + \"3\";\n        }\n      }\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(pjax.state.href, href + \"3\", \"this.state.href is set correctly\");\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with a hash\", function(t) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    responseURL: href + \"2\",\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, href + \"1#test\");\n\n  t.equals(\n    pjax.state.href,\n    href + \"2#test\",\n    \"this.state.href is set correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent() when options.debug is true\", function(\n  t\n) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.options.debug = true;\n\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n  pjaxErrorEventTriggerTest = function() {\n    t.pass(\"pjax:error event triggered\");\n  };\n  document.addEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.throws(\n    function() {\n      handleResponse.bind(pjax)(\"\", request, \"\");\n    },\n    Error,\n    \"error is rethrown\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent()\", function(t) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.latestChance = function() {\n    return true;\n  };\n  pjax.options.debug = false;\n\n  document.removeEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.doesNotThrow(\n    function() {\n      t.equals(\n        handleResponse.bind(pjax)(\"\", request, \"\"),\n        true,\n        \"this.latestChance() is called\"\n      );\n    },\n    Error,\n    \"error is not thrown\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events triggered when loadContent() is called with a non-string html argument\",\n  function(t) {\n    t.plan(3);\n\n    var options = {\n      test: 1\n    };\n\n    var events = [];\n\n    storeEventHandler = function(e) {\n      events.push(e.type);\n\n      t.equal(e.test, 1);\n    };\n\n    document.addEventListener(\"pjax:complete\", storeEventHandler);\n    document.addEventListener(\"pjax:error\", storeEventHandler);\n\n    loadContent(null, options);\n\n    t.same(\n      events,\n      [\"pjax:complete\", \"pjax:error\"],\n      \"calling loadContent() with a non-string html argument triggers 'pjax:complete' and 'pjax:error'\"\n    );\n\n    document.removeEventListener(\"pjax:complete\", storeEventHandler);\n    document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n    t.end();\n  }\n);\n","date":"2021-10-30T06:38:12.698Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/proto/handle-response.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5a001dnwlwaw2s4vc8","content":"var tape = require(\"tape\");\n\nvar handleResponse = require(\"../../../lib/proto/handle-response\");\nvar noop = require(\"../../../lib/util/noop\");\nvar loadContent = require(\"../../../index\").prototype.loadContent;\n\nvar href = \"https://example.org/\";\n\nvar storeEventHandler;\nvar pjaxErrorEventTriggerTest;\n\ntape(\"test events triggered when handleResponse(false) is called\", function(t) {\n  t.plan(3);\n\n  var pjax = {\n    options: {\n      test: 1\n    }\n  };\n\n  var events = [];\n\n  storeEventHandler = function(e) {\n    events.push(e.type);\n\n    t.equal(e.test, 1);\n  };\n\n  document.addEventListener(\"pjax:complete\", storeEventHandler);\n  document.addEventListener(\"pjax:error\", storeEventHandler);\n\n  handleResponse.bind(pjax)(false, null);\n\n  t.same(\n    events,\n    [\"pjax:complete\", \"pjax:error\"],\n    \"calling handleResponse(false) triggers 'pjax:complete' and 'pjax:error'\"\n  );\n\n  document.removeEventListener(\"pjax:complete\", storeEventHandler);\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n  t.end();\n});\n\ntape(\"test when handleResponse() is called normally\", function(t) {\n  var pjax = {\n    options: {\n      test: 1\n    },\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"href\");\n\n  delete window.history.state.uid;\n  t.same(\n    window.history.state,\n    {\n      url: href,\n      title: \"\",\n      scrollPos: [0, 0]\n    },\n    \"window.history.state is set correctly\"\n  );\n  t.equals(pjax.state.href, \"href\", \"this.state.href is set correctly\");\n  t.equals(\n    Object.keys(pjax.state.options).length,\n    2,\n    \"this.state.options is set correctly\"\n  );\n  t.same(\n    pjax.state.options.request,\n    request,\n    \"this.state.options is set correctly\"\n  );\n  t.equals(pjax.state.options.test, 1, \"this.state.options is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with request.responseURL\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      responseURL: href + \"1\",\n      getResponseHeader: noop\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(\n      pjax.state.href,\n      request.responseURL,\n      \"this.state.href is set correctly\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with X-PJAX-URL\", function(\n  t\n) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: function(header) {\n      if (header === \"X-PJAX-URL\") {\n        return href + \"2\";\n      }\n    }\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"\");\n\n  t.equals(pjax.state.href, href + \"2\", \"this.state.href is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with X-XHR-Redirected-To\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      getResponseHeader: function(header) {\n        if (header === \"X-XHR-Redirected-To\") {\n          return href + \"3\";\n        }\n      }\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(pjax.state.href, href + \"3\", \"this.state.href is set correctly\");\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with a hash\", function(t) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    responseURL: href + \"2\",\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, href + \"1#test\");\n\n  t.equals(\n    pjax.state.href,\n    href + \"2#test\",\n    \"this.state.href is set correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent() when options.debug is true\", function(\n  t\n) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.options.debug = true;\n\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n  pjaxErrorEventTriggerTest = function() {\n    t.pass(\"pjax:error event triggered\");\n  };\n  document.addEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.throws(\n    function() {\n      handleResponse.bind(pjax)(\"\", request, \"\");\n    },\n    Error,\n    \"error is rethrown\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent()\", function(t) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.latestChance = function() {\n    return true;\n  };\n  pjax.options.debug = false;\n\n  document.removeEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.doesNotThrow(\n    function() {\n      t.equals(\n        handleResponse.bind(pjax)(\"\", request, \"\"),\n        true,\n        \"this.latestChance() is called\"\n      );\n    },\n    Error,\n    \"error is not thrown\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events triggered when loadContent() is called with a non-string html argument\",\n  function(t) {\n    t.plan(3);\n\n    var options = {\n      test: 1\n    };\n\n    var events = [];\n\n    storeEventHandler = function(e) {\n      events.push(e.type);\n\n      t.equal(e.test, 1);\n    };\n\n    document.addEventListener(\"pjax:complete\", storeEventHandler);\n    document.addEventListener(\"pjax:error\", storeEventHandler);\n\n    loadContent(null, options);\n\n    t.same(\n      events,\n      [\"pjax:complete\", \"pjax:error\"],\n      \"calling loadContent() with a non-string html argument triggers 'pjax:complete' and 'pjax:error'\"\n    );\n\n    document.removeEventListener(\"pjax:complete\", storeEventHandler);\n    document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n    t.end();\n  }\n);\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar handleResponse = require(\"../../../lib/proto/handle-response\");\nvar noop = require(\"../../../lib/util/noop\");\nvar loadContent = require(\"../../../index\").prototype.loadContent;\n\nvar href = \"https://example.org/\";\n\nvar storeEventHandler;\nvar pjaxErrorEventTriggerTest;\n\ntape(\"test events triggered when handleResponse(false) is called\", function(t) {\n  t.plan(3);\n\n  var pjax = {\n    options: {\n      test: 1\n    }\n  };\n\n  var events = [];\n\n  storeEventHandler = function(e) {\n    events.push(e.type);\n\n    t.equal(e.test, 1);\n  };\n\n  document.addEventListener(\"pjax:complete\", storeEventHandler);\n  document.addEventListener(\"pjax:error\", storeEventHandler);\n\n  handleResponse.bind(pjax)(false, null);\n\n  t.same(\n    events,\n    [\"pjax:complete\", \"pjax:error\"],\n    \"calling handleResponse(false) triggers 'pjax:complete' and 'pjax:error'\"\n  );\n\n  document.removeEventListener(\"pjax:complete\", storeEventHandler);\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n  t.end();\n});\n\ntape(\"test when handleResponse() is called normally\", function(t) {\n  var pjax = {\n    options: {\n      test: 1\n    },\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"href\");\n\n  delete window.history.state.uid;\n  t.same(\n    window.history.state,\n    {\n      url: href,\n      title: \"\",\n      scrollPos: [0, 0]\n    },\n    \"window.history.state is set correctly\"\n  );\n  t.equals(pjax.state.href, \"href\", \"this.state.href is set correctly\");\n  t.equals(\n    Object.keys(pjax.state.options).length,\n    2,\n    \"this.state.options is set correctly\"\n  );\n  t.same(\n    pjax.state.options.request,\n    request,\n    \"this.state.options is set correctly\"\n  );\n  t.equals(pjax.state.options.test, 1, \"this.state.options is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with request.responseURL\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      responseURL: href + \"1\",\n      getResponseHeader: noop\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(\n      pjax.state.href,\n      request.responseURL,\n      \"this.state.href is set correctly\"\n    );\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with X-PJAX-URL\", function(\n  t\n) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: function(header) {\n      if (header === \"X-PJAX-URL\") {\n        return href + \"2\";\n      }\n    }\n  };\n\n  handleResponse.bind(pjax)(\"\", request, \"\");\n\n  t.equals(pjax.state.href, href + \"2\", \"this.state.href is set correctly\");\n\n  t.end();\n});\n\ntape(\n  \"test when handleResponse() is called normally with X-XHR-Redirected-To\",\n  function(t) {\n    var pjax = {\n      options: {},\n      loadContent: noop,\n      state: {}\n    };\n\n    var request = {\n      getResponseHeader: function(header) {\n        if (header === \"X-XHR-Redirected-To\") {\n          return href + \"3\";\n        }\n      }\n    };\n\n    handleResponse.bind(pjax)(\"\", request, \"\");\n\n    t.equals(pjax.state.href, href + \"3\", \"this.state.href is set correctly\");\n\n    t.end();\n  }\n);\n\ntape(\"test when handleResponse() is called normally with a hash\", function(t) {\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    responseURL: href + \"2\",\n    getResponseHeader: noop\n  };\n\n  handleResponse.bind(pjax)(\"\", request, href + \"1#test\");\n\n  t.equals(\n    pjax.state.href,\n    href + \"2#test\",\n    \"this.state.href is set correctly\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent() when options.debug is true\", function(\n  t\n) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.options.debug = true;\n\n  document.removeEventListener(\"pjax:error\", storeEventHandler);\n  pjaxErrorEventTriggerTest = function() {\n    t.pass(\"pjax:error event triggered\");\n  };\n  document.addEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.throws(\n    function() {\n      handleResponse.bind(pjax)(\"\", request, \"\");\n    },\n    Error,\n    \"error is rethrown\"\n  );\n\n  t.end();\n});\n\ntape(\"test try...catch for loadContent()\", function(t) {\n  t.plan(2);\n\n  var pjax = {\n    options: {},\n    loadContent: noop,\n    state: {}\n  };\n\n  var request = {\n    getResponseHeader: noop\n  };\n\n  pjax.loadContent = function() {\n    throw new Error();\n  };\n  pjax.latestChance = function() {\n    return true;\n  };\n  pjax.options.debug = false;\n\n  document.removeEventListener(\"pjax:error\", pjaxErrorEventTriggerTest);\n\n  t.doesNotThrow(\n    function() {\n      t.equals(\n        handleResponse.bind(pjax)(\"\", request, \"\"),\n        true,\n        \"this.latestChance() is called\"\n      );\n    },\n    Error,\n    \"error is not thrown\"\n  );\n\n  t.end();\n});\n\ntape(\n  \"test events triggered when loadContent() is called with a non-string html argument\",\n  function(t) {\n    t.plan(3);\n\n    var options = {\n      test: 1\n    };\n\n    var events = [];\n\n    storeEventHandler = function(e) {\n      events.push(e.type);\n\n      t.equal(e.test, 1);\n    };\n\n    document.addEventListener(\"pjax:complete\", storeEventHandler);\n    document.addEventListener(\"pjax:error\", storeEventHandler);\n\n    loadContent(null, options);\n\n    t.same(\n      events,\n      [\"pjax:complete\", \"pjax:error\"],\n      \"calling loadContent() with a non-string html argument triggers 'pjax:complete' and 'pjax:error'\"\n    );\n\n    document.removeEventListener(\"pjax:complete\", storeEventHandler);\n    document.removeEventListener(\"pjax:error\", storeEventHandler);\n\n    t.end();\n  }\n);\n"},{"_content":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachLink = require(\"../../../lib/proto/attach-link\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach link prototype method\", function(t) {\n  var a = document.createElement(\"a\");\n  var loadUrlCalled = false;\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  a.href = internalUri;\n  trigger(a, \"click\", { metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  a.href = \"http://external.com/\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  a.href = internalUri + \"#anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  a.href = internalUri + \"#another-anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  a.href = internalUri + \"#\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor-empty\", \"empty anchor stop behavior\");\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  trigger(a, \"click\");\n  t.equals(\n    a.getAttribute(attr),\n    \"load\",\n    \"triggering an internal link sets the state attribute to 'load'\"\n  );\n  t.equals(\n    loadUrlCalled,\n    true,\n    \"triggering an internal link actually loads the page\"\n  );\n\n  t.end();\n});\n\ntape(\"test attach link preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var a = document.createElement(\"a\");\n\n  // This needs to be before the call to attachLink()\n  on(a, \"click\", function(event) {\n    event.preventDefault();\n  });\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  a.href = \"#\";\n  trigger(a, \"click\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachLink\", function(t) {\n  var a = document.createElement(\"a\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachLink.call({ options: options, loadUrl: loadUrl }, a);\n\n  a.href =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  trigger(a, \"click\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test link triggered by keyboard\", function(t) {\n  var a = document.createElement(\"a\");\n  var pjax = {\n    options: {},\n    loadUrl: function() {\n      t.equal(\n        a.getAttribute(attr),\n        \"load\",\n        \"triggering a internal link actually loads the page\"\n      );\n    }\n  };\n\n  t.plan(3);\n\n  attachLink.call(pjax, a);\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(a, \"keyup\", { keyCode: 14 });\n  t.equal(\n    a.getAttribute(attr),\n    \"\",\n    \"keycode other than 13 doesn't trigger anything\"\n  );\n\n  trigger(a, \"keyup\", { keyCode: 13, metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  trigger(a, \"keyup\", { keyCode: 13 });\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape(\n  \"test link with the same URL as the current one, when currentUrlFullReload set to true\",\n  function(t) {\n    var a = document.createElement(\"a\");\n    var pjax = {\n      options: {\n        currentUrlFullReload: true\n      },\n      reload: function() {\n        t.pass(\"this.reload() was called correctly\");\n      },\n      loadUrl: function() {\n        t.fail(\"loadUrl() was called wrongly\");\n      }\n    };\n\n    t.plan(2);\n\n    attachLink.call(pjax, a);\n\n    a.href = window.location.href;\n\n    trigger(a, \"click\");\n    t.equal(a.getAttribute(attr), \"reload\", \"reload stop behavior\");\n\n    t.end();\n  }\n);\n","source":"lib/pjax/tests/lib/proto/attach-link.js","raw":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachLink = require(\"../../../lib/proto/attach-link\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach link prototype method\", function(t) {\n  var a = document.createElement(\"a\");\n  var loadUrlCalled = false;\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  a.href = internalUri;\n  trigger(a, \"click\", { metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  a.href = \"http://external.com/\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  a.href = internalUri + \"#anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  a.href = internalUri + \"#another-anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  a.href = internalUri + \"#\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor-empty\", \"empty anchor stop behavior\");\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  trigger(a, \"click\");\n  t.equals(\n    a.getAttribute(attr),\n    \"load\",\n    \"triggering an internal link sets the state attribute to 'load'\"\n  );\n  t.equals(\n    loadUrlCalled,\n    true,\n    \"triggering an internal link actually loads the page\"\n  );\n\n  t.end();\n});\n\ntape(\"test attach link preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var a = document.createElement(\"a\");\n\n  // This needs to be before the call to attachLink()\n  on(a, \"click\", function(event) {\n    event.preventDefault();\n  });\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  a.href = \"#\";\n  trigger(a, \"click\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachLink\", function(t) {\n  var a = document.createElement(\"a\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachLink.call({ options: options, loadUrl: loadUrl }, a);\n\n  a.href =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  trigger(a, \"click\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test link triggered by keyboard\", function(t) {\n  var a = document.createElement(\"a\");\n  var pjax = {\n    options: {},\n    loadUrl: function() {\n      t.equal(\n        a.getAttribute(attr),\n        \"load\",\n        \"triggering a internal link actually loads the page\"\n      );\n    }\n  };\n\n  t.plan(3);\n\n  attachLink.call(pjax, a);\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(a, \"keyup\", { keyCode: 14 });\n  t.equal(\n    a.getAttribute(attr),\n    \"\",\n    \"keycode other than 13 doesn't trigger anything\"\n  );\n\n  trigger(a, \"keyup\", { keyCode: 13, metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  trigger(a, \"keyup\", { keyCode: 13 });\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape(\n  \"test link with the same URL as the current one, when currentUrlFullReload set to true\",\n  function(t) {\n    var a = document.createElement(\"a\");\n    var pjax = {\n      options: {\n        currentUrlFullReload: true\n      },\n      reload: function() {\n        t.pass(\"this.reload() was called correctly\");\n      },\n      loadUrl: function() {\n        t.fail(\"loadUrl() was called wrongly\");\n      }\n    };\n\n    t.plan(2);\n\n    attachLink.call(pjax, a);\n\n    a.href = window.location.href;\n\n    trigger(a, \"click\");\n    t.equal(a.getAttribute(attr), \"reload\", \"reload stop behavior\");\n\n    t.end();\n  }\n);\n","date":"2021-10-30T06:38:12.697Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/proto/attach-link.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5b001enwlw55wz2g9n","content":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachLink = require(\"../../../lib/proto/attach-link\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach link prototype method\", function(t) {\n  var a = document.createElement(\"a\");\n  var loadUrlCalled = false;\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  a.href = internalUri;\n  trigger(a, \"click\", { metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  a.href = \"http://external.com/\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  a.href = internalUri + \"#anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  a.href = internalUri + \"#another-anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  a.href = internalUri + \"#\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor-empty\", \"empty anchor stop behavior\");\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  trigger(a, \"click\");\n  t.equals(\n    a.getAttribute(attr),\n    \"load\",\n    \"triggering an internal link sets the state attribute to 'load'\"\n  );\n  t.equals(\n    loadUrlCalled,\n    true,\n    \"triggering an internal link actually loads the page\"\n  );\n\n  t.end();\n});\n\ntape(\"test attach link preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var a = document.createElement(\"a\");\n\n  // This needs to be before the call to attachLink()\n  on(a, \"click\", function(event) {\n    event.preventDefault();\n  });\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  a.href = \"#\";\n  trigger(a, \"click\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachLink\", function(t) {\n  var a = document.createElement(\"a\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachLink.call({ options: options, loadUrl: loadUrl }, a);\n\n  a.href =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  trigger(a, \"click\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test link triggered by keyboard\", function(t) {\n  var a = document.createElement(\"a\");\n  var pjax = {\n    options: {},\n    loadUrl: function() {\n      t.equal(\n        a.getAttribute(attr),\n        \"load\",\n        \"triggering a internal link actually loads the page\"\n      );\n    }\n  };\n\n  t.plan(3);\n\n  attachLink.call(pjax, a);\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(a, \"keyup\", { keyCode: 14 });\n  t.equal(\n    a.getAttribute(attr),\n    \"\",\n    \"keycode other than 13 doesn't trigger anything\"\n  );\n\n  trigger(a, \"keyup\", { keyCode: 13, metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  trigger(a, \"keyup\", { keyCode: 13 });\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape(\n  \"test link with the same URL as the current one, when currentUrlFullReload set to true\",\n  function(t) {\n    var a = document.createElement(\"a\");\n    var pjax = {\n      options: {\n        currentUrlFullReload: true\n      },\n      reload: function() {\n        t.pass(\"this.reload() was called correctly\");\n      },\n      loadUrl: function() {\n        t.fail(\"loadUrl() was called wrongly\");\n      }\n    };\n\n    t.plan(2);\n\n    attachLink.call(pjax, a);\n\n    a.href = window.location.href;\n\n    trigger(a, \"click\");\n    t.equal(a.getAttribute(attr), \"reload\", \"reload stop behavior\");\n\n    t.end();\n  }\n);\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar on = require(\"../../../lib/events/on\");\nvar trigger = require(\"../../../lib/events/trigger\");\nvar attachLink = require(\"../../../lib/proto/attach-link\");\n\nvar attr = \"data-pjax-state\";\n\ntape(\"test attach link prototype method\", function(t) {\n  var a = document.createElement(\"a\");\n  var loadUrlCalled = false;\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  var internalUri =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  a.href = internalUri;\n  trigger(a, \"click\", { metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  a.href = \"http://external.com/\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"external\", \"external url stop behavior\");\n\n  window.location.hash = \"#anchor\";\n  a.href = internalUri + \"#anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"internal anchor stop behavior\");\n\n  a.href = internalUri + \"#another-anchor\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor\", \"different anchors stop behavior\");\n  window.location.hash = \"\";\n\n  a.href = internalUri + \"#\";\n  trigger(a, \"click\");\n  t.equal(a.getAttribute(attr), \"anchor-empty\", \"empty anchor stop behavior\");\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n  trigger(a, \"click\");\n  t.equals(\n    a.getAttribute(attr),\n    \"load\",\n    \"triggering an internal link sets the state attribute to 'load'\"\n  );\n  t.equals(\n    loadUrlCalled,\n    true,\n    \"triggering an internal link actually loads the page\"\n  );\n\n  t.end();\n});\n\ntape(\"test attach link preventDefaulted events\", function(t) {\n  var loadUrlCalled = false;\n  var a = document.createElement(\"a\");\n\n  // This needs to be before the call to attachLink()\n  on(a, \"click\", function(event) {\n    event.preventDefault();\n  });\n\n  attachLink.call(\n    {\n      options: {},\n      loadUrl: function() {\n        loadUrlCalled = true;\n      }\n    },\n    a\n  );\n\n  a.href = \"#\";\n  trigger(a, \"click\");\n  t.equal(\n    loadUrlCalled,\n    false,\n    \"events that are preventDefaulted should not fire callback\"\n  );\n\n  t.end();\n});\n\ntape(\"test options are not modified by attachLink\", function(t) {\n  var a = document.createElement(\"a\");\n  var options = { foo: \"bar\" };\n  var loadUrl = function() {};\n\n  attachLink.call({ options: options, loadUrl: loadUrl }, a);\n\n  a.href =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    window.location.search;\n\n  trigger(a, \"click\");\n\n  t.equal(\n    1,\n    Object.keys(options).length,\n    \"options object that is passed in should not be modified\"\n  );\n  t.equal(\n    \"bar\",\n    options.foo,\n    \"options object that is passed in should not be modified\"\n  );\n\n  t.end();\n});\n\ntape(\"test link triggered by keyboard\", function(t) {\n  var a = document.createElement(\"a\");\n  var pjax = {\n    options: {},\n    loadUrl: function() {\n      t.equal(\n        a.getAttribute(attr),\n        \"load\",\n        \"triggering a internal link actually loads the page\"\n      );\n    }\n  };\n\n  t.plan(3);\n\n  attachLink.call(pjax, a);\n\n  a.href = window.location.protocol + \"//\" + window.location.host + \"/internal\";\n\n  trigger(a, \"keyup\", { keyCode: 14 });\n  t.equal(\n    a.getAttribute(attr),\n    \"\",\n    \"keycode other than 13 doesn't trigger anything\"\n  );\n\n  trigger(a, \"keyup\", { keyCode: 13, metaKey: true });\n  t.equal(a.getAttribute(attr), \"modifier\", \"event key modifier stop behavior\");\n\n  trigger(a, \"keyup\", { keyCode: 13 });\n  // see loadUrl defined above\n\n  t.end();\n});\n\ntape(\n  \"test link with the same URL as the current one, when currentUrlFullReload set to true\",\n  function(t) {\n    var a = document.createElement(\"a\");\n    var pjax = {\n      options: {\n        currentUrlFullReload: true\n      },\n      reload: function() {\n        t.pass(\"this.reload() was called correctly\");\n      },\n      loadUrl: function() {\n        t.fail(\"loadUrl() was called wrongly\");\n      }\n    };\n\n    t.plan(2);\n\n    attachLink.call(pjax, a);\n\n    a.href = window.location.href;\n\n    trigger(a, \"click\");\n    t.equal(a.getAttribute(attr), \"reload\", \"reload stop behavior\");\n\n    t.end();\n  }\n);\n"},{"_content":"var tape = require(\"tape\");\n\nvar parseElement = require(\"../../../lib/proto/parse-element\");\n\nvar pjax = {\n  attachLink: function() {\n    return true;\n  },\n  attachForm: function() {\n    return true;\n  }\n};\n\ntape(\"test parse element prototype method\", function(t) {\n  t.doesNotThrow(function() {\n    var a = document.createElement(\"a\");\n    parseElement.call(pjax, a);\n  }, \"<a> element can be parsed\");\n\n  t.doesNotThrow(function() {\n    var form = document.createElement(\"form\");\n    parseElement.call(pjax, form);\n  }, \"<form> element can be parsed\");\n\n  t.throws(function() {\n    var el = document.createElement(\"div\");\n    parseElement.call(pjax, el);\n  }, \"<div> element cannot be parsed\");\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/proto/parse-element.js","raw":"var tape = require(\"tape\");\n\nvar parseElement = require(\"../../../lib/proto/parse-element\");\n\nvar pjax = {\n  attachLink: function() {\n    return true;\n  },\n  attachForm: function() {\n    return true;\n  }\n};\n\ntape(\"test parse element prototype method\", function(t) {\n  t.doesNotThrow(function() {\n    var a = document.createElement(\"a\");\n    parseElement.call(pjax, a);\n  }, \"<a> element can be parsed\");\n\n  t.doesNotThrow(function() {\n    var form = document.createElement(\"form\");\n    parseElement.call(pjax, form);\n  }, \"<form> element can be parsed\");\n\n  t.throws(function() {\n    var el = document.createElement(\"div\");\n    parseElement.call(pjax, el);\n  }, \"<div> element cannot be parsed\");\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.700Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/proto/parse-element.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5b001fnwlw3gt9asd8","content":"var tape = require(\"tape\");\n\nvar parseElement = require(\"../../../lib/proto/parse-element\");\n\nvar pjax = {\n  attachLink: function() {\n    return true;\n  },\n  attachForm: function() {\n    return true;\n  }\n};\n\ntape(\"test parse element prototype method\", function(t) {\n  t.doesNotThrow(function() {\n    var a = document.createElement(\"a\");\n    parseElement.call(pjax, a);\n  }, \"<a> element can be parsed\");\n\n  t.doesNotThrow(function() {\n    var form = document.createElement(\"form\");\n    parseElement.call(pjax, form);\n  }, \"<form> element can be parsed\");\n\n  t.throws(function() {\n    var el = document.createElement(\"div\");\n    parseElement.call(pjax, el);\n  }, \"<div> element cannot be parsed\");\n\n  t.end();\n});\n</div></form></a>","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar parseElement = require(\"../../../lib/proto/parse-element\");\n\nvar pjax = {\n  attachLink: function() {\n    return true;\n  },\n  attachForm: function() {\n    return true;\n  }\n};\n\ntape(\"test parse element prototype method\", function(t) {\n  t.doesNotThrow(function() {\n    var a = document.createElement(\"a\");\n    parseElement.call(pjax, a);\n  }, \"<a> element can be parsed\");\n\n  t.doesNotThrow(function() {\n    var form = document.createElement(\"form\");\n    parseElement.call(pjax, form);\n  }, \"<form> element can be parsed\");\n\n  t.throws(function() {\n    var el = document.createElement(\"div\");\n    parseElement.call(pjax, el);\n  }, \"<div> element cannot be parsed\");\n\n  t.end();\n});\n</div></form></a>"},{"_content":"var tape = require(\"tape\");\n\nvar clone = require(\"../../../lib/util/clone\");\n\ntape(\"test clone method\", function(t) {\n  var obj = { one: 1, two: 2 };\n  var cloned = clone(obj);\n\n  t.notEqual(obj, cloned, \"cloned object isn't the original object\");\n\n  t.same(obj, cloned, \"cloned object has the same values as original object\");\n\n  cloned.three = 3;\n  t.notSame(\n    obj,\n    cloned,\n    \"modified cloned object doesn't have the same values as original object\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/util/clone.js","raw":"var tape = require(\"tape\");\n\nvar clone = require(\"../../../lib/util/clone\");\n\ntape(\"test clone method\", function(t) {\n  var obj = { one: 1, two: 2 };\n  var cloned = clone(obj);\n\n  t.notEqual(obj, cloned, \"cloned object isn't the original object\");\n\n  t.same(obj, cloned, \"cloned object has the same values as original object\");\n\n  cloned.three = 3;\n  t.notSame(\n    obj,\n    cloned,\n    \"modified cloned object doesn't have the same values as original object\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.803Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/util/clone.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5b001gnwlw305c2g4h","content":"var tape = require(\"tape\");\n\nvar clone = require(\"../../../lib/util/clone\");\n\ntape(\"test clone method\", function(t) {\n  var obj = { one: 1, two: 2 };\n  var cloned = clone(obj);\n\n  t.notEqual(obj, cloned, \"cloned object isn't the original object\");\n\n  t.same(obj, cloned, \"cloned object has the same values as original object\");\n\n  cloned.three = 3;\n  t.notSame(\n    obj,\n    cloned,\n    \"modified cloned object doesn't have the same values as original object\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar clone = require(\"../../../lib/util/clone\");\n\ntape(\"test clone method\", function(t) {\n  var obj = { one: 1, two: 2 };\n  var cloned = clone(obj);\n\n  t.notEqual(obj, cloned, \"cloned object isn't the original object\");\n\n  t.same(obj, cloned, \"cloned object has the same values as original object\");\n\n  cloned.three = 3;\n  t.notSame(\n    obj,\n    cloned,\n    \"modified cloned object doesn't have the same values as original object\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar contains = require(\"../../../lib/util/contains.js\");\n\ntape(\"test contains function\", function(t) {\n  var tempDoc = document.implementation.createHTMLDocument();\n  tempDoc.body.innerHTML =\n    \"<div><p id='el' class='js-Pjax'></p></div><span></span>\";\n  var selectors = [\"div\"];\n  var el = tempDoc.body.querySelector(\"#el\");\n  t.equal(\n    contains(tempDoc, selectors, el),\n    true,\n    \"contains() returns true when a selector contains the element\"\n  );\n\n  selectors = [\"span\"];\n  t.equal(\n    contains(tempDoc, selectors, el),\n    false,\n    \"contains() returns false when the selectors do not contain the element\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/util/contains.js","raw":"var tape = require(\"tape\");\n\nvar contains = require(\"../../../lib/util/contains.js\");\n\ntape(\"test contains function\", function(t) {\n  var tempDoc = document.implementation.createHTMLDocument();\n  tempDoc.body.innerHTML =\n    \"<div><p id='el' class='js-Pjax'></p></div><span></span>\";\n  var selectors = [\"div\"];\n  var el = tempDoc.body.querySelector(\"#el\");\n  t.equal(\n    contains(tempDoc, selectors, el),\n    true,\n    \"contains() returns true when a selector contains the element\"\n  );\n\n  selectors = [\"span\"];\n  t.equal(\n    contains(tempDoc, selectors, el),\n    false,\n    \"contains() returns false when the selectors do not contain the element\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.805Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/util/contains.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5c001hnwlwcrax66lo","content":"var tape = require(\"tape\");\n\nvar contains = require(\"../../../lib/util/contains.js\");\n\ntape(\"test contains function\", function(t) {\n  var tempDoc = document.implementation.createHTMLDocument();\n  tempDoc.body.innerHTML =\n    \"<div><p id=\"el\" class=\"js-Pjax\"></p></div><span></span>\";\n  var selectors = [\"div\"];\n  var el = tempDoc.body.querySelector(\"#el\");\n  t.equal(\n    contains(tempDoc, selectors, el),\n    true,\n    \"contains() returns true when a selector contains the element\"\n  );\n\n  selectors = [\"span\"];\n  t.equal(\n    contains(tempDoc, selectors, el),\n    false,\n    \"contains() returns false when the selectors do not contain the element\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar contains = require(\"../../../lib/util/contains.js\");\n\ntape(\"test contains function\", function(t) {\n  var tempDoc = document.implementation.createHTMLDocument();\n  tempDoc.body.innerHTML =\n    \"<div><p id=\"el\" class=\"js-Pjax\"></p></div><span></span>\";\n  var selectors = [\"div\"];\n  var el = tempDoc.body.querySelector(\"#el\");\n  t.equal(\n    contains(tempDoc, selectors, el),\n    true,\n    \"contains() returns true when a selector contains the element\"\n  );\n\n  selectors = [\"span\"];\n  t.equal(\n    contains(tempDoc, selectors, el),\n    false,\n    \"contains() returns false when the selectors do not contain the element\"\n  );\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar noop = require(\"../../../lib/util/noop\");\n\ntape(\"test noop function\", function(t) {\n  t.equal(typeof noop, \"function\", \"noop is a function\");\n  t.equal(noop(), undefined, \"noop() returns nothing\");\n  t.end();\n});\n","source":"lib/pjax/tests/lib/util/noop.js","raw":"var tape = require(\"tape\");\n\nvar noop = require(\"../../../lib/util/noop\");\n\ntape(\"test noop function\", function(t) {\n  t.equal(typeof noop, \"function\", \"noop is a function\");\n  t.equal(noop(), undefined, \"noop() returns nothing\");\n  t.end();\n});\n","date":"2021-10-30T06:38:12.807Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/util/noop.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5c001inwlw9t9ecpfm","content":"var tape = require(\"tape\");\n\nvar noop = require(\"../../../lib/util/noop\");\n\ntape(\"test noop function\", function(t) {\n  t.equal(typeof noop, \"function\", \"noop is a function\");\n  t.equal(noop(), undefined, \"noop() returns nothing\");\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar noop = require(\"../../../lib/util/noop\");\n\ntape(\"test noop function\", function(t) {\n  t.equal(typeof noop, \"function\", \"noop is a function\");\n  t.equal(noop(), undefined, \"noop() returns nothing\");\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar extend = require(\"../../../lib/util/extend\");\n\ntape(\"test extend method\", function(t) {\n  var obj = { one: 1, two: 2 };\n\n  var extended = extend({}, obj, { two: \"two\", three: 3 });\n  t.notEqual(obj, extended, \"extended object isn't the original object\");\n  t.notSame(\n    obj,\n    extended,\n    \"extended object doesn't have the same values as original object\"\n  );\n  t.notSame(\n    obj.two,\n    extended.two,\n    \"extended object value overwrites value from original object\"\n  );\n\n  extended = extend(null);\n  t.equals(extended, null, \"passing null returns null\");\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/util/extend.js","raw":"var tape = require(\"tape\");\n\nvar extend = require(\"../../../lib/util/extend\");\n\ntape(\"test extend method\", function(t) {\n  var obj = { one: 1, two: 2 };\n\n  var extended = extend({}, obj, { two: \"two\", three: 3 });\n  t.notEqual(obj, extended, \"extended object isn't the original object\");\n  t.notSame(\n    obj,\n    extended,\n    \"extended object doesn't have the same values as original object\"\n  );\n  t.notSame(\n    obj.two,\n    extended.two,\n    \"extended object value overwrites value from original object\"\n  );\n\n  extended = extend(null);\n  t.equals(extended, null, \"passing null returns null\");\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.806Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/util/extend.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5d001jnwlwe7ek4srs","content":"var tape = require(\"tape\");\n\nvar extend = require(\"../../../lib/util/extend\");\n\ntape(\"test extend method\", function(t) {\n  var obj = { one: 1, two: 2 };\n\n  var extended = extend({}, obj, { two: \"two\", three: 3 });\n  t.notEqual(obj, extended, \"extended object isn't the original object\");\n  t.notSame(\n    obj,\n    extended,\n    \"extended object doesn't have the same values as original object\"\n  );\n  t.notSame(\n    obj.two,\n    extended.two,\n    \"extended object value overwrites value from original object\"\n  );\n\n  extended = extend(null);\n  t.equals(extended, null, \"passing null returns null\");\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar extend = require(\"../../../lib/util/extend\");\n\ntape(\"test extend method\", function(t) {\n  var obj = { one: 1, two: 2 };\n\n  var extended = extend({}, obj, { two: \"two\", three: 3 });\n  t.notEqual(obj, extended, \"extended object isn't the original object\");\n  t.notSame(\n    obj,\n    extended,\n    \"extended object doesn't have the same values as original object\"\n  );\n  t.notSame(\n    obj.two,\n    extended.two,\n    \"extended object value overwrites value from original object\"\n  );\n\n  extended = extend(null);\n  t.equals(extended, null, \"passing null returns null\");\n\n  t.end();\n});\n"},{"_content":"var tape = require(\"tape\");\n\nvar updateQueryString = require(\"../../../lib/util/update-query-string\");\n\ntape(\"test update query string method\", function(t) {\n  var url = \"http://example.com\";\n  var updatedUrl = updateQueryString(url, \"foo\", \"bar\");\n\n  t.notEqual(url, updatedUrl, \"update query string modifies URL\");\n  t.equal(\n    updatedUrl,\n    url + \"?foo=bar\",\n    \"update query string creates new query string when no query string params are set\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"foo\", \"baz\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz\",\n    \"update query string updates existing query string param\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"bar\", \"\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz&bar=\",\n    \"update query string appends to existing query string\"\n  );\n\n  t.end();\n});\n","source":"lib/pjax/tests/lib/util/update-query-string.js","raw":"var tape = require(\"tape\");\n\nvar updateQueryString = require(\"../../../lib/util/update-query-string\");\n\ntape(\"test update query string method\", function(t) {\n  var url = \"http://example.com\";\n  var updatedUrl = updateQueryString(url, \"foo\", \"bar\");\n\n  t.notEqual(url, updatedUrl, \"update query string modifies URL\");\n  t.equal(\n    updatedUrl,\n    url + \"?foo=bar\",\n    \"update query string creates new query string when no query string params are set\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"foo\", \"baz\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz\",\n    \"update query string updates existing query string param\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"bar\", \"\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz&bar=\",\n    \"update query string appends to existing query string\"\n  );\n\n  t.end();\n});\n","date":"2021-10-30T06:38:12.808Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/tests/lib/util/update-query-string.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y5d001knwlw0uno34w3","content":"var tape = require(\"tape\");\n\nvar updateQueryString = require(\"../../../lib/util/update-query-string\");\n\ntape(\"test update query string method\", function(t) {\n  var url = \"http://example.com\";\n  var updatedUrl = updateQueryString(url, \"foo\", \"bar\");\n\n  t.notEqual(url, updatedUrl, \"update query string modifies URL\");\n  t.equal(\n    updatedUrl,\n    url + \"?foo=bar\",\n    \"update query string creates new query string when no query string params are set\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"foo\", \"baz\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz\",\n    \"update query string updates existing query string param\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"bar\", \"\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz&bar=\",\n    \"update query string appends to existing query string\"\n  );\n\n  t.end();\n});\n","site":{"data":{}},"excerpt":"","more":"var tape = require(\"tape\");\n\nvar updateQueryString = require(\"../../../lib/util/update-query-string\");\n\ntape(\"test update query string method\", function(t) {\n  var url = \"http://example.com\";\n  var updatedUrl = updateQueryString(url, \"foo\", \"bar\");\n\n  t.notEqual(url, updatedUrl, \"update query string modifies URL\");\n  t.equal(\n    updatedUrl,\n    url + \"?foo=bar\",\n    \"update query string creates new query string when no query string params are set\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"foo\", \"baz\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz\",\n    \"update query string updates existing query string param\"\n  );\n\n  updatedUrl = updateQueryString(updatedUrl, \"bar\", \"\");\n\n  t.equal(\n    updatedUrl,\n    url + \"?foo=baz&bar=\",\n    \"update query string appends to existing query string\"\n  );\n\n  t.end();\n});\n"},{"_content":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){var forEachEls=require(\"./lib/foreach-els\");var parseOptions=require(\"./lib/parse-options\");var switches=require(\"./lib/switches\");var newUid=require(\"./lib/uniqueid\");var on=require(\"./lib/events/on\");var trigger=require(\"./lib/events/trigger\");var clone=require(\"./lib/util/clone\");var contains=require(\"./lib/util/contains\");var extend=require(\"./lib/util/extend\");var noop=require(\"./lib/util/noop\");var Pjax=function(options){this.state={numPendingSwitches:0,href:null,options:null};this.options=parseOptions(options);this.log(\"Pjax options\",this.options);if(this.options.scrollRestoration&&\"scrollRestoration\"in history){history.scrollRestoration=\"manual\"}this.maxUid=this.lastUid=newUid();this.parseDOM(document);on(window,\"popstate\",function(st){if(st.state){var opt=clone(this.options);opt.url=st.state.url;opt.title=st.state.title;opt.history=false;opt.scrollPos=st.state.scrollPos;if(st.state.uid<this.lastUid){opt.backward=true}else{opt.forward=true}this.lastUid=st.state.uid;this.loadUrl(st.state.url,opt)}}.bind(this))};Pjax.switches=switches;Pjax.prototype={log:require(\"./lib/proto/log\"),getElements:function(el){return el.querySelectorAll(this.options.elements)},parseDOM:function(el){var parseElement=require(\"./lib/proto/parse-element\");forEachEls(this.getElements(el),parseElement,this)},refresh:function(el){this.parseDOM(el||document)},reload:function(){window.location.reload()},attachLink:require(\"./lib/proto/attach-link\"),attachForm:require(\"./lib/proto/attach-form\"),forEachSelectors:function(cb,context,DOMcontext){return require(\"./lib/foreach-selectors\").bind(this)(this.options.selectors,cb,context,DOMcontext)},switchSelectors:function(selectors,fromEl,toEl,options){return require(\"./lib/switches-selectors\").bind(this)(this.options.switches,this.options.switchesOptions,selectors,fromEl,toEl,options)},latestChance:function(href){window.location=href},onSwitch:function(){trigger(window,\"resize scroll\");this.state.numPendingSwitches--;if(this.state.numPendingSwitches===0){this.afterAllSwitches()}},loadContent:function(html,options){if(typeof html!==\"string\"){trigger(document,\"pjax:complete pjax:error\",options);return}var tmpEl=document.implementation.createHTMLDocument(\"pjax\");var htmlRegex=/<html[^>]+>/gi;var htmlAttribsRegex=/\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;var matches=html.match(htmlRegex);if(matches&&matches.length){matches=matches[0].match(htmlAttribsRegex);if(matches.length){matches.shift();matches.forEach(function(htmlAttrib){var attr=htmlAttrib.trim().split(\"=\");if(attr.length===1){tmpEl.documentElement.setAttribute(attr[0],true)}else{tmpEl.documentElement.setAttribute(attr[0],attr[1].slice(1,-1))}})}}tmpEl.documentElement.innerHTML=html;this.log(\"load content\",tmpEl.documentElement.attributes,tmpEl.documentElement.innerHTML.length);if(document.activeElement&&contains(document,this.options.selectors,document.activeElement)){try{document.activeElement.blur()}catch(e){}}this.switchSelectors(this.options.selectors,tmpEl,document,options)},abortRequest:require(\"./lib/abort-request\"),doRequest:require(\"./lib/send-request\"),handleResponse:require(\"./lib/proto/handle-response\"),loadUrl:function(href,options){options=typeof options===\"object\"?extend({},this.options,options):clone(this.options);this.log(\"load href\",href,options);this.abortRequest(this.request);trigger(document,\"pjax:send\",options);this.request=this.doRequest(href,options,this.handleResponse.bind(this))},afterAllSwitches:function(){var autofocusEl=Array.prototype.slice.call(document.querySelectorAll(\"[autofocus]\")).pop();if(autofocusEl&&document.activeElement!==autofocusEl){autofocusEl.focus()}this.options.selectors.forEach(function(selector){forEachEls(document.querySelectorAll(selector),function(el){if(el===0);})});var state=this.state;if(state.options.history){if(!window.history.state){this.lastUid=this.maxUid=newUid();window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid,scrollPos:[0,0]},document.title)}this.lastUid=this.maxUid=newUid();window.history.pushState({url:state.href,title:state.options.title,uid:this.maxUid,scrollPos:[0,0]},state.options.title,state.href)}this.forEachSelectors(function(el){this.parseDOM(el)},this);trigger(document,\"pjax:complete pjax:success\",state.options);if(typeof state.options.analytics===\"function\"){state.options.analytics()}if(state.options.history){var a=document.createElement(\"a\");a.href=this.state.href;if(a.hash){var name=a.hash.slice(1);name=decodeURIComponent(name);var curtop=0;var target=document.getElementById(name)||document.getElementsByName(name)[0];if(target){if(target.offsetParent){do{curtop+=target.offsetTop;target=target.offsetParent}while(target)}}window.scrollTo(0,curtop)}else if(state.options.scrollTo!==false){if(state.options.scrollTo.length>1){window.scrollTo(state.options.scrollTo[0],state.options.scrollTo[1])}else{window.scrollTo(0,state.options.scrollTo)}}}else if(state.options.scrollRestoration&&state.options.scrollPos){window.scrollTo(state.options.scrollPos[0],state.options.scrollPos[1])}this.state={numPendingSwitches:0,href:null,options:null}}};Pjax.isSupported=require(\"./lib/is-supported\");if(Pjax.isSupported()){module.exports=Pjax}else{var stupidPjax=noop;for(var key in Pjax.prototype){if(Pjax.prototype.hasOwnProperty(key)&&typeof Pjax.prototype[key]===\"function\"){stupidPjax[key]=noop}}module.exports=stupidPjax}},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){var noop=require(\"./util/noop\");module.exports=function(request){if(request&&request.readyState<4){request.onreadystatechange=noop;request.abort()}}},{\"./util/noop\":21}],3:[function(require,module,exports){var forEachEls=require(\"../foreach-els\");module.exports=function(els,events,listener,useCapture){events=typeof events===\"string\"?events.split(\" \"):events;events.forEach(function(e){forEachEls(els,function(el){el.addEventListener(e,listener,useCapture)})})}},{\"../foreach-els\":5}],4:[function(require,module,exports){var forEachEls=require(\"../foreach-els\");module.exports=function(els,events,opts){events=typeof events===\"string\"?events.split(\" \"):events;events.forEach(function(e){var event;event=document.createEvent(\"HTMLEvents\");event.initEvent(e,true,true);event.eventName=e;if(opts){Object.keys(opts).forEach(function(key){event[key]=opts[key]})}forEachEls(els,function(el){var domFix=false;if(!el.parentNode&&el!==document&&el!==window){domFix=true;document.body.appendChild(el)}el.dispatchEvent(event);if(domFix){el.parentNode.removeChild(el)}})})}},{\"../foreach-els\":5}],5:[function(require,module,exports){module.exports=function(els,fn,context){if(els instanceof HTMLCollection||els instanceof NodeList||els instanceof Array){return Array.prototype.forEach.call(els,fn,context)}return fn.call(context,els)}},{}],6:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");module.exports=function(selectors,cb,context,DOMcontext){DOMcontext=DOMcontext||document;selectors.forEach(function(selector){forEachEls(DOMcontext.querySelectorAll(selector),cb,context)})}},{\"./foreach-els\":5}],7:[function(require,module,exports){module.exports=function(){return window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/)}},{}],8:[function(require,module,exports){var defaultSwitches=require(\"./switches\");module.exports=function(options){options=options||{};options.elements=options.elements||\"a[href], form[action]\";options.selectors=options.selectors||[\"title\",\".js-Pjax\"];options.switches=options.switches||{};options.switchesOptions=options.switchesOptions||{};options.history=typeof options.history===\"undefined\"?true:options.history;options.analytics=typeof options.analytics===\"function\"||options.analytics===false?options.analytics:defaultAnalytics;options.scrollTo=typeof options.scrollTo===\"undefined\"?0:options.scrollTo;options.scrollRestoration=typeof options.scrollRestoration!==\"undefined\"?options.scrollRestoration:true;options.cacheBust=typeof options.cacheBust===\"undefined\"?true:options.cacheBust;options.debug=options.debug||false;options.timeout=options.timeout||0;options.currentUrlFullReload=typeof options.currentUrlFullReload===\"undefined\"?false:options.currentUrlFullReload;if(!options.switches.head){options.switches.head=defaultSwitches.switchElementsAlt}if(!options.switches.body){options.switches.body=defaultSwitches.switchElementsAlt}return options};function defaultAnalytics(){if(window._gaq){_gaq.push([\"_trackPageview\"])}if(window.ga){ga(\"send\",\"pageview\",{page:location.pathname,title:document.title})}}},{\"./switches\":16}],9:[function(require,module,exports){var on=require(\"../events/on\");var clone=require(\"../util/clone\");var attrState=\"data-pjax-state\";var formAction=function(el,event){if(isDefaultPrevented(event)){return}var options=clone(this.options);options.requestOptions={requestUrl:el.getAttribute(\"action\")||window.location.href,requestMethod:el.getAttribute(\"method\")||\"GET\"};var virtLinkElement=document.createElement(\"a\");virtLinkElement.setAttribute(\"href\",options.requestOptions.requestUrl);var attrValue=checkIfShouldAbort(virtLinkElement,options);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(el.enctype===\"multipart/form-data\"){options.requestOptions.formData=new FormData(el)}else{options.requestOptions.requestParams=parseFormElements(el)}el.setAttribute(attrState,\"submit\");options.triggerElement=el;this.loadUrl(virtLinkElement.href,options)};function parseFormElements(el){var requestParams=[];var formElements=el.elements;for(var i=0;i<formElements.length;i++){var element=formElements[i];var tagName=element.tagName.toLowerCase();if(!!element.name&&element.attributes!==undefined&&tagName!==\"button\"){var type=element.attributes.type;if(!type||type.value!==\"checkbox\"&&type.value!==\"radio\"||element.checked){var values=[];if(tagName===\"select\"){var opt;for(var j=0;j<element.options.length;j++){opt=element.options[j];if(opt.selected&&!opt.disabled){values.push(opt.hasAttribute(\"value\")?opt.value:opt.text)}}}else{values.push(element.value)}for(var k=0;k<values.length;k++){requestParams.push({name:encodeURIComponent(element.name),value:encodeURIComponent(values[k])})}}}}return requestParams}function checkIfShouldAbort(virtLinkElement,options){if(virtLinkElement.protocol!==window.location.protocol||virtLinkElement.host!==window.location.host){return\"external\"}if(virtLinkElement.hash&&virtLinkElement.href.replace(virtLinkElement.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(virtLinkElement.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}if(options.currentUrlFullReload&&virtLinkElement.href===window.location.href.split(\"#\")[0]){return\"reload\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"submit\",function(event){formAction.call(that,el,event)})}},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){var on=require(\"../events/on\");var clone=require(\"../util/clone\");var attrState=\"data-pjax-state\";var linkAction=function(el,event){if(isDefaultPrevented(event)){return}var options=clone(this.options);var attrValue=checkIfShouldAbort(el,event);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(this.options.currentUrlFullReload&&el.href===window.location.href.split(\"#\")[0]){el.setAttribute(attrState,\"reload\");this.reload();return}el.setAttribute(attrState,\"load\");options.triggerElement=el;this.loadUrl(el.href,options)};function checkIfShouldAbort(el,event){if(event.which>1||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey){return\"modifier\"}if(el.protocol!==window.location.protocol||el.host!==window.location.host){return\"external\"}if(el.hash&&el.href.replace(el.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(el.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"click\",function(event){linkAction.call(that,el,event)});on(el,\"keyup\",function(event){if(event.keyCode===13){linkAction.call(that,el,event)}}.bind(this))}},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){var clone=require(\"../util/clone\");var newUid=require(\"../uniqueid\");var trigger=require(\"../events/trigger\");module.exports=function(responseText,request,href,options){options=clone(options||this.options);options.request=request;if(responseText===false){trigger(document,\"pjax:complete pjax:error\",options);return}var currentState=window.history.state||{};window.history.replaceState({url:currentState.url||window.location.href,title:currentState.title||document.title,uid:currentState.uid||newUid(),scrollPos:[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]},document.title,window.location.href);var oldHref=href;if(request.responseURL){if(href!==request.responseURL){href=request.responseURL}}else if(request.getResponseHeader(\"X-PJAX-URL\")){href=request.getResponseHeader(\"X-PJAX-URL\")}else if(request.getResponseHeader(\"X-XHR-Redirected-To\")){href=request.getResponseHeader(\"X-XHR-Redirected-To\")}var a=document.createElement(\"a\");a.href=oldHref;var oldHash=a.hash;a.href=href;if(oldHash&&!a.hash){a.hash=oldHash;href=a.href}this.state.href=href;this.state.options=options;try{this.loadContent(responseText,options)}catch(e){trigger(document,\"pjax:error\",options);if(!this.options.debug){if(console&&console.error){console.error(\"Pjax switch fail: \",e)}return this.latestChance(href)}else{throw e}}}},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){module.exports=function(){if(this.options.debug&&console){if(typeof console.log===\"function\"){console.log.apply(console,arguments)}else if(console.log){console.log(arguments)}}}},{}],13:[function(require,module,exports){var attrState=\"data-pjax-state\";module.exports=function(el){switch(el.tagName.toLowerCase()){case\"a\":if(!el.hasAttribute(attrState)){this.attachLink(el)}break;case\"form\":if(!el.hasAttribute(attrState)){this.attachForm(el)}break;default:throw\"Pjax can only be applied on <a> or <form> submit\"}}},{}],14:[function(require,module,exports){var updateQueryString=require(\"./util/update-query-string\");module.exports=function(location,options,callback){options=options||{};var queryString;var requestOptions=options.requestOptions||{};var requestMethod=(requestOptions.requestMethod||\"GET\").toUpperCase();var requestParams=requestOptions.requestParams||null;var formData=requestOptions.formData||null;var requestPayload=null;var request=new XMLHttpRequest;var timeout=options.timeout||0;request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){callback(request.responseText,request,location,options)}else if(request.status!==0){callback(null,request,location,options)}}};request.onerror=function(e){console.log(e);callback(null,request,location,options)};request.ontimeout=function(){callback(null,request,location,options)};if(requestParams&&requestParams.length){queryString=requestParams.map(function(param){return param.name+\"=\"+param.value}).join(\"&\");switch(requestMethod){case\"GET\":location=location.split(\"?\")[0];location+=\"?\"+queryString;break;case\"POST\":requestPayload=queryString;break}}else if(formData){requestPayload=formData}if(options.cacheBust){location=updateQueryString(location,\"t\",Date.now())}request.open(requestMethod,location,true);request.timeout=timeout;request.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");request.setRequestHeader(\"X-PJAX\",\"true\");request.setRequestHeader(\"X-PJAX-Selectors\",JSON.stringify(options.selectors));if(requestPayload&&requestMethod===\"POST\"&&!formData){request.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\")}request.send(requestPayload);return request}},{\"./util/update-query-string\":22}],15:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");var defaultSwitches=require(\"./switches\");module.exports=function(switches,switchesOptions,selectors,fromEl,toEl,options){var switchesQueue=[];selectors.forEach(function(selector){var newEls=fromEl.querySelectorAll(selector);var oldEls=toEl.querySelectorAll(selector);if(this.log){this.log(\"Pjax switch\",selector,newEls,oldEls)}if(newEls.length!==oldEls.length){throw\"DOM doesn’t look the same on new loaded page: ’\"+selector+\"’ - new \"+newEls.length+\", old \"+oldEls.length}forEachEls(newEls,function(newEl,i){var oldEl=oldEls[i];if(this.log){this.log(\"newEl\",newEl,\"oldEl\",oldEl)}var callback=switches[selector]?switches[selector].bind(this,oldEl,newEl,options,switchesOptions[selector]):defaultSwitches.outerHTML.bind(this,oldEl,newEl,options);switchesQueue.push(callback)},this)},this);this.state.numPendingSwitches=switchesQueue.length;switchesQueue.forEach(function(queuedSwitch){queuedSwitch()})}},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){var on=require(\"./events/on\");module.exports={outerHTML:function(oldEl,newEl){oldEl.outerHTML=newEl.outerHTML;this.onSwitch()},innerHTML:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.className===\"\"){oldEl.removeAttribute(\"class\")}else{}this.onSwitch()},switchElementsAlt:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.hasAttributes()){var attrs=newEl.attributes;for(var i=0;i<attrs.length;i++){oldEl.attributes.setNamedItem(attrs[i].cloneNode())}}this.onSwitch()},replaceNode:function(oldEl,newEl){oldEl.parentNode.replaceChild(newEl,oldEl);this.onSwitch()},sideBySide:function(oldEl,newEl,options,switchOptions){var forEach=Array.prototype.forEach;var elsToRemove=[];var elsToAdd=[];var fragToAppend=document.createDocumentFragment();var animationEventNames=\"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";var animatedElsNumber=0;var sexyAnimationEnd=function(e){if(e.target!==e.currentTarget){return}animatedElsNumber--;if(animatedElsNumber<=0&&elsToRemove){elsToRemove.forEach(function(el){if(el.parentNode){el.parentNode.removeChild(el)}});elsToAdd.forEach(function(el){el.className=el.className.replace(el.getAttribute(\"data-pjax-classes\"),\"\");el.removeAttribute(\"data-pjax-classes\")});elsToAdd=null;elsToRemove=null;this.onSwitch()}}.bind(this);switchOptions=switchOptions||{};forEach.call(oldEl.childNodes,function(el){elsToRemove.push(el);if(el.classList&&!el.classList.contains(\"js-Pjax-remove\")){if(el.hasAttribute(\"data-pjax-classes\")){el.className=el.className.replace(el.getAttribute(\"data-pjax-classes\"),\"\");el.removeAttribute(\"data-pjax-classes\")}el.classList.add(\"js-Pjax-remove\");if(switchOptions.callbacks&&switchOptions.callbacks.removeElement){switchOptions.callbacks.removeElement(el)}if(switchOptions.classNames){el.className+=\" \"+switchOptions.classNames.remove+\" \"+(options.backward?switchOptions.classNames.backward:switchOptions.classNames.forward)}animatedElsNumber++;on(el,animationEventNames,sexyAnimationEnd,true)}});forEach.call(newEl.childNodes,function(el){if(el.classList){var addClasses=\"\";if(switchOptions.classNames){addClasses=\" js-Pjax-add \"+switchOptions.classNames.add+\" \"+(options.backward?switchOptions.classNames.forward:switchOptions.classNames.backward)}if(switchOptions.callbacks&&switchOptions.callbacks.addElement){switchOptions.callbacks.addElement(el)}el.className+=addClasses;el.setAttribute(\"data-pjax-classes\",addClasses);elsToAdd.push(el);fragToAppend.appendChild(el);animatedElsNumber++;on(el,animationEventNames,sexyAnimationEnd,true)}});oldEl.className=newEl.className;oldEl.appendChild(fragToAppend)}}},{\"./events/on\":3}],17:[function(require,module,exports){module.exports=function(){var counter=0;return function(){var id=\"pjax\"+(new Date).getTime()+\"_\"+counter;counter++;return id}}()},{}],18:[function(require,module,exports){module.exports=function(obj){if(null===obj||\"object\"!==typeof obj){return obj}var copy=obj.constructor();for(var attr in obj){if(obj.hasOwnProperty(attr)){copy[attr]=obj[attr]}}return copy}},{}],19:[function(require,module,exports){module.exports=function contains(doc,selectors,el){for(var i=0;i<selectors.length;i++){var selectedEls=doc.querySelectorAll(selectors[i]);for(var j=0;j<selectedEls.length;j++){if(selectedEls[j].contains(el)){return true}}}return false}},{}],20:[function(require,module,exports){module.exports=function(target){if(target==null){return null}var to=Object(target);for(var i=1;i<arguments.length;i++){var source=arguments[i];if(source!=null){for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){to[key]=source[key]}}}}return to}},{}],21:[function(require,module,exports){module.exports=function(){}},{}],22:[function(require,module,exports){module.exports=function(uri,key,value){var re=new RegExp(\"([?&])\"+key+\"=.*?(&|$)\",\"i\");var separator=uri.indexOf(\"?\")!==-1?\"&\":\"?\";if(uri.match(re)){return uri.replace(re,\"$1\"+key+\"=\"+value+\"$2\")}else{return uri+separator+key+\"=\"+value}}},{}]},{},[1])(1)});","source":"lib/pjax/pjax.min.js","raw":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){var forEachEls=require(\"./lib/foreach-els\");var parseOptions=require(\"./lib/parse-options\");var switches=require(\"./lib/switches\");var newUid=require(\"./lib/uniqueid\");var on=require(\"./lib/events/on\");var trigger=require(\"./lib/events/trigger\");var clone=require(\"./lib/util/clone\");var contains=require(\"./lib/util/contains\");var extend=require(\"./lib/util/extend\");var noop=require(\"./lib/util/noop\");var Pjax=function(options){this.state={numPendingSwitches:0,href:null,options:null};this.options=parseOptions(options);this.log(\"Pjax options\",this.options);if(this.options.scrollRestoration&&\"scrollRestoration\"in history){history.scrollRestoration=\"manual\"}this.maxUid=this.lastUid=newUid();this.parseDOM(document);on(window,\"popstate\",function(st){if(st.state){var opt=clone(this.options);opt.url=st.state.url;opt.title=st.state.title;opt.history=false;opt.scrollPos=st.state.scrollPos;if(st.state.uid<this.lastUid){opt.backward=true}else{opt.forward=true}this.lastUid=st.state.uid;this.loadUrl(st.state.url,opt)}}.bind(this))};Pjax.switches=switches;Pjax.prototype={log:require(\"./lib/proto/log\"),getElements:function(el){return el.querySelectorAll(this.options.elements)},parseDOM:function(el){var parseElement=require(\"./lib/proto/parse-element\");forEachEls(this.getElements(el),parseElement,this)},refresh:function(el){this.parseDOM(el||document)},reload:function(){window.location.reload()},attachLink:require(\"./lib/proto/attach-link\"),attachForm:require(\"./lib/proto/attach-form\"),forEachSelectors:function(cb,context,DOMcontext){return require(\"./lib/foreach-selectors\").bind(this)(this.options.selectors,cb,context,DOMcontext)},switchSelectors:function(selectors,fromEl,toEl,options){return require(\"./lib/switches-selectors\").bind(this)(this.options.switches,this.options.switchesOptions,selectors,fromEl,toEl,options)},latestChance:function(href){window.location=href},onSwitch:function(){trigger(window,\"resize scroll\");this.state.numPendingSwitches--;if(this.state.numPendingSwitches===0){this.afterAllSwitches()}},loadContent:function(html,options){if(typeof html!==\"string\"){trigger(document,\"pjax:complete pjax:error\",options);return}var tmpEl=document.implementation.createHTMLDocument(\"pjax\");var htmlRegex=/<html[^>]+>/gi;var htmlAttribsRegex=/\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;var matches=html.match(htmlRegex);if(matches&&matches.length){matches=matches[0].match(htmlAttribsRegex);if(matches.length){matches.shift();matches.forEach(function(htmlAttrib){var attr=htmlAttrib.trim().split(\"=\");if(attr.length===1){tmpEl.documentElement.setAttribute(attr[0],true)}else{tmpEl.documentElement.setAttribute(attr[0],attr[1].slice(1,-1))}})}}tmpEl.documentElement.innerHTML=html;this.log(\"load content\",tmpEl.documentElement.attributes,tmpEl.documentElement.innerHTML.length);if(document.activeElement&&contains(document,this.options.selectors,document.activeElement)){try{document.activeElement.blur()}catch(e){}}this.switchSelectors(this.options.selectors,tmpEl,document,options)},abortRequest:require(\"./lib/abort-request\"),doRequest:require(\"./lib/send-request\"),handleResponse:require(\"./lib/proto/handle-response\"),loadUrl:function(href,options){options=typeof options===\"object\"?extend({},this.options,options):clone(this.options);this.log(\"load href\",href,options);this.abortRequest(this.request);trigger(document,\"pjax:send\",options);this.request=this.doRequest(href,options,this.handleResponse.bind(this))},afterAllSwitches:function(){var autofocusEl=Array.prototype.slice.call(document.querySelectorAll(\"[autofocus]\")).pop();if(autofocusEl&&document.activeElement!==autofocusEl){autofocusEl.focus()}this.options.selectors.forEach(function(selector){forEachEls(document.querySelectorAll(selector),function(el){if(el===0);})});var state=this.state;if(state.options.history){if(!window.history.state){this.lastUid=this.maxUid=newUid();window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid,scrollPos:[0,0]},document.title)}this.lastUid=this.maxUid=newUid();window.history.pushState({url:state.href,title:state.options.title,uid:this.maxUid,scrollPos:[0,0]},state.options.title,state.href)}this.forEachSelectors(function(el){this.parseDOM(el)},this);trigger(document,\"pjax:complete pjax:success\",state.options);if(typeof state.options.analytics===\"function\"){state.options.analytics()}if(state.options.history){var a=document.createElement(\"a\");a.href=this.state.href;if(a.hash){var name=a.hash.slice(1);name=decodeURIComponent(name);var curtop=0;var target=document.getElementById(name)||document.getElementsByName(name)[0];if(target){if(target.offsetParent){do{curtop+=target.offsetTop;target=target.offsetParent}while(target)}}window.scrollTo(0,curtop)}else if(state.options.scrollTo!==false){if(state.options.scrollTo.length>1){window.scrollTo(state.options.scrollTo[0],state.options.scrollTo[1])}else{window.scrollTo(0,state.options.scrollTo)}}}else if(state.options.scrollRestoration&&state.options.scrollPos){window.scrollTo(state.options.scrollPos[0],state.options.scrollPos[1])}this.state={numPendingSwitches:0,href:null,options:null}}};Pjax.isSupported=require(\"./lib/is-supported\");if(Pjax.isSupported()){module.exports=Pjax}else{var stupidPjax=noop;for(var key in Pjax.prototype){if(Pjax.prototype.hasOwnProperty(key)&&typeof Pjax.prototype[key]===\"function\"){stupidPjax[key]=noop}}module.exports=stupidPjax}},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){var noop=require(\"./util/noop\");module.exports=function(request){if(request&&request.readyState<4){request.onreadystatechange=noop;request.abort()}}},{\"./util/noop\":21}],3:[function(require,module,exports){var forEachEls=require(\"../foreach-els\");module.exports=function(els,events,listener,useCapture){events=typeof events===\"string\"?events.split(\" \"):events;events.forEach(function(e){forEachEls(els,function(el){el.addEventListener(e,listener,useCapture)})})}},{\"../foreach-els\":5}],4:[function(require,module,exports){var forEachEls=require(\"../foreach-els\");module.exports=function(els,events,opts){events=typeof events===\"string\"?events.split(\" \"):events;events.forEach(function(e){var event;event=document.createEvent(\"HTMLEvents\");event.initEvent(e,true,true);event.eventName=e;if(opts){Object.keys(opts).forEach(function(key){event[key]=opts[key]})}forEachEls(els,function(el){var domFix=false;if(!el.parentNode&&el!==document&&el!==window){domFix=true;document.body.appendChild(el)}el.dispatchEvent(event);if(domFix){el.parentNode.removeChild(el)}})})}},{\"../foreach-els\":5}],5:[function(require,module,exports){module.exports=function(els,fn,context){if(els instanceof HTMLCollection||els instanceof NodeList||els instanceof Array){return Array.prototype.forEach.call(els,fn,context)}return fn.call(context,els)}},{}],6:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");module.exports=function(selectors,cb,context,DOMcontext){DOMcontext=DOMcontext||document;selectors.forEach(function(selector){forEachEls(DOMcontext.querySelectorAll(selector),cb,context)})}},{\"./foreach-els\":5}],7:[function(require,module,exports){module.exports=function(){return window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/)}},{}],8:[function(require,module,exports){var defaultSwitches=require(\"./switches\");module.exports=function(options){options=options||{};options.elements=options.elements||\"a[href], form[action]\";options.selectors=options.selectors||[\"title\",\".js-Pjax\"];options.switches=options.switches||{};options.switchesOptions=options.switchesOptions||{};options.history=typeof options.history===\"undefined\"?true:options.history;options.analytics=typeof options.analytics===\"function\"||options.analytics===false?options.analytics:defaultAnalytics;options.scrollTo=typeof options.scrollTo===\"undefined\"?0:options.scrollTo;options.scrollRestoration=typeof options.scrollRestoration!==\"undefined\"?options.scrollRestoration:true;options.cacheBust=typeof options.cacheBust===\"undefined\"?true:options.cacheBust;options.debug=options.debug||false;options.timeout=options.timeout||0;options.currentUrlFullReload=typeof options.currentUrlFullReload===\"undefined\"?false:options.currentUrlFullReload;if(!options.switches.head){options.switches.head=defaultSwitches.switchElementsAlt}if(!options.switches.body){options.switches.body=defaultSwitches.switchElementsAlt}return options};function defaultAnalytics(){if(window._gaq){_gaq.push([\"_trackPageview\"])}if(window.ga){ga(\"send\",\"pageview\",{page:location.pathname,title:document.title})}}},{\"./switches\":16}],9:[function(require,module,exports){var on=require(\"../events/on\");var clone=require(\"../util/clone\");var attrState=\"data-pjax-state\";var formAction=function(el,event){if(isDefaultPrevented(event)){return}var options=clone(this.options);options.requestOptions={requestUrl:el.getAttribute(\"action\")||window.location.href,requestMethod:el.getAttribute(\"method\")||\"GET\"};var virtLinkElement=document.createElement(\"a\");virtLinkElement.setAttribute(\"href\",options.requestOptions.requestUrl);var attrValue=checkIfShouldAbort(virtLinkElement,options);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(el.enctype===\"multipart/form-data\"){options.requestOptions.formData=new FormData(el)}else{options.requestOptions.requestParams=parseFormElements(el)}el.setAttribute(attrState,\"submit\");options.triggerElement=el;this.loadUrl(virtLinkElement.href,options)};function parseFormElements(el){var requestParams=[];var formElements=el.elements;for(var i=0;i<formElements.length;i++){var element=formElements[i];var tagName=element.tagName.toLowerCase();if(!!element.name&&element.attributes!==undefined&&tagName!==\"button\"){var type=element.attributes.type;if(!type||type.value!==\"checkbox\"&&type.value!==\"radio\"||element.checked){var values=[];if(tagName===\"select\"){var opt;for(var j=0;j<element.options.length;j++){opt=element.options[j];if(opt.selected&&!opt.disabled){values.push(opt.hasAttribute(\"value\")?opt.value:opt.text)}}}else{values.push(element.value)}for(var k=0;k<values.length;k++){requestParams.push({name:encodeURIComponent(element.name),value:encodeURIComponent(values[k])})}}}}return requestParams}function checkIfShouldAbort(virtLinkElement,options){if(virtLinkElement.protocol!==window.location.protocol||virtLinkElement.host!==window.location.host){return\"external\"}if(virtLinkElement.hash&&virtLinkElement.href.replace(virtLinkElement.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(virtLinkElement.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}if(options.currentUrlFullReload&&virtLinkElement.href===window.location.href.split(\"#\")[0]){return\"reload\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"submit\",function(event){formAction.call(that,el,event)})}},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){var on=require(\"../events/on\");var clone=require(\"../util/clone\");var attrState=\"data-pjax-state\";var linkAction=function(el,event){if(isDefaultPrevented(event)){return}var options=clone(this.options);var attrValue=checkIfShouldAbort(el,event);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(this.options.currentUrlFullReload&&el.href===window.location.href.split(\"#\")[0]){el.setAttribute(attrState,\"reload\");this.reload();return}el.setAttribute(attrState,\"load\");options.triggerElement=el;this.loadUrl(el.href,options)};function checkIfShouldAbort(el,event){if(event.which>1||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey){return\"modifier\"}if(el.protocol!==window.location.protocol||el.host!==window.location.host){return\"external\"}if(el.hash&&el.href.replace(el.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(el.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"click\",function(event){linkAction.call(that,el,event)});on(el,\"keyup\",function(event){if(event.keyCode===13){linkAction.call(that,el,event)}}.bind(this))}},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){var clone=require(\"../util/clone\");var newUid=require(\"../uniqueid\");var trigger=require(\"../events/trigger\");module.exports=function(responseText,request,href,options){options=clone(options||this.options);options.request=request;if(responseText===false){trigger(document,\"pjax:complete pjax:error\",options);return}var currentState=window.history.state||{};window.history.replaceState({url:currentState.url||window.location.href,title:currentState.title||document.title,uid:currentState.uid||newUid(),scrollPos:[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]},document.title,window.location.href);var oldHref=href;if(request.responseURL){if(href!==request.responseURL){href=request.responseURL}}else if(request.getResponseHeader(\"X-PJAX-URL\")){href=request.getResponseHeader(\"X-PJAX-URL\")}else if(request.getResponseHeader(\"X-XHR-Redirected-To\")){href=request.getResponseHeader(\"X-XHR-Redirected-To\")}var a=document.createElement(\"a\");a.href=oldHref;var oldHash=a.hash;a.href=href;if(oldHash&&!a.hash){a.hash=oldHash;href=a.href}this.state.href=href;this.state.options=options;try{this.loadContent(responseText,options)}catch(e){trigger(document,\"pjax:error\",options);if(!this.options.debug){if(console&&console.error){console.error(\"Pjax switch fail: \",e)}return this.latestChance(href)}else{throw e}}}},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){module.exports=function(){if(this.options.debug&&console){if(typeof console.log===\"function\"){console.log.apply(console,arguments)}else if(console.log){console.log(arguments)}}}},{}],13:[function(require,module,exports){var attrState=\"data-pjax-state\";module.exports=function(el){switch(el.tagName.toLowerCase()){case\"a\":if(!el.hasAttribute(attrState)){this.attachLink(el)}break;case\"form\":if(!el.hasAttribute(attrState)){this.attachForm(el)}break;default:throw\"Pjax can only be applied on <a> or <form> submit\"}}},{}],14:[function(require,module,exports){var updateQueryString=require(\"./util/update-query-string\");module.exports=function(location,options,callback){options=options||{};var queryString;var requestOptions=options.requestOptions||{};var requestMethod=(requestOptions.requestMethod||\"GET\").toUpperCase();var requestParams=requestOptions.requestParams||null;var formData=requestOptions.formData||null;var requestPayload=null;var request=new XMLHttpRequest;var timeout=options.timeout||0;request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){callback(request.responseText,request,location,options)}else if(request.status!==0){callback(null,request,location,options)}}};request.onerror=function(e){console.log(e);callback(null,request,location,options)};request.ontimeout=function(){callback(null,request,location,options)};if(requestParams&&requestParams.length){queryString=requestParams.map(function(param){return param.name+\"=\"+param.value}).join(\"&\");switch(requestMethod){case\"GET\":location=location.split(\"?\")[0];location+=\"?\"+queryString;break;case\"POST\":requestPayload=queryString;break}}else if(formData){requestPayload=formData}if(options.cacheBust){location=updateQueryString(location,\"t\",Date.now())}request.open(requestMethod,location,true);request.timeout=timeout;request.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");request.setRequestHeader(\"X-PJAX\",\"true\");request.setRequestHeader(\"X-PJAX-Selectors\",JSON.stringify(options.selectors));if(requestPayload&&requestMethod===\"POST\"&&!formData){request.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\")}request.send(requestPayload);return request}},{\"./util/update-query-string\":22}],15:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");var defaultSwitches=require(\"./switches\");module.exports=function(switches,switchesOptions,selectors,fromEl,toEl,options){var switchesQueue=[];selectors.forEach(function(selector){var newEls=fromEl.querySelectorAll(selector);var oldEls=toEl.querySelectorAll(selector);if(this.log){this.log(\"Pjax switch\",selector,newEls,oldEls)}if(newEls.length!==oldEls.length){throw\"DOM doesn’t look the same on new loaded page: ’\"+selector+\"’ - new \"+newEls.length+\", old \"+oldEls.length}forEachEls(newEls,function(newEl,i){var oldEl=oldEls[i];if(this.log){this.log(\"newEl\",newEl,\"oldEl\",oldEl)}var callback=switches[selector]?switches[selector].bind(this,oldEl,newEl,options,switchesOptions[selector]):defaultSwitches.outerHTML.bind(this,oldEl,newEl,options);switchesQueue.push(callback)},this)},this);this.state.numPendingSwitches=switchesQueue.length;switchesQueue.forEach(function(queuedSwitch){queuedSwitch()})}},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){var on=require(\"./events/on\");module.exports={outerHTML:function(oldEl,newEl){oldEl.outerHTML=newEl.outerHTML;this.onSwitch()},innerHTML:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.className===\"\"){oldEl.removeAttribute(\"class\")}else{}this.onSwitch()},switchElementsAlt:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.hasAttributes()){var attrs=newEl.attributes;for(var i=0;i<attrs.length;i++){oldEl.attributes.setNamedItem(attrs[i].cloneNode())}}this.onSwitch()},replaceNode:function(oldEl,newEl){oldEl.parentNode.replaceChild(newEl,oldEl);this.onSwitch()},sideBySide:function(oldEl,newEl,options,switchOptions){var forEach=Array.prototype.forEach;var elsToRemove=[];var elsToAdd=[];var fragToAppend=document.createDocumentFragment();var animationEventNames=\"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";var animatedElsNumber=0;var sexyAnimationEnd=function(e){if(e.target!==e.currentTarget){return}animatedElsNumber--;if(animatedElsNumber<=0&&elsToRemove){elsToRemove.forEach(function(el){if(el.parentNode){el.parentNode.removeChild(el)}});elsToAdd.forEach(function(el){el.className=el.className.replace(el.getAttribute(\"data-pjax-classes\"),\"\");el.removeAttribute(\"data-pjax-classes\")});elsToAdd=null;elsToRemove=null;this.onSwitch()}}.bind(this);switchOptions=switchOptions||{};forEach.call(oldEl.childNodes,function(el){elsToRemove.push(el);if(el.classList&&!el.classList.contains(\"js-Pjax-remove\")){if(el.hasAttribute(\"data-pjax-classes\")){el.className=el.className.replace(el.getAttribute(\"data-pjax-classes\"),\"\");el.removeAttribute(\"data-pjax-classes\")}el.classList.add(\"js-Pjax-remove\");if(switchOptions.callbacks&&switchOptions.callbacks.removeElement){switchOptions.callbacks.removeElement(el)}if(switchOptions.classNames){el.className+=\" \"+switchOptions.classNames.remove+\" \"+(options.backward?switchOptions.classNames.backward:switchOptions.classNames.forward)}animatedElsNumber++;on(el,animationEventNames,sexyAnimationEnd,true)}});forEach.call(newEl.childNodes,function(el){if(el.classList){var addClasses=\"\";if(switchOptions.classNames){addClasses=\" js-Pjax-add \"+switchOptions.classNames.add+\" \"+(options.backward?switchOptions.classNames.forward:switchOptions.classNames.backward)}if(switchOptions.callbacks&&switchOptions.callbacks.addElement){switchOptions.callbacks.addElement(el)}el.className+=addClasses;el.setAttribute(\"data-pjax-classes\",addClasses);elsToAdd.push(el);fragToAppend.appendChild(el);animatedElsNumber++;on(el,animationEventNames,sexyAnimationEnd,true)}});oldEl.className=newEl.className;oldEl.appendChild(fragToAppend)}}},{\"./events/on\":3}],17:[function(require,module,exports){module.exports=function(){var counter=0;return function(){var id=\"pjax\"+(new Date).getTime()+\"_\"+counter;counter++;return id}}()},{}],18:[function(require,module,exports){module.exports=function(obj){if(null===obj||\"object\"!==typeof obj){return obj}var copy=obj.constructor();for(var attr in obj){if(obj.hasOwnProperty(attr)){copy[attr]=obj[attr]}}return copy}},{}],19:[function(require,module,exports){module.exports=function contains(doc,selectors,el){for(var i=0;i<selectors.length;i++){var selectedEls=doc.querySelectorAll(selectors[i]);for(var j=0;j<selectedEls.length;j++){if(selectedEls[j].contains(el)){return true}}}return false}},{}],20:[function(require,module,exports){module.exports=function(target){if(target==null){return null}var to=Object(target);for(var i=1;i<arguments.length;i++){var source=arguments[i];if(source!=null){for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){to[key]=source[key]}}}}return to}},{}],21:[function(require,module,exports){module.exports=function(){}},{}],22:[function(require,module,exports){module.exports=function(uri,key,value){var re=new RegExp(\"([?&])\"+key+\"=.*?(&|$)\",\"i\");var separator=uri.indexOf(\"?\")!==-1?\"&\":\"?\";if(uri.match(re)){return uri.replace(re,\"$1\"+key+\"=\"+value+\"$2\")}else{return uri+separator+key+\"=\"+value}}},{}]},{},[1])(1)});","date":"2021-10-30T06:38:12.628Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/pjax.min.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y7o001lnwlwc4oo8pcu","content":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){var foreachels=\"require(\"./lib/foreach-els\");var\" parseoptions=\"require(\"./lib/parse-options\");var\" switches=\"require(\"./lib/switches\");var\" newuid=\"require(\"./lib/uniqueid\");var\" on=\"require(\"./lib/events/on\");var\" trigger=\"require(\"./lib/events/trigger\");var\" clone=\"require(\"./lib/util/clone\");var\" contains=\"require(\"./lib/util/contains\");var\" extend=\"require(\"./lib/util/extend\");var\" noop=\"require(\"./lib/util/noop\");var\" pjax=\"function(options){this.state={numPendingSwitches:0,href:null,options:null};this.options=parseOptions(options);this.log(\"Pjax\" options\",this.options);if(this.options.scrollrestoration&&\"scrollrestoration\"in history){history.scrollrestoration=\"manual\" }this.maxuid=\"this.lastUid=newUid();this.parseDOM(document);on(window,\"popstate\",function(st){if(st.state){var\" opt=\"clone(this.options);opt.url=st.state.url;opt.title=st.state.title;opt.history=false;opt.scrollPos=st.state.scrollPos;if(st.state.uid<this.lastUid){opt.backward=true}else{opt.forward=true}this.lastUid=st.state.uid;this.loadUrl(st.state.url,opt)}}.bind(this))};Pjax.switches=switches;Pjax.prototype={log:require(\"./lib/proto/log\"),getElements:function(el){return\" el.queryselectorall(this.options.elements)},parsedom:function(el){var parseelement=\"require(\"./lib/proto/parse-element\");forEachEls(this.getElements(el),parseElement,this)},refresh:function(el){this.parseDOM(el||document)},reload:function(){window.location.reload()},attachLink:require(\"./lib/proto/attach-link\"),attachForm:require(\"./lib/proto/attach-form\"),forEachSelectors:function(cb,context,DOMcontext){return\" require(\". lib foreach-selectors\").bind(this)(this.options.selectors,cb,context,domcontext)},switchselectors:function(selectors,fromel,toel,options){return switches-selectors\").bind(this)(this.options.switches,this.options.switchesoptions,selectors,fromel,toel,options)},latestchance:function(href){window.location=\"href},onSwitch:function(){trigger(window,\"resize\" scroll\");this.state.numpendingswitches--;if(this.state.numpendingswitches=\"==0){this.afterAllSwitches()}},loadContent:function(html,options){if(typeof\" html!=\"=\"string\"){trigger(document,\"pjax:complete\" pjax:error\",options);return}var tmpel=\"document.implementation.createHTMLDocument(\"pjax\");var\" htmlregex=\"/<html[^\">]+>/gi;var htmlAttribsRegex=/\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;var matches=html.match(htmlRegex);if(matches&&matches.length){matches=matches[0].match(htmlAttribsRegex);if(matches.length){matches.shift();matches.forEach(function(htmlAttrib){var attr=htmlAttrib.trim().split(\"=\");if(attr.length===1){tmpEl.documentElement.setAttribute(attr[0],true)}else{tmpEl.documentElement.setAttribute(attr[0],attr[1].slice(1,-1))}})}}tmpEl.documentElement.innerHTML=html;this.log(\"load content\",tmpEl.documentElement.attributes,tmpEl.documentElement.innerHTML.length);if(document.activeElement&&contains(document,this.options.selectors,document.activeElement)){try{document.activeElement.blur()}catch(e){}}this.switchSelectors(this.options.selectors,tmpEl,document,options)},abortRequest:require(\"./lib/abort-request\"),doRequest:require(\"./lib/send-request\"),handleResponse:require(\"./lib/proto/handle-response\"),loadUrl:function(href,options){options=typeof options===\"object\"?extend({},this.options,options):clone(this.options);this.log(\"load href\",href,options);this.abortRequest(this.request);trigger(document,\"pjax:send\",options);this.request=this.doRequest(href,options,this.handleResponse.bind(this))},afterAllSwitches:function(){var autofocusEl=Array.prototype.slice.call(document.querySelectorAll(\"[autofocus]\")).pop();if(autofocusEl&&document.activeElement!==autofocusEl){autofocusEl.focus()}this.options.selectors.forEach(function(selector){forEachEls(document.querySelectorAll(selector),function(el){if(el===0);})});var state=this.state;if(state.options.history){if(!window.history.state){this.lastUid=this.maxUid=newUid();window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid,scrollPos:[0,0]},document.title)}this.lastUid=this.maxUid=newUid();window.history.pushState({url:state.href,title:state.options.title,uid:this.maxUid,scrollPos:[0,0]},state.options.title,state.href)}this.forEachSelectors(function(el){this.parseDOM(el)},this);trigger(document,\"pjax:complete pjax:success\",state.options);if(typeof state.options.analytics===\"function\"){state.options.analytics()}if(state.options.history){var a=document.createElement(\"a\");a.href=this.state.href;if(a.hash){var name=a.hash.slice(1);name=decodeURIComponent(name);var curtop=0;var target=document.getElementById(name)||document.getElementsByName(name)[0];if(target){if(target.offsetParent){do{curtop+=target.offsetTop;target=target.offsetParent}while(target)}}window.scrollTo(0,curtop)}else if(state.options.scrollTo!==false){if(state.options.scrollTo.length>1){window.scrollTo(state.options.scrollTo[0],state.options.scrollTo[1])}else{window.scrollTo(0,state.options.scrollTo)}}}else if(state.options.scrollRestoration&&state.options.scrollPos){window.scrollTo(state.options.scrollPos[0],state.options.scrollPos[1])}this.state={numPendingSwitches:0,href:null,options:null}}};Pjax.isSupported=require(\"./lib/is-supported\");if(Pjax.isSupported()){module.exports=Pjax}else{var stupidPjax=noop;for(var key in Pjax.prototype){if(Pjax.prototype.hasOwnProperty(key)&&typeof Pjax.prototype[key]===\"function\"){stupidPjax[key]=noop}}module.exports=stupidPjax}},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){var noop=require(\"./util/noop\");module.exports=function(request){if(request&&request.readyState<4){request.onreadystatechange=noop;request.abort()}}},{\". util noop\":21}],3:[function(require,module,exports){var foreachels=\"require(\"../foreach-els\");module.exports=function(els,events,listener,useCapture){events=typeof\" events=\"==\"string\"?events.split(\"\" \"):events;events.foreach(function(e){foreachels(els,function(el){el.addeventlistener(e,listener,usecapture)})})}},{\".. foreach-els\":5}],4:[function(require,module,exports){var \"):events;events.foreach(function(e){var event;event=\"document.createEvent(\"HTMLEvents\");event.initEvent(e,true,true);event.eventName=e;if(opts){Object.keys(opts).forEach(function(key){event[key]=opts[key]})}forEachEls(els,function(el){var\" domfix=\"false;if(!el.parentNode&&el!==document&&el!==window){domFix=true;document.body.appendChild(el)}el.dispatchEvent(event);if(domFix){el.parentNode.removeChild(el)}})})}},{\"../foreach-els\":5}],5:[function(require,module,exports){module.exports=function(els,fn,context){if(els\" instanceof htmlcollection||els nodelist||els array){return array.prototype.foreach.call(els,fn,context)}return fn.call(context,els)}},{}],6:[function(require,module,exports){var window.history&&window.history.pushstate&&window.history.replacestate&&!navigator.useragent.match( ((ipod|iphone|ipad).+\\bos\\s+[1-4]\\d|webapps\\ .+cfnetwork) )}},{}],8:[function(require,module,exports){var defaultswitches=\"require(\"./switches\");module.exports=function(options){options=options||{};options.elements=options.elements||\"a[href],\" form[action]\";options.selectors=\"options.selectors||[\"title\",\".js-Pjax\"];options.switches=options.switches||{};options.switchesOptions=options.switchesOptions||{};options.history=typeof\" options.history=\"==\"undefined\"?true:options.history;options.analytics=typeof\" options.analytics=\"==\"function\"||options.analytics===false?options.analytics:defaultAnalytics;options.scrollTo=typeof\" options.scrollto=\"==\"undefined\"?0:options.scrollTo;options.scrollRestoration=typeof\" options.scrollrestoration!=\"=\"undefined\"?options.scrollRestoration:true;options.cacheBust=typeof\" options.cachebust=\"==\"undefined\"?true:options.cacheBust;options.debug=options.debug||false;options.timeout=options.timeout||0;options.currentUrlFullReload=typeof\" options.currenturlfullreload=\"==\"undefined\"?false:options.currentUrlFullReload;if(!options.switches.head){options.switches.head=defaultSwitches.switchElementsAlt}if(!options.switches.body){options.switches.body=defaultSwitches.switchElementsAlt}return\" options};function defaultanalytics(){if(window._gaq){_gaq.push([\"_trackpageview\"])}if(window.ga){ga(\"send\",\"pageview\",{page:location.pathname,title:document.title})}}},{\". switches\":16}],9:[function(require,module,exports){var on=\"require(\"../events/on\");var\" clone=\"require(\"../util/clone\");var\" attrstate=\"data-pjax-state\" ;var formaction=\"function(el,event){if(isDefaultPrevented(event)){return}var\" options=\"clone(this.options);options.requestOptions={requestUrl:el.getAttribute(\"action\")||window.location.href,requestMethod:el.getAttribute(\"method\")||\"GET\"};var\" virtlinkelement=\"document.createElement(\"a\");virtLinkElement.setAttribute(\"href\",options.requestOptions.requestUrl);var\" attrvalue=\"checkIfShouldAbort(virtLinkElement,options);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(el.enctype===\"multipart/form-data\"){options.requestOptions.formData=new\" formdata(el)}else{options.requestoptions.requestparams=\"parseFormElements(el)}el.setAttribute(attrState,\"submit\");options.triggerElement=el;this.loadUrl(virtLinkElement.href,options)};function\" parseformelements(el){var requestparams=\"[];var\" formelements=\"el.elements;for(var\" i=\"0;i<formElements.length;i++){var\" element=\"formElements[i];var\" tagname=\"element.tagName.toLowerCase();if(!!element.name&&element.attributes!==undefined&&tagName!==\"button\"){var\" type=\"element.attributes.type;if(!type||type.value!==\"checkbox\"&&type.value!==\"radio\"||element.checked){var\" values=\"[];if(tagName===\"select\"){var\" opt;for(var j=\"0;j<element.options.length;j++){opt=element.options[j];if(opt.selected&&!opt.disabled){values.push(opt.hasAttribute(\"value\")?opt.value:opt.text)}}}else{values.push(element.value)}for(var\" k=\"0;k<values.length;k++){requestParams.push({name:encodeURIComponent(element.name),value:encodeURIComponent(values[k])})}}}}return\" requestparams}function checkifshouldabort(virtlinkelement,options){if(virtlinkelement.protocol!=\"=window.location.protocol||virtLinkElement.host!==window.location.host){return\"external\"}if(virtLinkElement.hash&&virtLinkElement.href.replace(virtLinkElement.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(virtLinkElement.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}if(options.currentUrlFullReload&&virtLinkElement.href===window.location.href.split(\"#\")[0]){return\"reload\"}}var\" isdefaultprevented=\"function(event){return\" event.defaultprevented||event.returnvalue=\"==false};module.exports=function(el){var\" that=\"this;el.setAttribute(attrState,\"\");on(el,\"submit\",function(event){formAction.call(that,el,event)})}},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){var\" linkaction=\"function(el,event){if(isDefaultPrevented(event)){return}var\" checkifshouldabort(el,event){if(event.which>1||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey){return\"modifier\"}if(el.protocol!==window.location.protocol||el.host!==window.location.host){return\"external\"}if(el.hash&&el.href.replace(el.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(el.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"click\",function(event){linkAction.call(that,el,event)});on(el,\"keyup\",function(event){if(event.keyCode===13){linkAction.call(that,el,event)}}.bind(this))}},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){var clone=require(\"../util/clone\");var newUid=require(\"../uniqueid\");var trigger=require(\"../events/trigger\");module.exports=function(responseText,request,href,options){options=clone(options||this.options);options.request=request;if(responseText===false){trigger(document,\"pjax:complete pjax:error\",options);return}var currentState=window.history.state||{};window.history.replaceState({url:currentState.url||window.location.href,title:currentState.title||document.title,uid:currentState.uid||newUid(),scrollPos:[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]},document.title,window.location.href);var oldHref=href;if(request.responseURL){if(href!==request.responseURL){href=request.responseURL}}else if(request.getResponseHeader(\"X-PJAX-URL\")){href=request.getResponseHeader(\"X-PJAX-URL\")}else if(request.getResponseHeader(\"X-XHR-Redirected-To\")){href=request.getResponseHeader(\"X-XHR-Redirected-To\")}var a=document.createElement(\"a\");a.href=oldHref;var oldHash=a.hash;a.href=href;if(oldHash&&!a.hash){a.hash=oldHash;href=a.href}this.state.href=href;this.state.options=options;try{this.loadContent(responseText,options)}catch(e){trigger(document,\"pjax:error\",options);if(!this.options.debug){if(console&&console.error){console.error(\"Pjax switch fail: \",e)}return this.latestChance(href)}else{throw e}}}},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){module.exports=function(){if(this.options.debug&&console){if(typeof console.log===\"function\"){console.log.apply(console,arguments)}else if(console.log){console.log(arguments)}}}},{}],13:[function(require,module,exports){var attrState=\"data-pjax-state\";module.exports=function(el){switch(el.tagName.toLowerCase()){case\"a\":if(!el.hasAttribute(attrState)){this.attachLink(el)}break;case\"form\":if(!el.hasAttribute(attrState)){this.attachForm(el)}break;default:throw\"Pjax can only be applied on <a> or <form> submit\"}}},{}],14:[function(require,module,exports){var updateQueryString=require(\"./util/update-query-string\");module.exports=function(location,options,callback){options=options||{};var queryString;var requestOptions=options.requestOptions||{};var requestMethod=(requestOptions.requestMethod||\"GET\").toUpperCase();var requestParams=requestOptions.requestParams||null;var formData=requestOptions.formData||null;var requestPayload=null;var request=new XMLHttpRequest;var timeout=options.timeout||0;request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){callback(request.responseText,request,location,options)}else if(request.status!==0){callback(null,request,location,options)}}};request.onerror=function(e){console.log(e);callback(null,request,location,options)};request.ontimeout=function(){callback(null,request,location,options)};if(requestParams&&requestParams.length){queryString=requestParams.map(function(param){return param.name+\"=\"+param.value}).join(\"&\");switch(requestMethod){case\"GET\":location=location.split(\"?\")[0];location+=\"?\"+queryString;break;case\"POST\":requestPayload=queryString;break}}else if(formData){requestPayload=formData}if(options.cacheBust){location=updateQueryString(location,\"t\",Date.now())}request.open(requestMethod,location,true);request.timeout=timeout;request.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");request.setRequestHeader(\"X-PJAX\",\"true\");request.setRequestHeader(\"X-PJAX-Selectors\",JSON.stringify(options.selectors));if(requestPayload&&requestMethod===\"POST\"&&!formData){request.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\")}request.send(requestPayload);return request}},{\"./util/update-query-string\":22}],15:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");var defaultSwitches=require(\"./switches\");module.exports=function(switches,switchesOptions,selectors,fromEl,toEl,options){var switchesQueue=[];selectors.forEach(function(selector){var newEls=fromEl.querySelectorAll(selector);var oldEls=toEl.querySelectorAll(selector);if(this.log){this.log(\"Pjax switch\",selector,newEls,oldEls)}if(newEls.length!==oldEls.length){throw\"DOM doesn’t look the same on new loaded page: ’\"+selector+\"’ - new \"+newEls.length+\", old \"+oldEls.length}forEachEls(newEls,function(newEl,i){var oldEl=oldEls[i];if(this.log){this.log(\"newEl\",newEl,\"oldEl\",oldEl)}var callback=switches[selector]?switches[selector].bind(this,oldEl,newEl,options,switchesOptions[selector]):defaultSwitches.outerHTML.bind(this,oldEl,newEl,options);switchesQueue.push(callback)},this)},this);this.state.numPendingSwitches=switchesQueue.length;switchesQueue.forEach(function(queuedSwitch){queuedSwitch()})}},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){var on=require(\"./events/on\");module.exports={outerHTML:function(oldEl,newEl){oldEl.outerHTML=newEl.outerHTML;this.onSwitch()},innerHTML:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.className===\"\"){oldEl.removeAttribute(\"class\")}else{}this.onSwitch()},switchElementsAlt:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.hasAttributes()){var attrs=newEl.attributes;for(var i=0;i</form></a></4){request.onreadystatechange=noop;request.abort()}}},{\".></t.length;i++)o(t[i]);return>","site":{"data":{}},"excerpt":"","more":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){var foreachels=\"require(\"./lib/foreach-els\");var\" parseoptions=\"require(\"./lib/parse-options\");var\" switches=\"require(\"./lib/switches\");var\" newuid=\"require(\"./lib/uniqueid\");var\" on=\"require(\"./lib/events/on\");var\" trigger=\"require(\"./lib/events/trigger\");var\" clone=\"require(\"./lib/util/clone\");var\" contains=\"require(\"./lib/util/contains\");var\" extend=\"require(\"./lib/util/extend\");var\" noop=\"require(\"./lib/util/noop\");var\" pjax=\"function(options){this.state={numPendingSwitches:0,href:null,options:null};this.options=parseOptions(options);this.log(\"Pjax\" options\",this.options);if(this.options.scrollrestoration&&\"scrollrestoration\"in history){history.scrollrestoration=\"manual\" }this.maxuid=\"this.lastUid=newUid();this.parseDOM(document);on(window,\"popstate\",function(st){if(st.state){var\" opt=\"clone(this.options);opt.url=st.state.url;opt.title=st.state.title;opt.history=false;opt.scrollPos=st.state.scrollPos;if(st.state.uid<this.lastUid){opt.backward=true}else{opt.forward=true}this.lastUid=st.state.uid;this.loadUrl(st.state.url,opt)}}.bind(this))};Pjax.switches=switches;Pjax.prototype={log:require(\"./lib/proto/log\"),getElements:function(el){return\" el.queryselectorall(this.options.elements)},parsedom:function(el){var parseelement=\"require(\"./lib/proto/parse-element\");forEachEls(this.getElements(el),parseElement,this)},refresh:function(el){this.parseDOM(el||document)},reload:function(){window.location.reload()},attachLink:require(\"./lib/proto/attach-link\"),attachForm:require(\"./lib/proto/attach-form\"),forEachSelectors:function(cb,context,DOMcontext){return\" require(\". lib foreach-selectors\").bind(this)(this.options.selectors,cb,context,domcontext)},switchselectors:function(selectors,fromel,toel,options){return switches-selectors\").bind(this)(this.options.switches,this.options.switchesoptions,selectors,fromel,toel,options)},latestchance:function(href){window.location=\"href},onSwitch:function(){trigger(window,\"resize\" scroll\");this.state.numpendingswitches--;if(this.state.numpendingswitches=\"==0){this.afterAllSwitches()}},loadContent:function(html,options){if(typeof\" html!=\"=\"string\"){trigger(document,\"pjax:complete\" pjax:error\",options);return}var tmpel=\"document.implementation.createHTMLDocument(\"pjax\");var\" htmlregex=\"/<html[^\">]+>/gi;var htmlAttribsRegex=/\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;var matches=html.match(htmlRegex);if(matches&&matches.length){matches=matches[0].match(htmlAttribsRegex);if(matches.length){matches.shift();matches.forEach(function(htmlAttrib){var attr=htmlAttrib.trim().split(\"=\");if(attr.length===1){tmpEl.documentElement.setAttribute(attr[0],true)}else{tmpEl.documentElement.setAttribute(attr[0],attr[1].slice(1,-1))}})}}tmpEl.documentElement.innerHTML=html;this.log(\"load content\",tmpEl.documentElement.attributes,tmpEl.documentElement.innerHTML.length);if(document.activeElement&&contains(document,this.options.selectors,document.activeElement)){try{document.activeElement.blur()}catch(e){}}this.switchSelectors(this.options.selectors,tmpEl,document,options)},abortRequest:require(\"./lib/abort-request\"),doRequest:require(\"./lib/send-request\"),handleResponse:require(\"./lib/proto/handle-response\"),loadUrl:function(href,options){options=typeof options===\"object\"?extend({},this.options,options):clone(this.options);this.log(\"load href\",href,options);this.abortRequest(this.request);trigger(document,\"pjax:send\",options);this.request=this.doRequest(href,options,this.handleResponse.bind(this))},afterAllSwitches:function(){var autofocusEl=Array.prototype.slice.call(document.querySelectorAll(\"[autofocus]\")).pop();if(autofocusEl&&document.activeElement!==autofocusEl){autofocusEl.focus()}this.options.selectors.forEach(function(selector){forEachEls(document.querySelectorAll(selector),function(el){if(el===0);})});var state=this.state;if(state.options.history){if(!window.history.state){this.lastUid=this.maxUid=newUid();window.history.replaceState({url:window.location.href,title:document.title,uid:this.maxUid,scrollPos:[0,0]},document.title)}this.lastUid=this.maxUid=newUid();window.history.pushState({url:state.href,title:state.options.title,uid:this.maxUid,scrollPos:[0,0]},state.options.title,state.href)}this.forEachSelectors(function(el){this.parseDOM(el)},this);trigger(document,\"pjax:complete pjax:success\",state.options);if(typeof state.options.analytics===\"function\"){state.options.analytics()}if(state.options.history){var a=document.createElement(\"a\");a.href=this.state.href;if(a.hash){var name=a.hash.slice(1);name=decodeURIComponent(name);var curtop=0;var target=document.getElementById(name)||document.getElementsByName(name)[0];if(target){if(target.offsetParent){do{curtop+=target.offsetTop;target=target.offsetParent}while(target)}}window.scrollTo(0,curtop)}else if(state.options.scrollTo!==false){if(state.options.scrollTo.length>1){window.scrollTo(state.options.scrollTo[0],state.options.scrollTo[1])}else{window.scrollTo(0,state.options.scrollTo)}}}else if(state.options.scrollRestoration&&state.options.scrollPos){window.scrollTo(state.options.scrollPos[0],state.options.scrollPos[1])}this.state={numPendingSwitches:0,href:null,options:null}}};Pjax.isSupported=require(\"./lib/is-supported\");if(Pjax.isSupported()){module.exports=Pjax}else{var stupidPjax=noop;for(var key in Pjax.prototype){if(Pjax.prototype.hasOwnProperty(key)&&typeof Pjax.prototype[key]===\"function\"){stupidPjax[key]=noop}}module.exports=stupidPjax}},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){var noop=require(\"./util/noop\");module.exports=function(request){if(request&&request.readyState<4){request.onreadystatechange=noop;request.abort()}}},{\". util noop\":21}],3:[function(require,module,exports){var foreachels=\"require(\"../foreach-els\");module.exports=function(els,events,listener,useCapture){events=typeof\" events=\"==\"string\"?events.split(\"\" \"):events;events.foreach(function(e){foreachels(els,function(el){el.addeventlistener(e,listener,usecapture)})})}},{\".. foreach-els\":5}],4:[function(require,module,exports){var \"):events;events.foreach(function(e){var event;event=\"document.createEvent(\"HTMLEvents\");event.initEvent(e,true,true);event.eventName=e;if(opts){Object.keys(opts).forEach(function(key){event[key]=opts[key]})}forEachEls(els,function(el){var\" domfix=\"false;if(!el.parentNode&&el!==document&&el!==window){domFix=true;document.body.appendChild(el)}el.dispatchEvent(event);if(domFix){el.parentNode.removeChild(el)}})})}},{\"../foreach-els\":5}],5:[function(require,module,exports){module.exports=function(els,fn,context){if(els\" instanceof htmlcollection||els nodelist||els array){return array.prototype.foreach.call(els,fn,context)}return fn.call(context,els)}},{}],6:[function(require,module,exports){var window.history&&window.history.pushstate&&window.history.replacestate&&!navigator.useragent.match( ((ipod|iphone|ipad).+\\bos\\s+[1-4]\\d|webapps\\ .+cfnetwork) )}},{}],8:[function(require,module,exports){var defaultswitches=\"require(\"./switches\");module.exports=function(options){options=options||{};options.elements=options.elements||\"a[href],\" form[action]\";options.selectors=\"options.selectors||[\"title\",\".js-Pjax\"];options.switches=options.switches||{};options.switchesOptions=options.switchesOptions||{};options.history=typeof\" options.history=\"==\"undefined\"?true:options.history;options.analytics=typeof\" options.analytics=\"==\"function\"||options.analytics===false?options.analytics:defaultAnalytics;options.scrollTo=typeof\" options.scrollto=\"==\"undefined\"?0:options.scrollTo;options.scrollRestoration=typeof\" options.scrollrestoration!=\"=\"undefined\"?options.scrollRestoration:true;options.cacheBust=typeof\" options.cachebust=\"==\"undefined\"?true:options.cacheBust;options.debug=options.debug||false;options.timeout=options.timeout||0;options.currentUrlFullReload=typeof\" options.currenturlfullreload=\"==\"undefined\"?false:options.currentUrlFullReload;if(!options.switches.head){options.switches.head=defaultSwitches.switchElementsAlt}if(!options.switches.body){options.switches.body=defaultSwitches.switchElementsAlt}return\" options};function defaultanalytics(){if(window._gaq){_gaq.push([\"_trackpageview\"])}if(window.ga){ga(\"send\",\"pageview\",{page:location.pathname,title:document.title})}}},{\". switches\":16}],9:[function(require,module,exports){var on=\"require(\"../events/on\");var\" clone=\"require(\"../util/clone\");var\" attrstate=\"data-pjax-state\" ;var formaction=\"function(el,event){if(isDefaultPrevented(event)){return}var\" options=\"clone(this.options);options.requestOptions={requestUrl:el.getAttribute(\"action\")||window.location.href,requestMethod:el.getAttribute(\"method\")||\"GET\"};var\" virtlinkelement=\"document.createElement(\"a\");virtLinkElement.setAttribute(\"href\",options.requestOptions.requestUrl);var\" attrvalue=\"checkIfShouldAbort(virtLinkElement,options);if(attrValue){el.setAttribute(attrState,attrValue);return}event.preventDefault();if(el.enctype===\"multipart/form-data\"){options.requestOptions.formData=new\" formdata(el)}else{options.requestoptions.requestparams=\"parseFormElements(el)}el.setAttribute(attrState,\"submit\");options.triggerElement=el;this.loadUrl(virtLinkElement.href,options)};function\" parseformelements(el){var requestparams=\"[];var\" formelements=\"el.elements;for(var\" i=\"0;i<formElements.length;i++){var\" element=\"formElements[i];var\" tagname=\"element.tagName.toLowerCase();if(!!element.name&&element.attributes!==undefined&&tagName!==\"button\"){var\" type=\"element.attributes.type;if(!type||type.value!==\"checkbox\"&&type.value!==\"radio\"||element.checked){var\" values=\"[];if(tagName===\"select\"){var\" opt;for(var j=\"0;j<element.options.length;j++){opt=element.options[j];if(opt.selected&&!opt.disabled){values.push(opt.hasAttribute(\"value\")?opt.value:opt.text)}}}else{values.push(element.value)}for(var\" k=\"0;k<values.length;k++){requestParams.push({name:encodeURIComponent(element.name),value:encodeURIComponent(values[k])})}}}}return\" requestparams}function checkifshouldabort(virtlinkelement,options){if(virtlinkelement.protocol!=\"=window.location.protocol||virtLinkElement.host!==window.location.host){return\"external\"}if(virtLinkElement.hash&&virtLinkElement.href.replace(virtLinkElement.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(virtLinkElement.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}if(options.currentUrlFullReload&&virtLinkElement.href===window.location.href.split(\"#\")[0]){return\"reload\"}}var\" isdefaultprevented=\"function(event){return\" event.defaultprevented||event.returnvalue=\"==false};module.exports=function(el){var\" that=\"this;el.setAttribute(attrState,\"\");on(el,\"submit\",function(event){formAction.call(that,el,event)})}},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){var\" linkaction=\"function(el,event){if(isDefaultPrevented(event)){return}var\" checkifshouldabort(el,event){if(event.which>1||event.metaKey||event.ctrlKey||event.shiftKey||event.altKey){return\"modifier\"}if(el.protocol!==window.location.protocol||el.host!==window.location.host){return\"external\"}if(el.hash&&el.href.replace(el.hash,\"\")===window.location.href.replace(location.hash,\"\")){return\"anchor\"}if(el.href===window.location.href.split(\"#\")[0]+\"#\"){return\"anchor-empty\"}}var isDefaultPrevented=function(event){return event.defaultPrevented||event.returnValue===false};module.exports=function(el){var that=this;el.setAttribute(attrState,\"\");on(el,\"click\",function(event){linkAction.call(that,el,event)});on(el,\"keyup\",function(event){if(event.keyCode===13){linkAction.call(that,el,event)}}.bind(this))}},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){var clone=require(\"../util/clone\");var newUid=require(\"../uniqueid\");var trigger=require(\"../events/trigger\");module.exports=function(responseText,request,href,options){options=clone(options||this.options);options.request=request;if(responseText===false){trigger(document,\"pjax:complete pjax:error\",options);return}var currentState=window.history.state||{};window.history.replaceState({url:currentState.url||window.location.href,title:currentState.title||document.title,uid:currentState.uid||newUid(),scrollPos:[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]},document.title,window.location.href);var oldHref=href;if(request.responseURL){if(href!==request.responseURL){href=request.responseURL}}else if(request.getResponseHeader(\"X-PJAX-URL\")){href=request.getResponseHeader(\"X-PJAX-URL\")}else if(request.getResponseHeader(\"X-XHR-Redirected-To\")){href=request.getResponseHeader(\"X-XHR-Redirected-To\")}var a=document.createElement(\"a\");a.href=oldHref;var oldHash=a.hash;a.href=href;if(oldHash&&!a.hash){a.hash=oldHash;href=a.href}this.state.href=href;this.state.options=options;try{this.loadContent(responseText,options)}catch(e){trigger(document,\"pjax:error\",options);if(!this.options.debug){if(console&&console.error){console.error(\"Pjax switch fail: \",e)}return this.latestChance(href)}else{throw e}}}},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){module.exports=function(){if(this.options.debug&&console){if(typeof console.log===\"function\"){console.log.apply(console,arguments)}else if(console.log){console.log(arguments)}}}},{}],13:[function(require,module,exports){var attrState=\"data-pjax-state\";module.exports=function(el){switch(el.tagName.toLowerCase()){case\"a\":if(!el.hasAttribute(attrState)){this.attachLink(el)}break;case\"form\":if(!el.hasAttribute(attrState)){this.attachForm(el)}break;default:throw\"Pjax can only be applied on <a> or <form> submit\"}}},{}],14:[function(require,module,exports){var updateQueryString=require(\"./util/update-query-string\");module.exports=function(location,options,callback){options=options||{};var queryString;var requestOptions=options.requestOptions||{};var requestMethod=(requestOptions.requestMethod||\"GET\").toUpperCase();var requestParams=requestOptions.requestParams||null;var formData=requestOptions.formData||null;var requestPayload=null;var request=new XMLHttpRequest;var timeout=options.timeout||0;request.onreadystatechange=function(){if(request.readyState===4){if(request.status===200){callback(request.responseText,request,location,options)}else if(request.status!==0){callback(null,request,location,options)}}};request.onerror=function(e){console.log(e);callback(null,request,location,options)};request.ontimeout=function(){callback(null,request,location,options)};if(requestParams&&requestParams.length){queryString=requestParams.map(function(param){return param.name+\"=\"+param.value}).join(\"&\");switch(requestMethod){case\"GET\":location=location.split(\"?\")[0];location+=\"?\"+queryString;break;case\"POST\":requestPayload=queryString;break}}else if(formData){requestPayload=formData}if(options.cacheBust){location=updateQueryString(location,\"t\",Date.now())}request.open(requestMethod,location,true);request.timeout=timeout;request.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\");request.setRequestHeader(\"X-PJAX\",\"true\");request.setRequestHeader(\"X-PJAX-Selectors\",JSON.stringify(options.selectors));if(requestPayload&&requestMethod===\"POST\"&&!formData){request.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\")}request.send(requestPayload);return request}},{\"./util/update-query-string\":22}],15:[function(require,module,exports){var forEachEls=require(\"./foreach-els\");var defaultSwitches=require(\"./switches\");module.exports=function(switches,switchesOptions,selectors,fromEl,toEl,options){var switchesQueue=[];selectors.forEach(function(selector){var newEls=fromEl.querySelectorAll(selector);var oldEls=toEl.querySelectorAll(selector);if(this.log){this.log(\"Pjax switch\",selector,newEls,oldEls)}if(newEls.length!==oldEls.length){throw\"DOM doesn’t look the same on new loaded page: ’\"+selector+\"’ - new \"+newEls.length+\", old \"+oldEls.length}forEachEls(newEls,function(newEl,i){var oldEl=oldEls[i];if(this.log){this.log(\"newEl\",newEl,\"oldEl\",oldEl)}var callback=switches[selector]?switches[selector].bind(this,oldEl,newEl,options,switchesOptions[selector]):defaultSwitches.outerHTML.bind(this,oldEl,newEl,options);switchesQueue.push(callback)},this)},this);this.state.numPendingSwitches=switchesQueue.length;switchesQueue.forEach(function(queuedSwitch){queuedSwitch()})}},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){var on=require(\"./events/on\");module.exports={outerHTML:function(oldEl,newEl){oldEl.outerHTML=newEl.outerHTML;this.onSwitch()},innerHTML:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.className===\"\"){oldEl.removeAttribute(\"class\")}else{}this.onSwitch()},switchElementsAlt:function(oldEl,newEl){oldEl.innerHTML=newEl.innerHTML;if(newEl.hasAttributes()){var attrs=newEl.attributes;for(var i=0;i</form></a></4){request.onreadystatechange=noop;request.abort()}}},{\".></t.length;i++)o(t[i]);return>"},{"_content":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n\n},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){\nvar noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n\n},{\"./util/noop\":21}],3:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],4:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],5:[function(require,module,exports){\n/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n\n},{}],6:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n\n},{\"./foreach-els\":5}],7:[function(require,module,exports){\nmodule.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n\n},{}],8:[function(require,module,exports){\n/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n\n},{\"./switches\":16}],9:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){\nvar clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n\n},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){\nmodule.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n\n},{}],13:[function(require,module,exports){\nvar attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n\n},{}],14:[function(require,module,exports){\nvar updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n\n},{\"./util/update-query-string\":22}],15:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n\n},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){\nvar on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and <body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber <= 0 && elsToRemove) {\n        elsToRemove.forEach(function(el) {\n          // browsing quickly can make the el\n          // already removed by last page update ?\n          if (el.parentNode) {\n            el.parentNode.removeChild(el);\n          }\n        });\n\n        elsToAdd.forEach(function(el) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        });\n\n        elsToAdd = null; // free memory\n        elsToRemove = null; // free memory\n\n        // this is to trigger some repaint (example: picturefill)\n        this.onSwitch();\n      }\n    }.bind(this);\n\n    switchOptions = switchOptions || {};\n\n    forEach.call(oldEl.childNodes, function(el) {\n      elsToRemove.push(el);\n      if (el.classList && !el.classList.contains(\"js-Pjax-remove\")) {\n        // for fast switch, clean element that just have been added, & not cleaned yet.\n        if (el.hasAttribute(\"data-pjax-classes\")) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        }\n        el.classList.add(\"js-Pjax-remove\");\n        if (switchOptions.callbacks && switchOptions.callbacks.removeElement) {\n          switchOptions.callbacks.removeElement(el);\n        }\n        if (switchOptions.classNames) {\n          el.className +=\n            \" \" +\n            switchOptions.classNames.remove +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.backward\n              : switchOptions.classNames.forward);\n        }\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    forEach.call(newEl.childNodes, function(el) {\n      if (el.classList) {\n        var addClasses = \"\";\n        if (switchOptions.classNames) {\n          addClasses =\n            \" js-Pjax-add \" +\n            switchOptions.classNames.add +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.forward\n              : switchOptions.classNames.backward);\n        }\n        if (switchOptions.callbacks && switchOptions.callbacks.addElement) {\n          switchOptions.callbacks.addElement(el);\n        }\n        el.className += addClasses;\n        el.setAttribute(\"data-pjax-classes\", addClasses);\n        elsToAdd.push(el);\n        fragToAppend.appendChild(el);\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    // pass all className of the parent\n    oldEl.className = newEl.className;\n    oldEl.appendChild(fragToAppend);\n  }\n};\n\n},{\"./events/on\":3}],17:[function(require,module,exports){\nmodule.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n\n},{}],18:[function(require,module,exports){\nmodule.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n\n},{}],19:[function(require,module,exports){\nmodule.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\n},{}],20:[function(require,module,exports){\nmodule.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n\n},{}],21:[function(require,module,exports){\nmodule.exports = function() {};\n\n},{}],22:[function(require,module,exports){\nmodule.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n\n},{}]},{},[1])(1)\n});\n","source":"lib/pjax/pjax.js","raw":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n// var executeScripts = require(\"./lib/execute-scripts\");  // unused-var\nvar forEachEls = require(\"./lib/foreach-els\");\nvar parseOptions = require(\"./lib/parse-options\");\nvar switches = require(\"./lib/switches\");\nvar newUid = require(\"./lib/uniqueid\");\n\nvar on = require(\"./lib/events/on\");\nvar trigger = require(\"./lib/events/trigger\");\n\nvar clone = require(\"./lib/util/clone\");\nvar contains = require(\"./lib/util/contains\");\nvar extend = require(\"./lib/util/extend\");\nvar noop = require(\"./lib/util/noop\");\n\nvar Pjax = function(options) {\n  this.state = {\n    numPendingSwitches: 0,\n    href: null,\n    options: null\n  };\n\n  this.options = parseOptions(options);\n  this.log(\"Pjax options\", this.options);\n\n  if (this.options.scrollRestoration && \"scrollRestoration\" in history) {\n    history.scrollRestoration = \"manual\";\n  }\n\n  this.maxUid = this.lastUid = newUid();\n\n  this.parseDOM(document);\n\n  on(\n    window,\n    \"popstate\",\n    function(st) {\n      if (st.state) {\n        var opt = clone(this.options);\n        opt.url = st.state.url;\n        opt.title = st.state.title;\n        // Since state already exists, prevent it from being pushed again\n        opt.history = false;\n        opt.scrollPos = st.state.scrollPos;\n        if (st.state.uid < this.lastUid) {\n          opt.backward = true;\n        } else {\n          opt.forward = true;\n        }\n        this.lastUid = st.state.uid;\n\n        // @todo implement history cache here, based on uid\n        this.loadUrl(st.state.url, opt);\n      }\n    }.bind(this)\n  );\n};\n\nPjax.switches = switches;\n\nPjax.prototype = {\n  log: require(\"./lib/proto/log\"),\n\n  getElements: function(el) {\n    return el.querySelectorAll(this.options.elements);\n  },\n\n  parseDOM: function(el) {\n    var parseElement = require(\"./lib/proto/parse-element\");\n    forEachEls(this.getElements(el), parseElement, this);\n  },\n\n  refresh: function(el) {\n    this.parseDOM(el || document);\n  },\n\n  reload: function() {\n    window.location.reload();\n  },\n\n  attachLink: require(\"./lib/proto/attach-link\"),\n\n  attachForm: require(\"./lib/proto/attach-form\"),\n\n  forEachSelectors: function(cb, context, DOMcontext) {\n    return require(\"./lib/foreach-selectors\").bind(this)(\n      this.options.selectors,\n      cb,\n      context,\n      DOMcontext\n    );\n  },\n\n  switchSelectors: function(selectors, fromEl, toEl, options) {\n    return require(\"./lib/switches-selectors\").bind(this)(\n      this.options.switches,\n      this.options.switchesOptions,\n      selectors,\n      fromEl,\n      toEl,\n      options\n    );\n  },\n\n  latestChance: function(href) {\n    window.location = href;\n  },\n\n  onSwitch: function() {\n    trigger(window, \"resize scroll\");\n\n    this.state.numPendingSwitches--;\n\n    // debounce calls, so we only run this once after all switches are finished.\n    if (this.state.numPendingSwitches === 0) {\n      this.afterAllSwitches();\n    }\n  },\n\n  loadContent: function(html, options) {\n    if (typeof html !== \"string\") {\n      trigger(document, \"pjax:complete pjax:error\", options);\n\n      return;\n    }\n\n    var tmpEl = document.implementation.createHTMLDocument(\"pjax\");\n\n    // parse HTML attributes to copy them\n    // since we are forced to use documentElement.innerHTML (outerHTML can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n\n},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){\nvar noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n\n},{\"./util/noop\":21}],3:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],4:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],5:[function(require,module,exports){\n/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n\n},{}],6:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n\n},{\"./foreach-els\":5}],7:[function(require,module,exports){\nmodule.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n\n},{}],8:[function(require,module,exports){\n/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n\n},{\"./switches\":16}],9:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){\nvar clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n\n},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){\nmodule.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n\n},{}],13:[function(require,module,exports){\nvar attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n\n},{}],14:[function(require,module,exports){\nvar updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n\n},{\"./util/update-query-string\":22}],15:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n\n},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){\nvar on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and <body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber <= 0 && elsToRemove) {\n        elsToRemove.forEach(function(el) {\n          // browsing quickly can make the el\n          // already removed by last page update ?\n          if (el.parentNode) {\n            el.parentNode.removeChild(el);\n          }\n        });\n\n        elsToAdd.forEach(function(el) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        });\n\n        elsToAdd = null; // free memory\n        elsToRemove = null; // free memory\n\n        // this is to trigger some repaint (example: picturefill)\n        this.onSwitch();\n      }\n    }.bind(this);\n\n    switchOptions = switchOptions || {};\n\n    forEach.call(oldEl.childNodes, function(el) {\n      elsToRemove.push(el);\n      if (el.classList && !el.classList.contains(\"js-Pjax-remove\")) {\n        // for fast switch, clean element that just have been added, & not cleaned yet.\n        if (el.hasAttribute(\"data-pjax-classes\")) {\n          el.className = el.className.replace(\n            el.getAttribute(\"data-pjax-classes\"),\n            \"\"\n          );\n          el.removeAttribute(\"data-pjax-classes\");\n        }\n        el.classList.add(\"js-Pjax-remove\");\n        if (switchOptions.callbacks && switchOptions.callbacks.removeElement) {\n          switchOptions.callbacks.removeElement(el);\n        }\n        if (switchOptions.classNames) {\n          el.className +=\n            \" \" +\n            switchOptions.classNames.remove +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.backward\n              : switchOptions.classNames.forward);\n        }\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    forEach.call(newEl.childNodes, function(el) {\n      if (el.classList) {\n        var addClasses = \"\";\n        if (switchOptions.classNames) {\n          addClasses =\n            \" js-Pjax-add \" +\n            switchOptions.classNames.add +\n            \" \" +\n            (options.backward\n              ? switchOptions.classNames.forward\n              : switchOptions.classNames.backward);\n        }\n        if (switchOptions.callbacks && switchOptions.callbacks.addElement) {\n          switchOptions.callbacks.addElement(el);\n        }\n        el.className += addClasses;\n        el.setAttribute(\"data-pjax-classes\", addClasses);\n        elsToAdd.push(el);\n        fragToAppend.appendChild(el);\n        animatedElsNumber++;\n        on(el, animationEventNames, sexyAnimationEnd, true);\n      }\n    });\n\n    // pass all className of the parent\n    oldEl.className = newEl.className;\n    oldEl.appendChild(fragToAppend);\n  }\n};\n\n},{\"./events/on\":3}],17:[function(require,module,exports){\nmodule.exports = (function() {\n  var counter = 0;\n  return function() {\n    var id = \"pjax\" + new Date().getTime() + \"_\" + counter;\n    counter++;\n    return id;\n  };\n})();\n\n},{}],18:[function(require,module,exports){\nmodule.exports = function(obj) {\n  /* istanbul ignore if */\n  if (null === obj || \"object\" !== typeof obj) {\n    return obj;\n  }\n  var copy = obj.constructor();\n  for (var attr in obj) {\n    if (obj.hasOwnProperty(attr)) {\n      copy[attr] = obj[attr];\n    }\n  }\n  return copy;\n};\n\n},{}],19:[function(require,module,exports){\nmodule.exports = function contains(doc, selectors, el) {\n  for (var i = 0; i < selectors.length; i++) {\n    var selectedEls = doc.querySelectorAll(selectors[i]);\n    for (var j = 0; j < selectedEls.length; j++) {\n      if (selectedEls[j].contains(el)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n};\n\n},{}],20:[function(require,module,exports){\nmodule.exports = function(target) {\n  if (target == null) {\n    return null;\n  }\n\n  var to = Object(target);\n\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    if (source != null) {\n      for (var key in source) {\n        // Avoid bugs when hasOwnProperty is shadowed\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          to[key] = source[key];\n        }\n      }\n    }\n  }\n  return to;\n};\n\n},{}],21:[function(require,module,exports){\nmodule.exports = function() {};\n\n},{}],22:[function(require,module,exports){\nmodule.exports = function(uri, key, value) {\n  var re = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\n  var separator = uri.indexOf(\"?\") !== -1 ? \"&\" : \"?\";\n  if (uri.match(re)) {\n    return uri.replace(re, \"$1\" + key + \"=\" + value + \"$2\");\n  } else {\n    return uri + separator + key + \"=\" + value;\n  }\n};\n\n},{}]},{},[1])(1)\n});\n","date":"2021-10-30T06:38:12.626Z","updated":"2019-11-19T11:33:15.000Z","path":"lib/pjax/pjax.js","layout":"false","title":"","comments":1,"_id":"ckvgn6y81001mnwlw14v7dni4","content":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){ var executescripts=\"require(\"./lib/execute-scripts\");\" unused-var foreachels=\"require(\"./lib/foreach-els\");\" parseoptions=\"require(\"./lib/parse-options\");\" switches=\"require(\"./lib/switches\");\" newuid=\"require(\"./lib/uniqueid\");\" on=\"require(\"./lib/events/on\");\" trigger=\"require(\"./lib/events/trigger\");\" clone=\"require(\"./lib/util/clone\");\" contains=\"require(\"./lib/util/contains\");\" extend=\"require(\"./lib/util/extend\");\" noop=\"require(\"./lib/util/noop\");\" pjax=\"function(options)\" { this.state=\"{\" numpendingswitches: 0, href: null, options: null }; this.options=\"parseOptions(options);\" this.log(\"pjax options\", this.options); if (this.options.scrollrestoration && \"scrollrestoration\" in history) history.scrollrestoration=\"manual\" ; } this.maxuid=\"this.lastUid\" = newuid(); this.parsedom(document); on( window, \"popstate\", function(st) (st.state) opt=\"clone(this.options);\" opt.url=\"st.state.url;\" opt.title=\"st.state.title;\" since state already exists, prevent it from being pushed again opt.history=\"false;\" opt.scrollpos=\"st.state.scrollPos;\" (st.state.uid < this.lastuid) opt.backward=\"true;\" else opt.forward=\"true;\" this.lastuid=\"st.state.uid;\" @todo implement history cache here, based uid this.loadurl(st.state.url, opt); }.bind(this) ); pjax.switches=\"switches;\" pjax.prototype=\"{\" log: require(\". lib proto log\"), getelements: function(el) return el.queryselectorall(this.options.elements); }, parsedom: parseelement=\"require(\"./lib/proto/parse-element\");\" foreachels(this.getelements(el), parseelement, this); refresh: this.parsedom(el || document); reload: function() window.location.reload(); attachlink: attach-link\"), attachform: attach-form\"), foreachselectors: function(cb, context, domcontext) foreach-selectors\").bind(this)( this.options.selectors, cb, domcontext switchselectors: function(selectors, fromel, toel, options) switches-selectors\").bind(this)( this.options.switches, this.options.switchesoptions, selectors, options latestchance: function(href) window.location=\"href;\" onswitch: trigger(window, \"resize scroll\"); this.state.numpendingswitches--; debounce calls, so we only run this once after all are finished. (this.state.numpendingswitches=\"==\" 0) this.afterallswitches(); loadcontent: function(html, (typeof html !=\"=\" \"string\") trigger(document, \"pjax:complete pjax:error\", options); return; tmpel=\"document.implementation.createHTMLDocument(\"pjax\");\" parse attributes to copy them forced use documentelement.innerhtml (outerhtml can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n\n},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){\nvar noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n\n},{\"./util/noop\":21}],3:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],4:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],5:[function(require,module,exports){\n/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n\n},{}],6:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n\n},{\"./foreach-els\":5}],7:[function(require,module,exports){\nmodule.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n\n},{}],8:[function(require,module,exports){\n/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n\n},{\"./switches\":16}],9:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){\nvar clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n\n},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){\nmodule.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n\n},{}],13:[function(require,module,exports){\nvar attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n\n},{}],14:[function(require,module,exports){\nvar updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n\n},{\"./util/update-query-string\":22}],15:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n\n},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){\nvar on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and </head><body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber </body></form></a></html[^></t.length;i++)o(t[i]);return>","site":{"data":{}},"excerpt":"","more":"(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Pjax = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){ var executescripts=\"require(\"./lib/execute-scripts\");\" unused-var foreachels=\"require(\"./lib/foreach-els\");\" parseoptions=\"require(\"./lib/parse-options\");\" switches=\"require(\"./lib/switches\");\" newuid=\"require(\"./lib/uniqueid\");\" on=\"require(\"./lib/events/on\");\" trigger=\"require(\"./lib/events/trigger\");\" clone=\"require(\"./lib/util/clone\");\" contains=\"require(\"./lib/util/contains\");\" extend=\"require(\"./lib/util/extend\");\" noop=\"require(\"./lib/util/noop\");\" pjax=\"function(options)\" { this.state=\"{\" numpendingswitches: 0, href: null, options: null }; this.options=\"parseOptions(options);\" this.log(\"pjax options\", this.options); if (this.options.scrollrestoration && \"scrollrestoration\" in history) history.scrollrestoration=\"manual\" ; } this.maxuid=\"this.lastUid\" = newuid(); this.parsedom(document); on( window, \"popstate\", function(st) (st.state) opt=\"clone(this.options);\" opt.url=\"st.state.url;\" opt.title=\"st.state.title;\" since state already exists, prevent it from being pushed again opt.history=\"false;\" opt.scrollpos=\"st.state.scrollPos;\" (st.state.uid < this.lastuid) opt.backward=\"true;\" else opt.forward=\"true;\" this.lastuid=\"st.state.uid;\" @todo implement history cache here, based uid this.loadurl(st.state.url, opt); }.bind(this) ); pjax.switches=\"switches;\" pjax.prototype=\"{\" log: require(\". lib proto log\"), getelements: function(el) return el.queryselectorall(this.options.elements); }, parsedom: parseelement=\"require(\"./lib/proto/parse-element\");\" foreachels(this.getelements(el), parseelement, this); refresh: this.parsedom(el || document); reload: function() window.location.reload(); attachlink: attach-link\"), attachform: attach-form\"), foreachselectors: function(cb, context, domcontext) foreach-selectors\").bind(this)( this.options.selectors, cb, domcontext switchselectors: function(selectors, fromel, toel, options) switches-selectors\").bind(this)( this.options.switches, this.options.switchesoptions, selectors, options latestchance: function(href) window.location=\"href;\" onswitch: trigger(window, \"resize scroll\"); this.state.numpendingswitches--; debounce calls, so we only run this once after all are finished. (this.state.numpendingswitches=\"==\" 0) this.afterallswitches(); loadcontent: function(html, (typeof html !=\"=\" \"string\") trigger(document, \"pjax:complete pjax:error\", options); return; tmpel=\"document.implementation.createHTMLDocument(\"pjax\");\" parse attributes to copy them forced use documentelement.innerhtml (outerhtml can't be used for <html>)\n    var htmlRegex = /<html[^>]+>/gi;\n    var htmlAttribsRegex = /\\s?[a-z:]+(?:=['\"][^'\">]+['\"])*/gi;\n    var matches = html.match(htmlRegex);\n    if (matches && matches.length) {\n      matches = matches[0].match(htmlAttribsRegex);\n      if (matches.length) {\n        matches.shift();\n        matches.forEach(function(htmlAttrib) {\n          var attr = htmlAttrib.trim().split(\"=\");\n          if (attr.length === 1) {\n            tmpEl.documentElement.setAttribute(attr[0], true);\n          } else {\n            tmpEl.documentElement.setAttribute(attr[0], attr[1].slice(1, -1));\n          }\n        });\n      }\n    }\n\n    tmpEl.documentElement.innerHTML = html;\n    this.log(\n      \"load content\",\n      tmpEl.documentElement.attributes,\n      tmpEl.documentElement.innerHTML.length\n    );\n\n    // Clear out any focused controls before inserting new page contents.\n    if (\n      document.activeElement &&\n      contains(document, this.options.selectors, document.activeElement)\n    ) {\n      try {\n        document.activeElement.blur();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    this.switchSelectors(this.options.selectors, tmpEl, document, options);\n  },\n\n  abortRequest: require(\"./lib/abort-request\"),\n\n  doRequest: require(\"./lib/send-request\"),\n\n  handleResponse: require(\"./lib/proto/handle-response\"),\n\n  loadUrl: function(href, options) {\n    options =\n      typeof options === \"object\"\n        ? extend({}, this.options, options)\n        : clone(this.options);\n\n    this.log(\"load href\", href, options);\n\n    // Abort any previous request\n    this.abortRequest(this.request);\n\n    trigger(document, \"pjax:send\", options);\n\n    // Do the request\n    this.request = this.doRequest(\n      href,\n      options,\n      this.handleResponse.bind(this)\n    );\n  },\n\n  afterAllSwitches: function() {\n    // FF bug: Won’t autofocus fields that are inserted via JS.\n    // This behavior is incorrect. So if theres no current focus, autofocus\n    // the last field.\n    //\n    // http://www.w3.org/html/wg/drafts/html/master/forms.html\n    var autofocusEl = Array.prototype.slice\n      .call(document.querySelectorAll(\"[autofocus]\"))\n      .pop();\n    if (autofocusEl && document.activeElement !== autofocusEl) {\n      autofocusEl.focus();\n    }\n\n    // execute scripts when DOM have been completely updated\n    this.options.selectors.forEach(function(selector) {\n      forEachEls(document.querySelectorAll(selector), function(el) {\n        // executeScripts(el);\n        if (el === 0) ;  // intentially left blank!\n      });\n    });\n\n    var state = this.state;\n\n    if (state.options.history) {\n      if (!window.history.state) {\n        this.lastUid = this.maxUid = newUid();\n        window.history.replaceState(\n          {\n            url: window.location.href,\n            title: document.title,\n            uid: this.maxUid,\n            scrollPos: [0, 0]\n          },\n          document.title\n        );\n      }\n\n      // Update browser history\n      this.lastUid = this.maxUid = newUid();\n\n      window.history.pushState(\n        {\n          url: state.href,\n          title: state.options.title,\n          uid: this.maxUid,\n          scrollPos: [0, 0]\n        },\n        state.options.title,\n        state.href\n      );\n    }\n\n    this.forEachSelectors(function(el) {\n      this.parseDOM(el);\n    }, this);\n\n    // Fire Events\n    trigger(document, \"pjax:complete pjax:success\", state.options);\n\n    if (typeof state.options.analytics === \"function\") {\n      state.options.analytics();\n    }\n\n    if (state.options.history) {\n      // First parse url and check for hash to override scroll\n      var a = document.createElement(\"a\");\n      a.href = this.state.href;\n      if (a.hash) {\n        var name = a.hash.slice(1);\n        name = decodeURIComponent(name);\n\n        var curtop = 0;\n        var target =\n          document.getElementById(name) || document.getElementsByName(name)[0];\n        if (target) {\n          // http://stackoverflow.com/questions/8111094/cross-browser-javascript-function-to-find-actual-position-of-an-element-in-page\n          if (target.offsetParent) {\n            do {\n              curtop += target.offsetTop;\n\n              target = target.offsetParent;\n            } while (target);\n          }\n        }\n        window.scrollTo(0, curtop);\n      } else if (state.options.scrollTo !== false) {\n        // Scroll page to top on new page load\n        if (state.options.scrollTo.length > 1) {\n          window.scrollTo(state.options.scrollTo[0], state.options.scrollTo[1]);\n        } else {\n          window.scrollTo(0, state.options.scrollTo);\n        }\n      }\n    } else if (state.options.scrollRestoration && state.options.scrollPos) {\n      window.scrollTo(state.options.scrollPos[0], state.options.scrollPos[1]);\n    }\n\n    this.state = {\n      numPendingSwitches: 0,\n      href: null,\n      options: null\n    };\n  }\n};\n\nPjax.isSupported = require(\"./lib/is-supported\");\n\n// arguably could do `if( require(\"./lib/is-supported\")()) {` but that might be a little to simple\nif (Pjax.isSupported()) {\n  module.exports = Pjax;\n}\n// if there isn’t required browser functions, returning stupid api\nelse {\n  var stupidPjax = noop;\n  for (var key in Pjax.prototype) {\n    if (\n      Pjax.prototype.hasOwnProperty(key) &&\n      typeof Pjax.prototype[key] === \"function\"\n    ) {\n      stupidPjax[key] = noop;\n    }\n  }\n\n  module.exports = stupidPjax;\n}\n\n},{\"./lib/abort-request\":2,\"./lib/events/on\":3,\"./lib/events/trigger\":4,\"./lib/foreach-els\":5,\"./lib/foreach-selectors\":6,\"./lib/is-supported\":7,\"./lib/parse-options\":8,\"./lib/proto/attach-form\":9,\"./lib/proto/attach-link\":10,\"./lib/proto/handle-response\":11,\"./lib/proto/log\":12,\"./lib/proto/parse-element\":13,\"./lib/send-request\":14,\"./lib/switches\":16,\"./lib/switches-selectors\":15,\"./lib/uniqueid\":17,\"./lib/util/clone\":18,\"./lib/util/contains\":19,\"./lib/util/extend\":20,\"./lib/util/noop\":21}],2:[function(require,module,exports){\nvar noop = require(\"./util/noop\");\n\nmodule.exports = function(request) {\n  if (request && request.readyState < 4) {\n    request.onreadystatechange = noop;\n    request.abort();\n  }\n};\n\n},{\"./util/noop\":21}],3:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, listener, useCapture) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    forEachEls(els, function(el) {\n      el.addEventListener(e, listener, useCapture);\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],4:[function(require,module,exports){\nvar forEachEls = require(\"../foreach-els\");\n\nmodule.exports = function(els, events, opts) {\n  events = typeof events === \"string\" ? events.split(\" \") : events;\n\n  events.forEach(function(e) {\n    var event;\n    event = document.createEvent(\"HTMLEvents\");\n    event.initEvent(e, true, true);\n    event.eventName = e;\n    if (opts) {\n      Object.keys(opts).forEach(function(key) {\n        event[key] = opts[key];\n      });\n    }\n\n    forEachEls(els, function(el) {\n      var domFix = false;\n      if (!el.parentNode && el !== document && el !== window) {\n        // THANK YOU IE (9/10/11)\n        // dispatchEvent doesn't work if the element is not in the DOM\n        domFix = true;\n        document.body.appendChild(el);\n      }\n      el.dispatchEvent(event);\n      if (domFix) {\n        el.parentNode.removeChild(el);\n      }\n    });\n  });\n};\n\n},{\"../foreach-els\":5}],5:[function(require,module,exports){\n/* global HTMLCollection: true */\n\nmodule.exports = function(els, fn, context) {\n  if (\n    els instanceof HTMLCollection ||\n    els instanceof NodeList ||\n    els instanceof Array\n  ) {\n    return Array.prototype.forEach.call(els, fn, context);\n  }\n  // assume simple DOM element\n  return fn.call(context, els);\n};\n\n},{}],6:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nmodule.exports = function(selectors, cb, context, DOMcontext) {\n  DOMcontext = DOMcontext || document;\n  selectors.forEach(function(selector) {\n    forEachEls(DOMcontext.querySelectorAll(selector), cb, context);\n  });\n};\n\n},{\"./foreach-els\":5}],7:[function(require,module,exports){\nmodule.exports = function() {\n  // Borrowed wholesale from https://github.com/defunkt/jquery-pjax\n  return (\n    window.history &&\n    window.history.pushState &&\n    window.history.replaceState &&\n    // pushState isn’t reliable on iOS until 5.\n    !navigator.userAgent.match(\n      /((iPod|iPhone|iPad).+\\bOS\\s+[1-4]\\D|WebApps\\/.+CFNetwork)/\n    )\n  );\n};\n\n},{}],8:[function(require,module,exports){\n/* global _gaq: true, ga: true */\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.elements = options.elements || \"a[href], form[action]\";\n  options.selectors = options.selectors || [\"title\", \".js-Pjax\"];\n  options.switches = options.switches || {};\n  options.switchesOptions = options.switchesOptions || {};\n  options.history =\n    typeof options.history === \"undefined\" ? true : options.history;\n  options.analytics =\n    typeof options.analytics === \"function\" || options.analytics === false\n      ? options.analytics\n      : defaultAnalytics;\n  options.scrollTo =\n    typeof options.scrollTo === \"undefined\" ? 0 : options.scrollTo;\n  options.scrollRestoration =\n    typeof options.scrollRestoration !== \"undefined\"\n      ? options.scrollRestoration\n      : true;\n  options.cacheBust =\n    typeof options.cacheBust === \"undefined\" ? true : options.cacheBust;\n  options.debug = options.debug || false;\n  options.timeout = options.timeout || 0;\n  options.currentUrlFullReload =\n    typeof options.currentUrlFullReload === \"undefined\"\n      ? false\n      : options.currentUrlFullReload;\n\n  // We can’t replace body.outerHTML or head.outerHTML.\n  // It creates a bug where a new body or head are created in the DOM.\n  // If you set head.outerHTML, a new body tag is appended, so the DOM has 2 body nodes, and vice versa\n  if (!options.switches.head) {\n    options.switches.head = defaultSwitches.switchElementsAlt;\n  }\n  if (!options.switches.body) {\n    options.switches.body = defaultSwitches.switchElementsAlt;\n  }\n\n  return options;\n};\n\n/* istanbul ignore next */\nfunction defaultAnalytics() {\n  if (window._gaq) {\n    _gaq.push([\"_trackPageview\"]);\n  }\n  if (window.ga) {\n    ga(\"send\", \"pageview\", { page: location.pathname, title: document.title });\n  }\n}\n\n},{\"./switches\":16}],9:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar formAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  // Initialize requestOptions\n  options.requestOptions = {\n    requestUrl: el.getAttribute(\"action\") || window.location.href,\n    requestMethod: el.getAttribute(\"method\") || \"GET\"\n  };\n\n  // create a testable virtual link of the form action\n  var virtLinkElement = document.createElement(\"a\");\n  virtLinkElement.setAttribute(\"href\", options.requestOptions.requestUrl);\n\n  var attrValue = checkIfShouldAbort(virtLinkElement, options);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  if (el.enctype === \"multipart/form-data\") {\n    options.requestOptions.formData = new FormData(el);\n  } else {\n    options.requestOptions.requestParams = parseFormElements(el);\n  }\n\n  el.setAttribute(attrState, \"submit\");\n\n  options.triggerElement = el;\n  this.loadUrl(virtLinkElement.href, options);\n};\n\nfunction parseFormElements(el) {\n  var requestParams = [];\n  var formElements = el.elements;\n\n  for (var i = 0; i < formElements.length; i++) {\n    var element = formElements[i];\n    var tagName = element.tagName.toLowerCase();\n    // jscs:disable disallowImplicitTypeConversion\n    if (\n      !!element.name &&\n      element.attributes !== undefined &&\n      tagName !== \"button\"\n    ) {\n      // jscs:enable disallowImplicitTypeConversion\n      var type = element.attributes.type;\n\n      if (\n        !type ||\n        (type.value !== \"checkbox\" && type.value !== \"radio\") ||\n        element.checked\n      ) {\n        // Build array of values to submit\n        var values = [];\n\n        if (tagName === \"select\") {\n          var opt;\n\n          for (var j = 0; j < element.options.length; j++) {\n            opt = element.options[j];\n            if (opt.selected && !opt.disabled) {\n              values.push(opt.hasAttribute(\"value\") ? opt.value : opt.text);\n            }\n          }\n        } else {\n          values.push(element.value);\n        }\n\n        for (var k = 0; k < values.length; k++) {\n          requestParams.push({\n            name: encodeURIComponent(element.name),\n            value: encodeURIComponent(values[k])\n          });\n        }\n      }\n    }\n  }\n\n  return requestParams;\n}\n\nfunction checkIfShouldAbort(virtLinkElement, options) {\n  // Ignore external links.\n  if (\n    virtLinkElement.protocol !== window.location.protocol ||\n    virtLinkElement.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore click if we are on an anchor on the same page\n  if (\n    virtLinkElement.hash &&\n    virtLinkElement.href.replace(virtLinkElement.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (virtLinkElement.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n\n  // if declared as a full reload, just normally submit the form\n  if (\n    options.currentUrlFullReload &&\n    virtLinkElement.href === window.location.href.split(\"#\")[0]\n  ) {\n    return \"reload\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"submit\", function(event) {\n    formAction.call(that, el, event);\n  });\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],10:[function(require,module,exports){\nvar on = require(\"../events/on\");\nvar clone = require(\"../util/clone\");\n\nvar attrState = \"data-pjax-state\";\n\nvar linkAction = function(el, event) {\n  if (isDefaultPrevented(event)) {\n    return;\n  }\n\n  // Since loadUrl modifies options and we may add our own modifications below,\n  // clone it so the changes don't persist\n  var options = clone(this.options);\n\n  var attrValue = checkIfShouldAbort(el, event);\n  if (attrValue) {\n    el.setAttribute(attrState, attrValue);\n    return;\n  }\n\n  event.preventDefault();\n\n  // don’t do \"nothing\" if user try to reload the page by clicking the same link twice\n  if (\n    this.options.currentUrlFullReload &&\n    el.href === window.location.href.split(\"#\")[0]\n  ) {\n    el.setAttribute(attrState, \"reload\");\n    this.reload();\n    return;\n  }\n\n  el.setAttribute(attrState, \"load\");\n\n  options.triggerElement = el;\n  this.loadUrl(el.href, options);\n};\n\nfunction checkIfShouldAbort(el, event) {\n  // Don’t break browser special behavior on links (like page in new window)\n  if (\n    event.which > 1 ||\n    event.metaKey ||\n    event.ctrlKey ||\n    event.shiftKey ||\n    event.altKey\n  ) {\n    return \"modifier\";\n  }\n\n  // we do test on href now to prevent unexpected behavior if for some reason\n  // user have href that can be dynamically updated\n\n  // Ignore external links.\n  if (\n    el.protocol !== window.location.protocol ||\n    el.host !== window.location.host\n  ) {\n    return \"external\";\n  }\n\n  // Ignore anchors on the same page (keep native behavior)\n  if (\n    el.hash &&\n    el.href.replace(el.hash, \"\") ===\n      window.location.href.replace(location.hash, \"\")\n  ) {\n    return \"anchor\";\n  }\n\n  // Ignore empty anchor \"foo.html#\"\n  if (el.href === window.location.href.split(\"#\")[0] + \"#\") {\n    return \"anchor-empty\";\n  }\n}\n\nvar isDefaultPrevented = function(event) {\n  return event.defaultPrevented || event.returnValue === false;\n};\n\nmodule.exports = function(el) {\n  var that = this;\n\n  el.setAttribute(attrState, \"\");\n\n  on(el, \"click\", function(event) {\n    linkAction.call(that, el, event);\n  });\n\n  on(\n    el,\n    \"keyup\",\n    function(event) {\n      if (event.keyCode === 13) {\n        linkAction.call(that, el, event);\n      }\n    }.bind(this)\n  );\n};\n\n},{\"../events/on\":3,\"../util/clone\":18}],11:[function(require,module,exports){\nvar clone = require(\"../util/clone\");\nvar newUid = require(\"../uniqueid\");\nvar trigger = require(\"../events/trigger\");\n\nmodule.exports = function(responseText, request, href, options) {\n  options = clone(options || this.options);\n  options.request = request;\n\n  // Fail if unable to load HTML via AJAX\n  if (responseText === false) {\n    trigger(document, \"pjax:complete pjax:error\", options);\n\n    return;\n  }\n\n  // push scroll position to history\n  var currentState = window.history.state || {};\n  window.history.replaceState(\n    {\n      url: currentState.url || window.location.href,\n      title: currentState.title || document.title,\n      uid: currentState.uid || newUid(),\n      scrollPos: [\n        document.documentElement.scrollLeft || document.body.scrollLeft,\n        document.documentElement.scrollTop || document.body.scrollTop\n      ]\n    },\n    document.title,\n    window.location.href\n  );\n\n  // Check for redirects\n  var oldHref = href;\n  if (request.responseURL) {\n    if (href !== request.responseURL) {\n      href = request.responseURL;\n    }\n  } else if (request.getResponseHeader(\"X-PJAX-URL\")) {\n    href = request.getResponseHeader(\"X-PJAX-URL\");\n  } else if (request.getResponseHeader(\"X-XHR-Redirected-To\")) {\n    href = request.getResponseHeader(\"X-XHR-Redirected-To\");\n  }\n\n  // Add back the hash if it was removed\n  var a = document.createElement(\"a\");\n  a.href = oldHref;\n  var oldHash = a.hash;\n  a.href = href;\n  if (oldHash && !a.hash) {\n    a.hash = oldHash;\n    href = a.href;\n  }\n\n  this.state.href = href;\n  this.state.options = options;\n\n  try {\n    this.loadContent(responseText, options);\n  } catch (e) {\n    trigger(document, \"pjax:error\", options);\n\n    if (!this.options.debug) {\n      if (console && console.error) {\n        console.error(\"Pjax switch fail: \", e);\n      }\n      return this.latestChance(href);\n    } else {\n      throw e;\n    }\n  }\n};\n\n},{\"../events/trigger\":4,\"../uniqueid\":17,\"../util/clone\":18}],12:[function(require,module,exports){\nmodule.exports = function() {\n  if (this.options.debug && console) {\n    if (typeof console.log === \"function\") {\n      console.log.apply(console, arguments);\n    }\n    // IE is weird\n    else if (console.log) {\n      console.log(arguments);\n    }\n  }\n};\n\n},{}],13:[function(require,module,exports){\nvar attrState = \"data-pjax-state\";\n\nmodule.exports = function(el) {\n  switch (el.tagName.toLowerCase()) {\n    case \"a\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachLink(el);\n      }\n      break;\n\n    case \"form\":\n      // only attach link if el does not already have link attached\n      if (!el.hasAttribute(attrState)) {\n        this.attachForm(el);\n      }\n      break;\n\n    default:\n      throw \"Pjax can only be applied on <a> or <form> submit\";\n  }\n};\n\n},{}],14:[function(require,module,exports){\nvar updateQueryString = require(\"./util/update-query-string\");\n\nmodule.exports = function(location, options, callback) {\n  options = options || {};\n  var queryString;\n  var requestOptions = options.requestOptions || {};\n  var requestMethod = (requestOptions.requestMethod || \"GET\").toUpperCase();\n  var requestParams = requestOptions.requestParams || null;\n  var formData = requestOptions.formData || null;\n  var requestPayload = null;\n  var request = new XMLHttpRequest();\n  var timeout = options.timeout || 0;\n\n  request.onreadystatechange = function() {\n    if (request.readyState === 4) {\n      if (request.status === 200) {\n        callback(request.responseText, request, location, options);\n      } else if (request.status !== 0) {\n        callback(null, request, location, options);\n      }\n    }\n  };\n\n  request.onerror = function(e) {\n    console.log(e);\n    callback(null, request, location, options);\n  };\n\n  request.ontimeout = function() {\n    callback(null, request, location, options);\n  };\n\n  // Prepare the request payload for forms, if available\n  if (requestParams && requestParams.length) {\n    // Build query string\n    queryString = requestParams\n      .map(function(param) {\n        return param.name + \"=\" + param.value;\n      })\n      .join(\"&\");\n\n    switch (requestMethod) {\n      case \"GET\":\n        // Reset query string to avoid an issue with repeat submissions where checkboxes that were\n        // previously checked are incorrectly preserved\n        location = location.split(\"?\")[0];\n\n        // Append new query string\n        location += \"?\" + queryString;\n        break;\n\n      case \"POST\":\n        // Send query string as request payload\n        requestPayload = queryString;\n        break;\n    }\n  } else if (formData) {\n    requestPayload = formData;\n  }\n\n  // Add a timestamp as part of the query string if cache busting is enabled\n  if (options.cacheBust) {\n    location = updateQueryString(location, \"t\", Date.now());\n  }\n\n  request.open(requestMethod, location, true);\n  request.timeout = timeout;\n  request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n  request.setRequestHeader(\"X-PJAX\", \"true\");\n  request.setRequestHeader(\n    \"X-PJAX-Selectors\",\n    JSON.stringify(options.selectors)\n  );\n\n  // Send the proper header information for POST forms\n  if (requestPayload && requestMethod === \"POST\" && !formData) {\n    request.setRequestHeader(\n      \"Content-Type\",\n      \"application/x-www-form-urlencoded\"\n    );\n  }\n\n  request.send(requestPayload);\n\n  return request;\n};\n\n},{\"./util/update-query-string\":22}],15:[function(require,module,exports){\nvar forEachEls = require(\"./foreach-els\");\n\nvar defaultSwitches = require(\"./switches\");\n\nmodule.exports = function(\n  switches,\n  switchesOptions,\n  selectors,\n  fromEl,\n  toEl,\n  options\n) {\n  var switchesQueue = [];\n\n  selectors.forEach(function(selector) {\n    var newEls = fromEl.querySelectorAll(selector);\n    var oldEls = toEl.querySelectorAll(selector);\n    if (this.log) {\n      this.log(\"Pjax switch\", selector, newEls, oldEls);\n    }\n    if (newEls.length !== oldEls.length) {\n      throw \"DOM doesn’t look the same on new loaded page: ’\" +\n        selector +\n        \"’ - new \" +\n        newEls.length +\n        \", old \" +\n        oldEls.length;\n    }\n\n    forEachEls(\n      newEls,\n      function(newEl, i) {\n        var oldEl = oldEls[i];\n        if (this.log) {\n          this.log(\"newEl\", newEl, \"oldEl\", oldEl);\n        }\n\n        var callback = switches[selector]\n          ? switches[selector].bind(\n              this,\n              oldEl,\n              newEl,\n              options,\n              switchesOptions[selector]\n            )\n          : defaultSwitches.outerHTML.bind(this, oldEl, newEl, options);\n\n        switchesQueue.push(callback);\n      },\n      this\n    );\n  }, this);\n\n  this.state.numPendingSwitches = switchesQueue.length;\n\n  switchesQueue.forEach(function(queuedSwitch) {\n    queuedSwitch();\n  });\n};\n\n},{\"./foreach-els\":5,\"./switches\":16}],16:[function(require,module,exports){\nvar on = require(\"./events/on\");\n\nmodule.exports = {\n  outerHTML: function(oldEl, newEl) {\n    oldEl.outerHTML = newEl.outerHTML;\n    this.onSwitch();\n  },\n\n  innerHTML: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    if (newEl.className === \"\") {\n      oldEl.removeAttribute(\"class\");\n    } else {\n      //oldEl.className = newEl.className;\n    }\n\n    this.onSwitch();\n  },\n\n  switchElementsAlt: function(oldEl, newEl) {\n    oldEl.innerHTML = newEl.innerHTML;\n\n    // Copy attributes from the new element to the old one\n    if (newEl.hasAttributes()) {\n      var attrs = newEl.attributes;\n      for (var i = 0; i < attrs.length; i++) {\n        oldEl.attributes.setNamedItem(attrs[i].cloneNode());\n      }\n    }\n\n    this.onSwitch();\n  },\n\n  // Equivalent to outerHTML(), but doesn't require switchElementsAlt() for <head> and </head><body>\n  replaceNode: function(oldEl, newEl) {\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    this.onSwitch();\n  },\n\n  sideBySide: function(oldEl, newEl, options, switchOptions) {\n    var forEach = Array.prototype.forEach;\n    var elsToRemove = [];\n    var elsToAdd = [];\n    var fragToAppend = document.createDocumentFragment();\n    var animationEventNames =\n      \"animationend webkitAnimationEnd MSAnimationEnd oanimationend\";\n    var animatedElsNumber = 0;\n    var sexyAnimationEnd = function(e) {\n      if (e.target !== e.currentTarget) {\n        // end triggered by an animation on a child\n        return;\n      }\n\n      animatedElsNumber--;\n      if (animatedElsNumber </body></form></a></html[^></t.length;i++)o(t[i]);return>"}],"Post":[{"title":"webpack","date":"2021-11-01T02:29:36.000Z","_content":"\n# Webpack\n\n![Webpack](webpack-1.png)\n\n<!-- more -->\n\n## 什么是 Webpack\n\nWebpack 是一个**模块打包工具** (module bundler)，在 Webpack 里一切文件皆模块。通过 loader 转换文件，通过 plugin 注入钩子，最后输出由多个模块组合的文件。Webpack 专注构建模块化项目。\n\n> 当 Webpack 处理应用程序时，它会递归地构建一个依赖关系图 (dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。\n>\n> Webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。插件就像是一个插入到生产线中的一个功能，在特定的时机对生产线上的资源做处理。\n>\n> Webpack 通过 Tapable 来组织这条复杂的生产线。 Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。 Webpack 的事件流机制保证了插件的有序性，使得整个系统扩展性很好。 -- 深入浅出 Webpack 吴浩麟\n\n![Webpack](webpack-2.png)\n\n## Webpack 核心概念\n\n### 1. Entry\n\n入口起点 (entry point) 指示 Webpack 应该使用哪个模块，来作为构建其内部依赖图的开始。\n\n进入入口起点后，Webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。\n\n每个依赖项随即被处理，最后输出到称之为 bundles 的文件中。\n\n### 2. Output\n\nOutput 属性告诉 Webpack 在哪里输出它所创建的 bundles，以及如何命名这些文件，默认值为 `./dist`。\n\n基本上，整个应用程序结构，都会被编译到你指定的输出路径的文件夹中。\n\n### 3. Module\n\n模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。\n\n### 4. Chunk\n\n代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。\n\n### 5. Loader\n\nLoader 让 Webpack 能够去处理那些非 JavaScript 文件（Webpack 自身只理解 JavaScript）。\n\nLoader 可以将所有类型的文件转换为 Webpack 能够处理的有效模块，然后你就可以利用 Webpack 的打包能力，对它们进行处理。\n\n本质上，Webpack Loader 将所有类型的文件，转换为应用程序的依赖图（和最终的 bundle）可以直接引用的模块。\n\n### 6. Plugin\n\nLoader 被用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。\n\n插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能极其强大，可以用来处理各种各样的任务。\n\n## Webpack 构建流程\n\nWebpack 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程：\n\n1. **初始化参数**：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数。\n2. **开始编译**：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译。\n3. **确定入口**：根据配置中的 entry 找出所有的入口文件。\n4. **编译模块**：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。\n    > 可以分为三个部分帮助记忆：\n    >\n    > - 调用各 loader 处理模块之间的依赖\n    > - 调用 acorn 解析经 loader 处理后的源文件生成抽象语法树 AST\n    > - 遍历 AST，构建该模块所依赖的模块\n5. **完成模块编译**：在经过第 4 步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。\n6. **输出资源**：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会。\n7. **输出完成**：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。\n\n在以上过程中，Webpack 会在特定的时间点广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。\n\n## Loader\n\nLoader 用于对模块的源代码进行转换，在 import 或\"加载\"模块时预处理文件\n\n### 1. 配置方式\n\nLoader 的配置写在 `module.rules` 属性中：\n\n-   `rules` 是一个数组的形式，可以配置很多个 Loader\n-   每一个 Loader 对应一个对象的形式，对象属性 `test` 为匹配的规则，一般情况为正则表达式\n-   属性 `use` 针对匹配到文件类型，调用对应的 Loader 进行处理\n\n```js\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.css$/,\n                use: [\n                    { loader: \"style-loader\" },\n                    {\n                        loader: \"css-loader\",\n                        options: {\n                            modules: true,\n                        },\n                    },\n                    { loader: \"sass-loader\" },\n                ],\n            },\n        ],\n    },\n};\n```\n\n### 2. 特性\n\nLoader 支持链式调用，链中的每个 Loader 会处理之前已处理过的资源，最终变为 js 代码，顺序为相反的顺序执行。\n\nLoader 的特性：\n\n-   Loader 可以是同步的，也可以是异步的\n-   Loader 运行在 Node.js 中，并且能够执行任何操作\n-   除了常见的通过 package.json 的 main 来将一个 npm 模块导出为 Loader，还可以在 module.rules 中使用 Loader 字段直接引用一个模块\n-   插件(plugin) 可以为 Loader 带来更多特性\n-   Loader 能够产生额外的任意文件\n\n### 3. 常见的 Loader\n\n| Loader              | 说明                                                                    |\n| ------------------- | ----------------------------------------------------------------------- |\n| style-loader        | 将 css 添加到 DOM 的内联样式标签 `style` 里                             |\n| css-loader          | 允许将 css 文件通过 `require` 的方式引入，并返回 css 代码               |\n| less-loader         | 处理 less                                                               |\n| sass-loader         | 处理 sass                                                               |\n| postcss-loader      | 用 postcss 来处理 CSS                                                   |\n| autoprefixer-loader | 处理 CSS3 属性前缀，已被弃用，建议直接使用 postcss                      |\n| file-loader         | 分发文件到 output 目录并返回相对路径                                    |\n| url-loader          | 和 file-loader 类似，但是当文件小于设定的 limit 时可以返回一个 Data Url |\n| html-minify-loader  | 压缩 HTML                                                               |\n| babel-loader        | 用 babel 来转换 ES6 文件到 ES5                                          |\n\n## Plugin\n\nPlugin 赋予其各种灵活的功能，例如打包优化、资源管理、环境变量注入等，它们会运行在 Webpack 的不同阶段（钩子 / 生命周期），贯穿了 Webpack 整个编译周期。\n\nPlugin 目的在于解决 Loader 无法实现的其他事。\n\n### 1. 配置方式\n\n通过配置文件导出对象中 `plugins` 属性传入 new 实例对象。\n\n```js\nconst HtmlWebpackPlugin = require(\"html-Webpack-plugin\");\nconst Webpack = require(\"Webpack\"); // 访问内置的插件\nmodule.exports = {\n    plugins: [\n        new Webpack.ProgressPlugin(),\n        new HtmlWebpackPlugin({ template: \"./src/index.html\" }),\n    ],\n};\n```\n\n### 2. 特性\n\n其本质是一个具有 `apply` 方法 javascript 对象\n\n`apply` 方法会被 Webpack compiler 调用，并且在整个编译生命周期都可以访问 compiler 对象\n\n```js\nconst pluginName = \"ConsoleLogOnBuildWebpackPlugin\";\n\nclass ConsoleLogOnBuildWebpackPlugin {\n    apply(compiler) {\n        compiler.hooks.run.tap(pluginName, compilation => {\n            console.log(\"Webpack 构建过程开始！\");\n        });\n    }\n}\n\nmodule.exports = ConsoleLogOnBuildWebpackPlugin;\n```\n\ncompiler hook 的 `tap` 方法的第一个参数，应是驼峰式命名的插件名称\n\n关于整个编译生命周期钩子，有如下：\n\n> -   `entry-option`：初始化 option\n> -   `run`\n> -   `compile`：真正开始的编译，在创建 compilation 对象之前\n> -   `compilation`：生成好了 compilation 对象\n> -   `make`： 从 entry 开始递归分析依赖，准备对每个模块进行 build\n> -   `after-compile`：编译 build 过程结束\n> -   `emit`：在将内存中 assets 内容写到磁盘文件夹之前\n> -   `after-emit`：在将内存中 assets 内容写到磁盘文件夹之后\n> -   `done`：完成所有的编译过程\n> -   `failed`：编译失败的时候\n\n### 3. 常见的 Plugin\n\n| Plugin                        | 说明                                                       |\n| ----------------------------- | ---------------------------------------------------------- |\n| AggressiveSplittingPlugin     | 将原来的 chunk 分成更小的 chunk                            |\n| BabelMinifyWebpackPlugin      | 使用 babel-minify 进行压缩                                 |\n| BannerPlugin                  | 在每个生成的 chunk 顶部添加 banner                         |\n| CommonsChunkPlugin            | 提取 chunks 之间共享的通用模块                             |\n| CompressionWebpackPlugin      | 预先准备的资源压缩版本，使用 Content-Encoding 提供访问服务 |\n| ContextReplacementPlugin      | 重写 require 表达式的推断上下文                            |\n| CopyWebpackPlugin             | 将单个文件或整个目录复制到构建目录                         |\n| DefinePlugin                  | 允许在编译时(compile time) 配置的全局常量                  |\n| Dllplugin                     | 为了极大减小构建时间，进行分离打包                         |\n| EnvironmentPlugin             | DefinePlugin 中的 process.env 键的简写方式                 |\n| ExtractTextWebpackPlugin      | 从 bundel 中提取文本(CSS) 到单独的文件                     |\n| HotModuleReplacementPlugin    | 启用模块热替换 (Enable Hot Module Replacement - HMR)       |\n| HtmlWebpackPlugin             | 简单创建 HTML 文件，用于服务器访问                         |\n| I18nWebpackPlugin             | 为 bundle 增加国际化支持                                   |\n| IgnorePlugin                  | 从 bundle 中排除某些模块                                   |\n| LimitChunkCountPlugin         | 设置 chunk 的最小/最大限制，以微调和控制 chunk             |\n| LoaderOptionsPlugin           | 用于从 Webpack1 迁移到 Webpack2                            |\n| MinChunkSizePlugin            | 确保 chunk 大小超过指定限制                                |\n| NoEmitOnErrorsPlugin          | 在输出阶段时，遇到编译错误跳过                             |\n| NormalModuleReplacementPlugin | 替换与正则表达式匹配的资源                                 |\n\n## Loader 和 Plugin 的区别\n\n-   Loader 运行在打包文件之前\n-   Plugin 在整个编译周期都起作用\n\n在 Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果。\n\n对于 Loader，实质是一个转换器，比如将 A.scss 或 A.less 转变为 B.css，单纯的文件转换过程。\n\n## Webpack 热更新\n\n### 1. 实现原理\n\n<img src=\"../.images/image-20210526112504058.png\" alt=\"image-20210526112504058\" style=\"width: 600px;\" />\n\n-   Webpack Compile：将 JS 源代码编译成 bundle.js\n-   HMR Server：用来将热更新的文件输出给 HMR Runtime\n-   Bundle Server：静态资源文件服务器，提供文件访问路径\n-   HMR Runtime：socket 服务器，会被注入到浏览器，更新文件的变化\n-   bundle.js：构建输出的文件\n-   在 HMR Runtime 和 HMR Server 之间建立 Websocket，即 4⃣️ ，用于实时更新文件变化\n\n#### 启动阶段\n\n1 -> 2 -> A -> B\n在编写未经过 Webpack 打包的源代码后，Webpack Compile 将源代码和 HMR Runtime 一起编译成 bundle 文件，传输给 Bundle Server 静态资源服务器。\n\n#### 更新阶段\n\n1 -> 2 -> 3 -> 4\n\n当某一个文件或者模块发生变化时，Webpack 监听到文件变化对文件重新编译打包，编译生成唯一的 hash 值（下图 `h` 属性），这个 hash 值用来作为下一次热更新的标识。\n\n根据变化的内容生成两个补丁文件：`manifest`（包含了 hash 和 chundId，用来说明变化的内容）和 `chunk.js` 模块。\n\n由于 socket 服务器在 HMR Runtime 和 HMR Server 之间建立 Websocket 链接，当文件发生改动的时候，服务端会向浏览器推送一条消息，消息包含文件改动后生成的 hash 值，作为下一次热更新的标识。\n<img src=\"../.images/image-20210526145412513.png\" alt=\"image-20210526145412513\" style=\"width:600px;\" />\n\n在浏览器接受到这条消息之前，浏览器已经在上一次 socket 消息中已经记住了此时的 hash 标识，这时候会去服务端获取变化内容的 manifest 文件。\n\nmainfest 文件包含重新 build 生成的 hash 值，以及变化的模块（上图 `c` 属性）。\n\n浏览器根据 manifest 文件获取模块变化的内容，从而触发 render 流程，实现局部模块更新。\n\n### 2. 总结\n\n-   通过 `Webpack-dev-server` 创建两个服务器：提供静态资源的服务（express）和 Socket 服务\n-   express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）\n-   socket server 是一个 Websocket 的长连接，双方可以通信\n-   当 socket server 监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）\n-   通过长连接，socket server 可以直接将这两个文件主动发送给客户端（浏览器）\n-   浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新\n\n## Webpack Proxy\n\nWebpack Proxy，即 Webpack 提供的代理服务，基本行为就是接收客户端发送的请求后转发给其他服务器，其目的是为了便于开发者在开发模式下解决跨域问题（浏览器安全策略限制）。\n\n想要实现代理首先需要一个中间服务器，Webpack 中提供服务器的工具为 Webpack-dev-server。\n\n### 1. Webpack-dev-server\n\nWebpack-dev-server 是 Webpack 官方推出的一款开发工具，将自动编译和自动刷新浏览器等一系列对开发友好的功能全部集成在了一起，目的是为了提高开发者日常的开发效率，**「只适用在开发阶段」**\n\n配置方面，在 Webpack 配置对象属性中通过 devServer 属性提供，如下：\n\n```js\n// ./Webpack.config.js\nconst path = require(\"path\");\n\nmodule.exports = {\n    devServer: {\n        contentBase: path.join(__dirname, \"dist\"),\n        compress: true,\n        port: 3000,\n        proxy: {\n            \"/api\": {\n                target: \"https://api.xxx.com\",\n            },\n        },\n    },\n};\n```\n\n> 属性：\n>\n> -   target：表示的是代理到的目标地址\n> -   pathRewrite：默认情况下 `/api` 也会被写入到 URL 中，如果希望删除，可以使用 `pathRewrite`\n> -   secure：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 `false`\n> -   changeOrigin：它表示是否更新代理后请求的 `headers` 中 `host` 地址\n\n### 2. 工作原理\n\nproxy 工作原理实质上是利用 `http-proxy-middleware` 这个 http 代理中间件，实现请求转发给其他服务器。\n\n### 3. 跨域\n\n在开发阶段， Webpack-dev-server 会启动一个本地开发服务器，所以我们的应用在开发阶段是独立运行在 localhost 的一个端口上，而后端服务又是运行在另外一个地址上，所以在开发阶段中，由于浏览器同源策略的原因，当本地访问后端就会出现跨域请求的问题。\n\n通过设置 Webpack proxy 实现代理请求后，相当于浏览器与服务端中添加一个代理者，当本地发送请求的时候，代理服务器响应该请求，并将请求转发到目标服务器，目标服务器响应数据后再将数据返回给代理服务器，最终再由代理服务器将数据响应给本地。\n\n**注意：「服务器与服务器之间请求数据并不会存在跨域行为，跨域行为是浏览器安全策略限制」**\n\n## 前端性能优化\n\n### 1. JS 代码压缩\n\n`terser` 是一个 JavaScript 的解释、绞肉机、压缩机的工具集，可以帮助我们压缩、丑化我们的代码，让 bundle 更小\n\n在 `production` 模式下，Webpack 默认使用 TerserPlugin 来处理代码。自定义配置方法如下：\n\n```js\nconst TerserPlugin = require(\"terser-Webpack-plugin\");\nmodule.exports = {\n    optimization: {\n        minimize: true,\n        minimizer: [\n            new TerserPlugin({\n                parallel: true, // 电脑cpu核数-1\n            }),\n        ],\n    },\n};\n```\n\n> 属性：\n>\n> -   extractComments：默认值为 `true`，表示会将注释抽取到一个单独的文件中，开发阶段，我们可设置为 `false` ，不保留注释\n> -   parallel：使用多进程并发运行提高构建的速度，默认值是 `true`，并发运行的默认数量：`os.cpus().length - 1`\n> -   terserOptions：设置我们的 terser 相关的配置：\n>\n>     compress：设置压缩相关的选项\n>     mangle：设置丑化相关的选项，可以直接设置为 `true`\n>     toplevel：底层变量是否进行转换\n>     keep_classnames：保留类的名称\n>     keep_fnames：保留函数的名称\n\n### 2. CSS 代码压缩\n\n使用 `css-minimizer-Webpack-plugin`\n\n```shell\nnpm install css-minimizer-Webpack-plugin -D\n```\n\n```js\nconst CssMinimizerPlugin = require(\"css-minimizer-Webpack-plugin\");\nmodule.exports = {\n    optimization: {\n        minimize: true,\n        minimizer: [\n            new CssMinimizerPlugin({\n                parallel: true,\n            }),\n        ],\n    },\n};\n```\n\n### 3. HTML 文件代码压缩\n\n使用 `HtmlWebpackPlugin` 插件来生成 HTML 的模板时候，通过配置属性 `minify` 进行 html 优化。\n\n```js\nmodule.exports = {\n    plugin: [\n        new HtmlWebpackPlugin({\n            minify: {\n                minifyCSS: false, // 是否压缩css\n                collapseWhitespace: false, // 是否折叠空格\n                removeComments: true, // 是否移除注释\n            },\n        }),\n    ],\n};\n```\n\n设置了 `minify`，实际会使用另一个插件 `html-minifier-terser`\n\n### 4. 文件大小压缩\n\n对文件的大小进行压缩，减少 http 传输过程中宽带的损耗，使用 `compression-Webpack-plugin`。\n\n```js\nnew ComepressionPlugin({\n    test: /\\.(css|js)$/, // 哪些文件需要压缩\n    threshold: 500, // 设置文件多大开始压缩\n    minRatio: 0.7, // 至少压缩的比例\n    algorithm: \"gzip\", // 采用的压缩算法\n});\n```\n\n### 5. 图片压缩\n\n```js\nmodule: {\n    rules: [\n        {\n            test: /\\.(png|jpg|gif)$/,\n            use: [\n                {\n                    loader: \"file-loader\",\n                    options: {\n                        name: \"[name]_[hash].[ext]\",\n                        outputPath: \"images/\",\n                    },\n                },\n                {\n                    loader: \"image-Webpack-loader\",\n                    options: {\n                        // 压缩 jpeg 的配置\n                        mozjpeg: {\n                            progressive: true,\n                            quality: 65,\n                        },\n                        // 使用 imagemin**-optipng 压缩 png，enable: false 为关闭\n                        optipng: {\n                            enabled: false,\n                        },\n                        // 使用 imagemin-pngquant 压缩 png\n                        pngquant: {\n                            quality: \"65-90\",\n                            speed: 4,\n                        },\n                        // 压缩 gif 的配置\n                        gifsicle: {\n                            interlaced: false,\n                        },\n                        // 开启 webp，会把 jpg 和 png 图片压缩为 webp 格式\n                        webp: {\n                            quality: 75,\n                        },\n                    },\n                },\n            ],\n        },\n    ];\n}\n```\n\n### 6. Tree Shaking\n\nTree Shaking 是一个术语，在计算机中表示消除死代码，依赖于 ES Module 的静态语法分析（不执行任何的代码，可以明确知道模块的依赖关系）。\n\n在 Webpack 实现 Tree shaking 有两种不同的方案：\n\n-   usedExports：通过标记某些函数是否被使用，之后通过 Terser 来进行优化的\n-   sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用\n    两种不同的配置方案， 有不同的效果\n\n#### usedExports\n\n```js\nmodule.exports = {\n    optimization: {\n        usedExports: true,\n    },\n};\n```\n\n使用之后，没被用上的代码在 Webpack 打包中会加入 `/* unused harmony export mul */` 注释，用来告知 Terser 在优化时，可以删除掉这段代码。\n\n#### sideEffects\n\nsideEffects 用于告知 Webpack Compiler 哪些模块时有副作用，配置方法是在 `package.json` 中设置 `sideEffects` 属性。\n\n如果 sideEffects 设置为 `false`，就是告知 Webpack 可以安全的删除未用到的 exports。如果有些文件需要保留，可以设置为数组的形式。\n\n```json\n{\n    \"sideEffects\": [\n        \"./src/util/format.js\",\n        \"*.css\" // 所有的css文件\n    ]\n}\n```\n\n#### css tree shaking\n\ncss 进行 tree shaking 优化可以安装 `PurgeCss` 插件。\n\n```js\nconst PurgeCssPlugin = require(\"purgecss-Webpack-plugin\");\nmodule.exports = {\n    plugins: [\n        new PurgeCssPlugin({\n            path: glob.sync(`${path.resolve(\"./src\")}/**/*`),\n            nodir: true, // src里面的所有文件\n            satelist: function () {\n                return {\n                    standard: [\"html\"],\n                };\n            },\n        }),\n    ],\n};\n```\n\n> paths：表示要检测哪些目录下的内容需要被分析，配合使用 glob。\n> 默认情况下，PurgeCss 会将我们的 html 标签的样式移除掉，如果我们希望保留，可以添加一个 `safelist` 的属性。\n\n### 7. 代码分割 (Code Splitting)\n\n将代码分离到不同的 bundle 中，之后我们可以按需加载，或者并行加载这些文件。\n\n默认情况下，所有的 JavaScript 代码（业务代码、第三方依赖、暂时没有用到的模块）在首页全部都加载，就会影响首页的加载速度。\n\n代码分离可以分出出更小的 bundle，以及控制资源加载优先级，提供代码的加载性能。\n\n这里通过 `splitChunksPlugin` 来实现，该插件 Webpack 已经默认安装和集成，只需要配置即可。默认配置中，chunks 仅仅针对于异步（async）请求，我们可以设置为 `initial` 或者 `all`。\n\n```js\nmodule.exports = {\n    optimization: {\n        splitChunks: {\n        minSize: 30000,\n        maxInitialRequests: 5,\n        cacheGroups: {\n          lib: {\n            name: 'vendors',\n            priority: 10,\n            test: /[\\\\/]node_modules[\\\\/]/,\n            chunks: 'initial',\n          },\n          react: {\n            name: 'react',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]react[\\\\/]/,\n            chunks: 'all',\n          },\n          antd: {\n            name: 'antd',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]antd[\\\\/]/,\n            chunks: 'all',\n          },\n          moment: {\n            name: 'moment',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]moment[\\\\/]/,\n          },\n          default: {\n            minChunks: 2,\n            priority: -20,\n            reuseExistingChunk: true,\n          },\n        },\n    },\n};\n```\n\n> minSize：拆分包的大小，至少为 minSize，如何包的大小不超过 minSize，这个包不会拆分\n> maxSize：将大于 maxSize 的包，拆分为不小于 minSize 的包\n\n#### chunks\n\n1. `async` 表示只从异步加载得模块（动态加载 `import()`）里面进行拆分\n2. `initial` 表示只从入口模块进行拆分\n3. `all` 表示以上两者都包括\n\n#### cacheGroups\n\n1. `name`：chunk 的文件名\n2. `test`：过滤 modules，默认为所有的 modules，可匹配模块路径或 chunk 名字，当匹配到某个 chunk 的名字时，这个 chunk 里面引入的所有 module 都会选中\n3. `priority`：权重，数字越大表示优先级越高。一个 module 可能会满足多个 cacheGroups 的正则匹配，到底将哪个缓存组应用于这个 module，取决于优先级\n4. `reuseExistingChunk`：是否使用已有的 chunk，true 则表示如果当前的 chunk 包含的模块已经被抽取出去了，那么将不会重新生成新的，即几个 chunk 复用被拆分出去的一个 module\n\n### 8. 内联 chunk\n\n可以通过 `InlineChunkHtmlPlugin` 插件将一些 chunk 的模块内联到 html，如 runtime 的代码（对模块进行解析、加载、模块信息相关的代码），代码量并不大，但是必须加载的。\n\n```js\nconst InlineChunkHtmlPlugin = require(\"react-dev-utils/InlineChunkHtmlPlugin\");\nconst HtmlWebpackPlugin = require(\"html-Webpack-plugin\");\nmodule.exports = {\n    plugin: [new InlineChunkHtmlPlugin(HtmlWebpackPlugin, [/runtime.+\\.js/])],\n};\n```\n\n### 9. 总结\n\n关于 Webpack 对前端性能的优化，可以通过文件体积大小入手，其次还可通过分包的形式、减少 http 请求次数等方式，实现对前端性能的优化。\n\n## 提高 Webpack 的构建速度\n\n### 1. 优化 Loader 配置\n\n通过配置 include、exclude、test 属性来匹配文件，接触 include、exclude 规定哪些匹配应用 loader。\n\n```js\n// 配置 babel-loader\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                // 如果项目源码中只有 js 文件就不要写成 /\\.jsx?$/，提升正则表达式性能\n                test: /\\.js$/,\n                // babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启\n                use: [\"babel-loader?cacheDirectory\"],\n                // 只对项目根目录下的 src 目录中的文件采用 babel-loader\n                include: path.resolve(__dirname, \"src\"),\n            },\n        ],\n    },\n};\n```\n\n### 2. 合理使用 resolve.extensions\n\n通过 `resolve.extensions` 是解析到文件时自动添加扩展名，默认情况如下：\n\n```js\nmodule.exports = {\n    extensions: [\".warm\", \".mjs\", \".js\", \".json\"],\n};\n```\n\n引入文件的时候，若没有文件后缀名，则会根据数组内的值依次查找。配置的时候，不要随便把所有后缀都写在里面，这会调用多次文件的查找，减慢打包速度。\n\n### 3. 优化 resolve.modules\n\n`resolve.modules` 用于配置 Webpack 去哪些目录下寻找第三方模块。默认值为 `['node_modules']` ，所以默认会从 node_modules 中查找文件 当安装的第三方模块都放在项目根目录下的 `./node_modules` 目录下时，所以可以指明存放第三方模块的绝对路径，以减少寻找，配置如下：\n\n```js\nmodule.exports = {\n    resolve: {\n        // 使用绝对路径指明第三方模块存放的位置，以减少搜索步骤\n        // 其中 __dirname 表示当前工作目录，也就是项目根目录\n        modules: [path.resolve(__dirname, \"node_modules\")],\n    },\n};\n```\n\n### 4. 优化 resolve.alias\n\nalias 给一些常用的路径起一个别名，特别当我们的项目目录结构比较深的时候，一个文件的路径可能是 `../../../` 的形式。\n\n通过配置 alias 以减少查找过程：\n\n```js\nmodule.exports = {\n    resolve: {\n        alias: {\n            \"@\": path.resolve(__dirname, \"./src\"),\n        },\n    },\n};\n```\n\n### 5. 使用 DLLPlugin 插件\n\nDLL 全称是 动态链接库，是为软件在 Windows 中实现共享函数库的一种实现方式，而 Webpack 也内置了 DLL 的功能，为的就是可以共享，不经常改变的代码，抽成一个共享的库。这个库在之后的编译过程中，会被引入到其他项目的代码中\n\n使用步骤分成两部分：\n\n-   打包一个 DLL 库\n-   引入 DLL 库\n\n#### 打包一个 DLL 库\n\nWebpack 内置了一个 DllPlugin 可以帮助我们打包一个 DLL 的库文件\n\n```js\nmodule.exports = {\n    plugins: [\n        new Webpack.DllPlugin({\n            name: \"dll_[name]\",\n            path: path.resolve(__dirname, \"./dll/[name].mainfest.json\"),\n        }),\n    ],\n};\n```\n\n#### 引入 DLL 库\n\n使用 Webpack 自带的 `DllReferencePlugin` 插件对 `mainfest.json` 映射文件进行分析，获取要使用的 DLL 库，然后再通过 `AddAssetHtmlPlugin` 插件，将打包的 DLL 库引入到 Html 模块中。\n\n```js\nmodule.exports = {\n    plugins: [\n        new Webpack.DllReferencePlugin({\n            context: path.resolve(__dirname, \"./dll/dll_react.js\"),\n            mainfest: path.resolve(__dirname, \"./dll/react.mainfest.json\"),\n        }),\n        new AddAssetHtmlPlugin({\n            outputPath: \"./auto\",\n            filepath: path.resolve(__dirname, \"./dll/dll_react.js\"),\n        }),\n    ],\n};\n```\n\n### 6. 使用 cache-loader\n\n在一些性能开销较大的 loader 之前添加 `cache-loader`，以将结果缓存到磁盘里，显著提升二次构建速度。\n\n保存和读取这些缓存文件会有一些时间开销，所以应只对性能开销较大的 loader 使用此 loader。\n\n```js\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.ext$/,\n                use: [\"cache-loader\", ...loaders],\n                include: path.resolve(\"src\"),\n            },\n        ],\n    },\n};\n```\n\n### 7. terser 启动多线程\n\n使用多进程并行运行来提高构建速度。\n\nTerserWebpackPlugin 插件使用 terser 来压缩 JavaScript。\n\n```js\nmodule.exports = {\n    optimization: {\n        minimizer: [\n            new TerserPlugin({\n                parallel: true,\n            }),\n        ],\n    },\n};\n```\n\n### 8. 合理使用 sourceMap\n\n打包生成 sourceMap 的时候，如果信息越详细，打包速度就会越慢。对应属性取值如下所示：\n\n| devtool                        | 构建速度 | 重新构建速度 | 生产环境 | 品质(quality)         |\n| ------------------------------ | -------- | ------------ | -------- | --------------------- |\n| (none)                         | +++      | +++          | yes      | 打包后的代码          |\n| eval                           | +++      | +++          | no       | 生成后的代码          |\n| cheap-eval-source-map          | +        | ++           | no       | 转换过的代码 (仅限行) |\n| cheap-module-eval-source-map   | o        | ++           | no       | 原始源代码 (仅限行)   |\n| eval-source-map                | --       | +            | no       | 原始源代码            |\n| cheap-source-map               | +        | o            | yes      | 转换过的代码 (仅限行) |\n| cheap-module-source-map        | o        | -            | yes      | 原始源代码 (仅限行)   |\n| inline-cheap-source-map        | +        | o            | no       | 转换过的代码 (仅限行) |\n| inline-cheap-module-source-map | o        | -            | no       | 原始源代码 (仅限行)   |\n| source-map                     | --       | --           | yes      | 原始源代码            |\n| inline-source-map              | --       | --           | no       | 原始源代码            |\n| hidden-source-map              | --       | --           | yes      | 原始源代码            |\n| nosources-source-map           | --       | --           | yes      | 无源代码内容          |\n\n> +++ 非常快速 &emsp; ++ 快速 &emsp; + 比较快 &emsp; o 中等 &emsp; - 比较慢 &emsp; -- 慢\n\n### 总结\n\n优化 Webpack 构建的方式有很多，主要可以从优化搜索时间、缩小文件搜索范围、减少不必要的编译等方面入手。\n\n## Webpack 与 grunt、gulp 有什么不同\n\n<img src=\"../.images/image-20210526232017808.png\" alt=\"image-20210526232017808\" style=\"width: 600px;\" />\n\n从上图中可以看出来三者都不在一个频道，自然没有可比性。\n\ngrunt 和 gulp 在早期比较流行，属于前端工具类，主要优化前端工作流程，比如自动刷新页面、combo、压缩 css、js、css 预编译等等。\n\n现在 Webpack 相对来说比较主流，属于预编译模块的方案，不需要在浏览器中加载解释器。另外，在本地直接写 JS，不管是 AMD / CMD / ES6 风格的模块化，Webpack 都能认识，并且编译成浏览器认识的 js。\n\n### 使用上的区别\n\ngrunt 和 gulp 是基于任务和流（Task、Stream）的。类似 jQuery，找到一个（或一类）文件，对其做一系列链式操作，更新流上的数据， 整条链式操作构成了一个任务，多个任务就构成了整个 web 的构建流程。\n\n```js\ngulp.task(\"dev\", function () {\n    // 这个任务的名称是 dev\n    gulp.src(\"src/js/*.js\") //找到 `src/js/` 目录下的所有js\n        .pipe(concat(\"all.js\")) //对其进行合并并且命名为 `all.js`\n        .pipe(uglify()) //压缩\n        .pipe(rename(\"all.min.js\")) //重命名\n        .pipe(gulp.dest(\"dist/js/\")); //输出压缩后的js\n});\n\n//在目录下执行 `gulp dev` 即可执行上述操作\n//grunt 与 gulp 类似，只是稍微繁索一些，现在基本上用不上了\n```\n\nWebpack 是基于入口的。会自动地递归解析入口所需要加载的所有资源文件，然后用不同的 Loader 来处理不同的文件，用 Plugin 来扩展 Webpack 功能。\n\n```js\n// Webpack 具体配置这里不做讲解，形式都大同小异\n\nmodule.exports = {\n    entry: \"./entry.js\", //入口文件\n    output: {\n        filename: \"./bundle.js\", //输出文件\n    },\n    module: {\n        loaders: [...loaders],\n    },\n};\n```\n\n从构建思路来说，gulp 和 grunt 需要开发者将整个前端构建过程拆分成多个 Task，并合理控制所有 Task 的调用关系\nWebpack 需要开发者找到入口，并需要清楚对于不同的资源应该使用什么 Loader 做何种解析和加工。\n\n### 总结\n\n-   gulp、grunt 是 web 构建工具\n-   Webpack 是模块化方案\n-   gulp、grunt 是基于任务和流\n-   Webpack 基于入口文件\n","source":"_posts/webpack.md","raw":"---\ntitle: webpack\ndate: 2021-11-01 10:29:36\ntags: webpack\ncategory: webpack\n---\n\n# Webpack\n\n![Webpack](webpack-1.png)\n\n<!-- more -->\n\n## 什么是 Webpack\n\nWebpack 是一个**模块打包工具** (module bundler)，在 Webpack 里一切文件皆模块。通过 loader 转换文件，通过 plugin 注入钩子，最后输出由多个模块组合的文件。Webpack 专注构建模块化项目。\n\n> 当 Webpack 处理应用程序时，它会递归地构建一个依赖关系图 (dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。\n>\n> Webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。插件就像是一个插入到生产线中的一个功能，在特定的时机对生产线上的资源做处理。\n>\n> Webpack 通过 Tapable 来组织这条复杂的生产线。 Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。 Webpack 的事件流机制保证了插件的有序性，使得整个系统扩展性很好。 -- 深入浅出 Webpack 吴浩麟\n\n![Webpack](webpack-2.png)\n\n## Webpack 核心概念\n\n### 1. Entry\n\n入口起点 (entry point) 指示 Webpack 应该使用哪个模块，来作为构建其内部依赖图的开始。\n\n进入入口起点后，Webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。\n\n每个依赖项随即被处理，最后输出到称之为 bundles 的文件中。\n\n### 2. Output\n\nOutput 属性告诉 Webpack 在哪里输出它所创建的 bundles，以及如何命名这些文件，默认值为 `./dist`。\n\n基本上，整个应用程序结构，都会被编译到你指定的输出路径的文件夹中。\n\n### 3. Module\n\n模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。\n\n### 4. Chunk\n\n代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。\n\n### 5. Loader\n\nLoader 让 Webpack 能够去处理那些非 JavaScript 文件（Webpack 自身只理解 JavaScript）。\n\nLoader 可以将所有类型的文件转换为 Webpack 能够处理的有效模块，然后你就可以利用 Webpack 的打包能力，对它们进行处理。\n\n本质上，Webpack Loader 将所有类型的文件，转换为应用程序的依赖图（和最终的 bundle）可以直接引用的模块。\n\n### 6. Plugin\n\nLoader 被用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。\n\n插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能极其强大，可以用来处理各种各样的任务。\n\n## Webpack 构建流程\n\nWebpack 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程：\n\n1. **初始化参数**：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数。\n2. **开始编译**：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译。\n3. **确定入口**：根据配置中的 entry 找出所有的入口文件。\n4. **编译模块**：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。\n    > 可以分为三个部分帮助记忆：\n    >\n    > - 调用各 loader 处理模块之间的依赖\n    > - 调用 acorn 解析经 loader 处理后的源文件生成抽象语法树 AST\n    > - 遍历 AST，构建该模块所依赖的模块\n5. **完成模块编译**：在经过第 4 步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。\n6. **输出资源**：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会。\n7. **输出完成**：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。\n\n在以上过程中，Webpack 会在特定的时间点广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。\n\n## Loader\n\nLoader 用于对模块的源代码进行转换，在 import 或\"加载\"模块时预处理文件\n\n### 1. 配置方式\n\nLoader 的配置写在 `module.rules` 属性中：\n\n-   `rules` 是一个数组的形式，可以配置很多个 Loader\n-   每一个 Loader 对应一个对象的形式，对象属性 `test` 为匹配的规则，一般情况为正则表达式\n-   属性 `use` 针对匹配到文件类型，调用对应的 Loader 进行处理\n\n```js\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.css$/,\n                use: [\n                    { loader: \"style-loader\" },\n                    {\n                        loader: \"css-loader\",\n                        options: {\n                            modules: true,\n                        },\n                    },\n                    { loader: \"sass-loader\" },\n                ],\n            },\n        ],\n    },\n};\n```\n\n### 2. 特性\n\nLoader 支持链式调用，链中的每个 Loader 会处理之前已处理过的资源，最终变为 js 代码，顺序为相反的顺序执行。\n\nLoader 的特性：\n\n-   Loader 可以是同步的，也可以是异步的\n-   Loader 运行在 Node.js 中，并且能够执行任何操作\n-   除了常见的通过 package.json 的 main 来将一个 npm 模块导出为 Loader，还可以在 module.rules 中使用 Loader 字段直接引用一个模块\n-   插件(plugin) 可以为 Loader 带来更多特性\n-   Loader 能够产生额外的任意文件\n\n### 3. 常见的 Loader\n\n| Loader              | 说明                                                                    |\n| ------------------- | ----------------------------------------------------------------------- |\n| style-loader        | 将 css 添加到 DOM 的内联样式标签 `style` 里                             |\n| css-loader          | 允许将 css 文件通过 `require` 的方式引入，并返回 css 代码               |\n| less-loader         | 处理 less                                                               |\n| sass-loader         | 处理 sass                                                               |\n| postcss-loader      | 用 postcss 来处理 CSS                                                   |\n| autoprefixer-loader | 处理 CSS3 属性前缀，已被弃用，建议直接使用 postcss                      |\n| file-loader         | 分发文件到 output 目录并返回相对路径                                    |\n| url-loader          | 和 file-loader 类似，但是当文件小于设定的 limit 时可以返回一个 Data Url |\n| html-minify-loader  | 压缩 HTML                                                               |\n| babel-loader        | 用 babel 来转换 ES6 文件到 ES5                                          |\n\n## Plugin\n\nPlugin 赋予其各种灵活的功能，例如打包优化、资源管理、环境变量注入等，它们会运行在 Webpack 的不同阶段（钩子 / 生命周期），贯穿了 Webpack 整个编译周期。\n\nPlugin 目的在于解决 Loader 无法实现的其他事。\n\n### 1. 配置方式\n\n通过配置文件导出对象中 `plugins` 属性传入 new 实例对象。\n\n```js\nconst HtmlWebpackPlugin = require(\"html-Webpack-plugin\");\nconst Webpack = require(\"Webpack\"); // 访问内置的插件\nmodule.exports = {\n    plugins: [\n        new Webpack.ProgressPlugin(),\n        new HtmlWebpackPlugin({ template: \"./src/index.html\" }),\n    ],\n};\n```\n\n### 2. 特性\n\n其本质是一个具有 `apply` 方法 javascript 对象\n\n`apply` 方法会被 Webpack compiler 调用，并且在整个编译生命周期都可以访问 compiler 对象\n\n```js\nconst pluginName = \"ConsoleLogOnBuildWebpackPlugin\";\n\nclass ConsoleLogOnBuildWebpackPlugin {\n    apply(compiler) {\n        compiler.hooks.run.tap(pluginName, compilation => {\n            console.log(\"Webpack 构建过程开始！\");\n        });\n    }\n}\n\nmodule.exports = ConsoleLogOnBuildWebpackPlugin;\n```\n\ncompiler hook 的 `tap` 方法的第一个参数，应是驼峰式命名的插件名称\n\n关于整个编译生命周期钩子，有如下：\n\n> -   `entry-option`：初始化 option\n> -   `run`\n> -   `compile`：真正开始的编译，在创建 compilation 对象之前\n> -   `compilation`：生成好了 compilation 对象\n> -   `make`： 从 entry 开始递归分析依赖，准备对每个模块进行 build\n> -   `after-compile`：编译 build 过程结束\n> -   `emit`：在将内存中 assets 内容写到磁盘文件夹之前\n> -   `after-emit`：在将内存中 assets 内容写到磁盘文件夹之后\n> -   `done`：完成所有的编译过程\n> -   `failed`：编译失败的时候\n\n### 3. 常见的 Plugin\n\n| Plugin                        | 说明                                                       |\n| ----------------------------- | ---------------------------------------------------------- |\n| AggressiveSplittingPlugin     | 将原来的 chunk 分成更小的 chunk                            |\n| BabelMinifyWebpackPlugin      | 使用 babel-minify 进行压缩                                 |\n| BannerPlugin                  | 在每个生成的 chunk 顶部添加 banner                         |\n| CommonsChunkPlugin            | 提取 chunks 之间共享的通用模块                             |\n| CompressionWebpackPlugin      | 预先准备的资源压缩版本，使用 Content-Encoding 提供访问服务 |\n| ContextReplacementPlugin      | 重写 require 表达式的推断上下文                            |\n| CopyWebpackPlugin             | 将单个文件或整个目录复制到构建目录                         |\n| DefinePlugin                  | 允许在编译时(compile time) 配置的全局常量                  |\n| Dllplugin                     | 为了极大减小构建时间，进行分离打包                         |\n| EnvironmentPlugin             | DefinePlugin 中的 process.env 键的简写方式                 |\n| ExtractTextWebpackPlugin      | 从 bundel 中提取文本(CSS) 到单独的文件                     |\n| HotModuleReplacementPlugin    | 启用模块热替换 (Enable Hot Module Replacement - HMR)       |\n| HtmlWebpackPlugin             | 简单创建 HTML 文件，用于服务器访问                         |\n| I18nWebpackPlugin             | 为 bundle 增加国际化支持                                   |\n| IgnorePlugin                  | 从 bundle 中排除某些模块                                   |\n| LimitChunkCountPlugin         | 设置 chunk 的最小/最大限制，以微调和控制 chunk             |\n| LoaderOptionsPlugin           | 用于从 Webpack1 迁移到 Webpack2                            |\n| MinChunkSizePlugin            | 确保 chunk 大小超过指定限制                                |\n| NoEmitOnErrorsPlugin          | 在输出阶段时，遇到编译错误跳过                             |\n| NormalModuleReplacementPlugin | 替换与正则表达式匹配的资源                                 |\n\n## Loader 和 Plugin 的区别\n\n-   Loader 运行在打包文件之前\n-   Plugin 在整个编译周期都起作用\n\n在 Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果。\n\n对于 Loader，实质是一个转换器，比如将 A.scss 或 A.less 转变为 B.css，单纯的文件转换过程。\n\n## Webpack 热更新\n\n### 1. 实现原理\n\n<img src=\"../.images/image-20210526112504058.png\" alt=\"image-20210526112504058\" style=\"width: 600px;\" />\n\n-   Webpack Compile：将 JS 源代码编译成 bundle.js\n-   HMR Server：用来将热更新的文件输出给 HMR Runtime\n-   Bundle Server：静态资源文件服务器，提供文件访问路径\n-   HMR Runtime：socket 服务器，会被注入到浏览器，更新文件的变化\n-   bundle.js：构建输出的文件\n-   在 HMR Runtime 和 HMR Server 之间建立 Websocket，即 4⃣️ ，用于实时更新文件变化\n\n#### 启动阶段\n\n1 -> 2 -> A -> B\n在编写未经过 Webpack 打包的源代码后，Webpack Compile 将源代码和 HMR Runtime 一起编译成 bundle 文件，传输给 Bundle Server 静态资源服务器。\n\n#### 更新阶段\n\n1 -> 2 -> 3 -> 4\n\n当某一个文件或者模块发生变化时，Webpack 监听到文件变化对文件重新编译打包，编译生成唯一的 hash 值（下图 `h` 属性），这个 hash 值用来作为下一次热更新的标识。\n\n根据变化的内容生成两个补丁文件：`manifest`（包含了 hash 和 chundId，用来说明变化的内容）和 `chunk.js` 模块。\n\n由于 socket 服务器在 HMR Runtime 和 HMR Server 之间建立 Websocket 链接，当文件发生改动的时候，服务端会向浏览器推送一条消息，消息包含文件改动后生成的 hash 值，作为下一次热更新的标识。\n<img src=\"../.images/image-20210526145412513.png\" alt=\"image-20210526145412513\" style=\"width:600px;\" />\n\n在浏览器接受到这条消息之前，浏览器已经在上一次 socket 消息中已经记住了此时的 hash 标识，这时候会去服务端获取变化内容的 manifest 文件。\n\nmainfest 文件包含重新 build 生成的 hash 值，以及变化的模块（上图 `c` 属性）。\n\n浏览器根据 manifest 文件获取模块变化的内容，从而触发 render 流程，实现局部模块更新。\n\n### 2. 总结\n\n-   通过 `Webpack-dev-server` 创建两个服务器：提供静态资源的服务（express）和 Socket 服务\n-   express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）\n-   socket server 是一个 Websocket 的长连接，双方可以通信\n-   当 socket server 监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）\n-   通过长连接，socket server 可以直接将这两个文件主动发送给客户端（浏览器）\n-   浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新\n\n## Webpack Proxy\n\nWebpack Proxy，即 Webpack 提供的代理服务，基本行为就是接收客户端发送的请求后转发给其他服务器，其目的是为了便于开发者在开发模式下解决跨域问题（浏览器安全策略限制）。\n\n想要实现代理首先需要一个中间服务器，Webpack 中提供服务器的工具为 Webpack-dev-server。\n\n### 1. Webpack-dev-server\n\nWebpack-dev-server 是 Webpack 官方推出的一款开发工具，将自动编译和自动刷新浏览器等一系列对开发友好的功能全部集成在了一起，目的是为了提高开发者日常的开发效率，**「只适用在开发阶段」**\n\n配置方面，在 Webpack 配置对象属性中通过 devServer 属性提供，如下：\n\n```js\n// ./Webpack.config.js\nconst path = require(\"path\");\n\nmodule.exports = {\n    devServer: {\n        contentBase: path.join(__dirname, \"dist\"),\n        compress: true,\n        port: 3000,\n        proxy: {\n            \"/api\": {\n                target: \"https://api.xxx.com\",\n            },\n        },\n    },\n};\n```\n\n> 属性：\n>\n> -   target：表示的是代理到的目标地址\n> -   pathRewrite：默认情况下 `/api` 也会被写入到 URL 中，如果希望删除，可以使用 `pathRewrite`\n> -   secure：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 `false`\n> -   changeOrigin：它表示是否更新代理后请求的 `headers` 中 `host` 地址\n\n### 2. 工作原理\n\nproxy 工作原理实质上是利用 `http-proxy-middleware` 这个 http 代理中间件，实现请求转发给其他服务器。\n\n### 3. 跨域\n\n在开发阶段， Webpack-dev-server 会启动一个本地开发服务器，所以我们的应用在开发阶段是独立运行在 localhost 的一个端口上，而后端服务又是运行在另外一个地址上，所以在开发阶段中，由于浏览器同源策略的原因，当本地访问后端就会出现跨域请求的问题。\n\n通过设置 Webpack proxy 实现代理请求后，相当于浏览器与服务端中添加一个代理者，当本地发送请求的时候，代理服务器响应该请求，并将请求转发到目标服务器，目标服务器响应数据后再将数据返回给代理服务器，最终再由代理服务器将数据响应给本地。\n\n**注意：「服务器与服务器之间请求数据并不会存在跨域行为，跨域行为是浏览器安全策略限制」**\n\n## 前端性能优化\n\n### 1. JS 代码压缩\n\n`terser` 是一个 JavaScript 的解释、绞肉机、压缩机的工具集，可以帮助我们压缩、丑化我们的代码，让 bundle 更小\n\n在 `production` 模式下，Webpack 默认使用 TerserPlugin 来处理代码。自定义配置方法如下：\n\n```js\nconst TerserPlugin = require(\"terser-Webpack-plugin\");\nmodule.exports = {\n    optimization: {\n        minimize: true,\n        minimizer: [\n            new TerserPlugin({\n                parallel: true, // 电脑cpu核数-1\n            }),\n        ],\n    },\n};\n```\n\n> 属性：\n>\n> -   extractComments：默认值为 `true`，表示会将注释抽取到一个单独的文件中，开发阶段，我们可设置为 `false` ，不保留注释\n> -   parallel：使用多进程并发运行提高构建的速度，默认值是 `true`，并发运行的默认数量：`os.cpus().length - 1`\n> -   terserOptions：设置我们的 terser 相关的配置：\n>\n>     compress：设置压缩相关的选项\n>     mangle：设置丑化相关的选项，可以直接设置为 `true`\n>     toplevel：底层变量是否进行转换\n>     keep_classnames：保留类的名称\n>     keep_fnames：保留函数的名称\n\n### 2. CSS 代码压缩\n\n使用 `css-minimizer-Webpack-plugin`\n\n```shell\nnpm install css-minimizer-Webpack-plugin -D\n```\n\n```js\nconst CssMinimizerPlugin = require(\"css-minimizer-Webpack-plugin\");\nmodule.exports = {\n    optimization: {\n        minimize: true,\n        minimizer: [\n            new CssMinimizerPlugin({\n                parallel: true,\n            }),\n        ],\n    },\n};\n```\n\n### 3. HTML 文件代码压缩\n\n使用 `HtmlWebpackPlugin` 插件来生成 HTML 的模板时候，通过配置属性 `minify` 进行 html 优化。\n\n```js\nmodule.exports = {\n    plugin: [\n        new HtmlWebpackPlugin({\n            minify: {\n                minifyCSS: false, // 是否压缩css\n                collapseWhitespace: false, // 是否折叠空格\n                removeComments: true, // 是否移除注释\n            },\n        }),\n    ],\n};\n```\n\n设置了 `minify`，实际会使用另一个插件 `html-minifier-terser`\n\n### 4. 文件大小压缩\n\n对文件的大小进行压缩，减少 http 传输过程中宽带的损耗，使用 `compression-Webpack-plugin`。\n\n```js\nnew ComepressionPlugin({\n    test: /\\.(css|js)$/, // 哪些文件需要压缩\n    threshold: 500, // 设置文件多大开始压缩\n    minRatio: 0.7, // 至少压缩的比例\n    algorithm: \"gzip\", // 采用的压缩算法\n});\n```\n\n### 5. 图片压缩\n\n```js\nmodule: {\n    rules: [\n        {\n            test: /\\.(png|jpg|gif)$/,\n            use: [\n                {\n                    loader: \"file-loader\",\n                    options: {\n                        name: \"[name]_[hash].[ext]\",\n                        outputPath: \"images/\",\n                    },\n                },\n                {\n                    loader: \"image-Webpack-loader\",\n                    options: {\n                        // 压缩 jpeg 的配置\n                        mozjpeg: {\n                            progressive: true,\n                            quality: 65,\n                        },\n                        // 使用 imagemin**-optipng 压缩 png，enable: false 为关闭\n                        optipng: {\n                            enabled: false,\n                        },\n                        // 使用 imagemin-pngquant 压缩 png\n                        pngquant: {\n                            quality: \"65-90\",\n                            speed: 4,\n                        },\n                        // 压缩 gif 的配置\n                        gifsicle: {\n                            interlaced: false,\n                        },\n                        // 开启 webp，会把 jpg 和 png 图片压缩为 webp 格式\n                        webp: {\n                            quality: 75,\n                        },\n                    },\n                },\n            ],\n        },\n    ];\n}\n```\n\n### 6. Tree Shaking\n\nTree Shaking 是一个术语，在计算机中表示消除死代码，依赖于 ES Module 的静态语法分析（不执行任何的代码，可以明确知道模块的依赖关系）。\n\n在 Webpack 实现 Tree shaking 有两种不同的方案：\n\n-   usedExports：通过标记某些函数是否被使用，之后通过 Terser 来进行优化的\n-   sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用\n    两种不同的配置方案， 有不同的效果\n\n#### usedExports\n\n```js\nmodule.exports = {\n    optimization: {\n        usedExports: true,\n    },\n};\n```\n\n使用之后，没被用上的代码在 Webpack 打包中会加入 `/* unused harmony export mul */` 注释，用来告知 Terser 在优化时，可以删除掉这段代码。\n\n#### sideEffects\n\nsideEffects 用于告知 Webpack Compiler 哪些模块时有副作用，配置方法是在 `package.json` 中设置 `sideEffects` 属性。\n\n如果 sideEffects 设置为 `false`，就是告知 Webpack 可以安全的删除未用到的 exports。如果有些文件需要保留，可以设置为数组的形式。\n\n```json\n{\n    \"sideEffects\": [\n        \"./src/util/format.js\",\n        \"*.css\" // 所有的css文件\n    ]\n}\n```\n\n#### css tree shaking\n\ncss 进行 tree shaking 优化可以安装 `PurgeCss` 插件。\n\n```js\nconst PurgeCssPlugin = require(\"purgecss-Webpack-plugin\");\nmodule.exports = {\n    plugins: [\n        new PurgeCssPlugin({\n            path: glob.sync(`${path.resolve(\"./src\")}/**/*`),\n            nodir: true, // src里面的所有文件\n            satelist: function () {\n                return {\n                    standard: [\"html\"],\n                };\n            },\n        }),\n    ],\n};\n```\n\n> paths：表示要检测哪些目录下的内容需要被分析，配合使用 glob。\n> 默认情况下，PurgeCss 会将我们的 html 标签的样式移除掉，如果我们希望保留，可以添加一个 `safelist` 的属性。\n\n### 7. 代码分割 (Code Splitting)\n\n将代码分离到不同的 bundle 中，之后我们可以按需加载，或者并行加载这些文件。\n\n默认情况下，所有的 JavaScript 代码（业务代码、第三方依赖、暂时没有用到的模块）在首页全部都加载，就会影响首页的加载速度。\n\n代码分离可以分出出更小的 bundle，以及控制资源加载优先级，提供代码的加载性能。\n\n这里通过 `splitChunksPlugin` 来实现，该插件 Webpack 已经默认安装和集成，只需要配置即可。默认配置中，chunks 仅仅针对于异步（async）请求，我们可以设置为 `initial` 或者 `all`。\n\n```js\nmodule.exports = {\n    optimization: {\n        splitChunks: {\n        minSize: 30000,\n        maxInitialRequests: 5,\n        cacheGroups: {\n          lib: {\n            name: 'vendors',\n            priority: 10,\n            test: /[\\\\/]node_modules[\\\\/]/,\n            chunks: 'initial',\n          },\n          react: {\n            name: 'react',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]react[\\\\/]/,\n            chunks: 'all',\n          },\n          antd: {\n            name: 'antd',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]antd[\\\\/]/,\n            chunks: 'all',\n          },\n          moment: {\n            name: 'moment',\n            priority: 20,\n            test: /[\\\\/]node_modules[\\\\/]moment[\\\\/]/,\n          },\n          default: {\n            minChunks: 2,\n            priority: -20,\n            reuseExistingChunk: true,\n          },\n        },\n    },\n};\n```\n\n> minSize：拆分包的大小，至少为 minSize，如何包的大小不超过 minSize，这个包不会拆分\n> maxSize：将大于 maxSize 的包，拆分为不小于 minSize 的包\n\n#### chunks\n\n1. `async` 表示只从异步加载得模块（动态加载 `import()`）里面进行拆分\n2. `initial` 表示只从入口模块进行拆分\n3. `all` 表示以上两者都包括\n\n#### cacheGroups\n\n1. `name`：chunk 的文件名\n2. `test`：过滤 modules，默认为所有的 modules，可匹配模块路径或 chunk 名字，当匹配到某个 chunk 的名字时，这个 chunk 里面引入的所有 module 都会选中\n3. `priority`：权重，数字越大表示优先级越高。一个 module 可能会满足多个 cacheGroups 的正则匹配，到底将哪个缓存组应用于这个 module，取决于优先级\n4. `reuseExistingChunk`：是否使用已有的 chunk，true 则表示如果当前的 chunk 包含的模块已经被抽取出去了，那么将不会重新生成新的，即几个 chunk 复用被拆分出去的一个 module\n\n### 8. 内联 chunk\n\n可以通过 `InlineChunkHtmlPlugin` 插件将一些 chunk 的模块内联到 html，如 runtime 的代码（对模块进行解析、加载、模块信息相关的代码），代码量并不大，但是必须加载的。\n\n```js\nconst InlineChunkHtmlPlugin = require(\"react-dev-utils/InlineChunkHtmlPlugin\");\nconst HtmlWebpackPlugin = require(\"html-Webpack-plugin\");\nmodule.exports = {\n    plugin: [new InlineChunkHtmlPlugin(HtmlWebpackPlugin, [/runtime.+\\.js/])],\n};\n```\n\n### 9. 总结\n\n关于 Webpack 对前端性能的优化，可以通过文件体积大小入手，其次还可通过分包的形式、减少 http 请求次数等方式，实现对前端性能的优化。\n\n## 提高 Webpack 的构建速度\n\n### 1. 优化 Loader 配置\n\n通过配置 include、exclude、test 属性来匹配文件，接触 include、exclude 规定哪些匹配应用 loader。\n\n```js\n// 配置 babel-loader\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                // 如果项目源码中只有 js 文件就不要写成 /\\.jsx?$/，提升正则表达式性能\n                test: /\\.js$/,\n                // babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启\n                use: [\"babel-loader?cacheDirectory\"],\n                // 只对项目根目录下的 src 目录中的文件采用 babel-loader\n                include: path.resolve(__dirname, \"src\"),\n            },\n        ],\n    },\n};\n```\n\n### 2. 合理使用 resolve.extensions\n\n通过 `resolve.extensions` 是解析到文件时自动添加扩展名，默认情况如下：\n\n```js\nmodule.exports = {\n    extensions: [\".warm\", \".mjs\", \".js\", \".json\"],\n};\n```\n\n引入文件的时候，若没有文件后缀名，则会根据数组内的值依次查找。配置的时候，不要随便把所有后缀都写在里面，这会调用多次文件的查找，减慢打包速度。\n\n### 3. 优化 resolve.modules\n\n`resolve.modules` 用于配置 Webpack 去哪些目录下寻找第三方模块。默认值为 `['node_modules']` ，所以默认会从 node_modules 中查找文件 当安装的第三方模块都放在项目根目录下的 `./node_modules` 目录下时，所以可以指明存放第三方模块的绝对路径，以减少寻找，配置如下：\n\n```js\nmodule.exports = {\n    resolve: {\n        // 使用绝对路径指明第三方模块存放的位置，以减少搜索步骤\n        // 其中 __dirname 表示当前工作目录，也就是项目根目录\n        modules: [path.resolve(__dirname, \"node_modules\")],\n    },\n};\n```\n\n### 4. 优化 resolve.alias\n\nalias 给一些常用的路径起一个别名，特别当我们的项目目录结构比较深的时候，一个文件的路径可能是 `../../../` 的形式。\n\n通过配置 alias 以减少查找过程：\n\n```js\nmodule.exports = {\n    resolve: {\n        alias: {\n            \"@\": path.resolve(__dirname, \"./src\"),\n        },\n    },\n};\n```\n\n### 5. 使用 DLLPlugin 插件\n\nDLL 全称是 动态链接库，是为软件在 Windows 中实现共享函数库的一种实现方式，而 Webpack 也内置了 DLL 的功能，为的就是可以共享，不经常改变的代码，抽成一个共享的库。这个库在之后的编译过程中，会被引入到其他项目的代码中\n\n使用步骤分成两部分：\n\n-   打包一个 DLL 库\n-   引入 DLL 库\n\n#### 打包一个 DLL 库\n\nWebpack 内置了一个 DllPlugin 可以帮助我们打包一个 DLL 的库文件\n\n```js\nmodule.exports = {\n    plugins: [\n        new Webpack.DllPlugin({\n            name: \"dll_[name]\",\n            path: path.resolve(__dirname, \"./dll/[name].mainfest.json\"),\n        }),\n    ],\n};\n```\n\n#### 引入 DLL 库\n\n使用 Webpack 自带的 `DllReferencePlugin` 插件对 `mainfest.json` 映射文件进行分析，获取要使用的 DLL 库，然后再通过 `AddAssetHtmlPlugin` 插件，将打包的 DLL 库引入到 Html 模块中。\n\n```js\nmodule.exports = {\n    plugins: [\n        new Webpack.DllReferencePlugin({\n            context: path.resolve(__dirname, \"./dll/dll_react.js\"),\n            mainfest: path.resolve(__dirname, \"./dll/react.mainfest.json\"),\n        }),\n        new AddAssetHtmlPlugin({\n            outputPath: \"./auto\",\n            filepath: path.resolve(__dirname, \"./dll/dll_react.js\"),\n        }),\n    ],\n};\n```\n\n### 6. 使用 cache-loader\n\n在一些性能开销较大的 loader 之前添加 `cache-loader`，以将结果缓存到磁盘里，显著提升二次构建速度。\n\n保存和读取这些缓存文件会有一些时间开销，所以应只对性能开销较大的 loader 使用此 loader。\n\n```js\nmodule.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.ext$/,\n                use: [\"cache-loader\", ...loaders],\n                include: path.resolve(\"src\"),\n            },\n        ],\n    },\n};\n```\n\n### 7. terser 启动多线程\n\n使用多进程并行运行来提高构建速度。\n\nTerserWebpackPlugin 插件使用 terser 来压缩 JavaScript。\n\n```js\nmodule.exports = {\n    optimization: {\n        minimizer: [\n            new TerserPlugin({\n                parallel: true,\n            }),\n        ],\n    },\n};\n```\n\n### 8. 合理使用 sourceMap\n\n打包生成 sourceMap 的时候，如果信息越详细，打包速度就会越慢。对应属性取值如下所示：\n\n| devtool                        | 构建速度 | 重新构建速度 | 生产环境 | 品质(quality)         |\n| ------------------------------ | -------- | ------------ | -------- | --------------------- |\n| (none)                         | +++      | +++          | yes      | 打包后的代码          |\n| eval                           | +++      | +++          | no       | 生成后的代码          |\n| cheap-eval-source-map          | +        | ++           | no       | 转换过的代码 (仅限行) |\n| cheap-module-eval-source-map   | o        | ++           | no       | 原始源代码 (仅限行)   |\n| eval-source-map                | --       | +            | no       | 原始源代码            |\n| cheap-source-map               | +        | o            | yes      | 转换过的代码 (仅限行) |\n| cheap-module-source-map        | o        | -            | yes      | 原始源代码 (仅限行)   |\n| inline-cheap-source-map        | +        | o            | no       | 转换过的代码 (仅限行) |\n| inline-cheap-module-source-map | o        | -            | no       | 原始源代码 (仅限行)   |\n| source-map                     | --       | --           | yes      | 原始源代码            |\n| inline-source-map              | --       | --           | no       | 原始源代码            |\n| hidden-source-map              | --       | --           | yes      | 原始源代码            |\n| nosources-source-map           | --       | --           | yes      | 无源代码内容          |\n\n> +++ 非常快速 &emsp; ++ 快速 &emsp; + 比较快 &emsp; o 中等 &emsp; - 比较慢 &emsp; -- 慢\n\n### 总结\n\n优化 Webpack 构建的方式有很多，主要可以从优化搜索时间、缩小文件搜索范围、减少不必要的编译等方面入手。\n\n## Webpack 与 grunt、gulp 有什么不同\n\n<img src=\"../.images/image-20210526232017808.png\" alt=\"image-20210526232017808\" style=\"width: 600px;\" />\n\n从上图中可以看出来三者都不在一个频道，自然没有可比性。\n\ngrunt 和 gulp 在早期比较流行，属于前端工具类，主要优化前端工作流程，比如自动刷新页面、combo、压缩 css、js、css 预编译等等。\n\n现在 Webpack 相对来说比较主流，属于预编译模块的方案，不需要在浏览器中加载解释器。另外，在本地直接写 JS，不管是 AMD / CMD / ES6 风格的模块化，Webpack 都能认识，并且编译成浏览器认识的 js。\n\n### 使用上的区别\n\ngrunt 和 gulp 是基于任务和流（Task、Stream）的。类似 jQuery，找到一个（或一类）文件，对其做一系列链式操作，更新流上的数据， 整条链式操作构成了一个任务，多个任务就构成了整个 web 的构建流程。\n\n```js\ngulp.task(\"dev\", function () {\n    // 这个任务的名称是 dev\n    gulp.src(\"src/js/*.js\") //找到 `src/js/` 目录下的所有js\n        .pipe(concat(\"all.js\")) //对其进行合并并且命名为 `all.js`\n        .pipe(uglify()) //压缩\n        .pipe(rename(\"all.min.js\")) //重命名\n        .pipe(gulp.dest(\"dist/js/\")); //输出压缩后的js\n});\n\n//在目录下执行 `gulp dev` 即可执行上述操作\n//grunt 与 gulp 类似，只是稍微繁索一些，现在基本上用不上了\n```\n\nWebpack 是基于入口的。会自动地递归解析入口所需要加载的所有资源文件，然后用不同的 Loader 来处理不同的文件，用 Plugin 来扩展 Webpack 功能。\n\n```js\n// Webpack 具体配置这里不做讲解，形式都大同小异\n\nmodule.exports = {\n    entry: \"./entry.js\", //入口文件\n    output: {\n        filename: \"./bundle.js\", //输出文件\n    },\n    module: {\n        loaders: [...loaders],\n    },\n};\n```\n\n从构建思路来说，gulp 和 grunt 需要开发者将整个前端构建过程拆分成多个 Task，并合理控制所有 Task 的调用关系\nWebpack 需要开发者找到入口，并需要清楚对于不同的资源应该使用什么 Loader 做何种解析和加工。\n\n### 总结\n\n-   gulp、grunt 是 web 构建工具\n-   Webpack 是模块化方案\n-   gulp、grunt 是基于任务和流\n-   Webpack 基于入口文件\n","slug":"webpack","published":1,"updated":"2021-11-01T06:51:18.868Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckvgn6y83001nnwlw87wo44bb","content":"<h1 id=\"Webpack\"><a href=\"#Webpack\" class=\"headerlink\" title=\"Webpack\"></a>Webpack</h1><p><img src=\"/2021/11/01/webpack/webpack-1.png\" alt=\"Webpack\"></p>\n<span id=\"more\"></span>\n\n<h2 id=\"什么是-Webpack\"><a href=\"#什么是-Webpack\" class=\"headerlink\" title=\"什么是 Webpack\"></a>什么是 Webpack</h2><p>Webpack 是一个<strong>模块打包工具</strong> (module bundler)，在 Webpack 里一切文件皆模块。通过 loader 转换文件，通过 plugin 注入钩子，最后输出由多个模块组合的文件。Webpack 专注构建模块化项目。</p>\n<blockquote>\n<p>当 Webpack 处理应用程序时，它会递归地构建一个依赖关系图 (dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p>\n<p>Webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。插件就像是一个插入到生产线中的一个功能，在特定的时机对生产线上的资源做处理。</p>\n<p>Webpack 通过 Tapable 来组织这条复杂的生产线。 Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。 Webpack 的事件流机制保证了插件的有序性，使得整个系统扩展性很好。 – 深入浅出 Webpack 吴浩麟</p>\n</blockquote>\n<p><img src=\"/2021/11/01/webpack/webpack-2.png\" alt=\"Webpack\"></p>\n<h2 id=\"Webpack-核心概念\"><a href=\"#Webpack-核心概念\" class=\"headerlink\" title=\"Webpack 核心概念\"></a>Webpack 核心概念</h2><h3 id=\"1-Entry\"><a href=\"#1-Entry\" class=\"headerlink\" title=\"1. Entry\"></a>1. Entry</h3><p>入口起点 (entry point) 指示 Webpack 应该使用哪个模块，来作为构建其内部依赖图的开始。</p>\n<p>进入入口起点后，Webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。</p>\n<p>每个依赖项随即被处理，最后输出到称之为 bundles 的文件中。</p>\n<h3 id=\"2-Output\"><a href=\"#2-Output\" class=\"headerlink\" title=\"2. Output\"></a>2. Output</h3><p>Output 属性告诉 Webpack 在哪里输出它所创建的 bundles，以及如何命名这些文件，默认值为 <code>./dist</code>。</p>\n<p>基本上，整个应用程序结构，都会被编译到你指定的输出路径的文件夹中。</p>\n<h3 id=\"3-Module\"><a href=\"#3-Module\" class=\"headerlink\" title=\"3. Module\"></a>3. Module</h3><p>模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</p>\n<h3 id=\"4-Chunk\"><a href=\"#4-Chunk\" class=\"headerlink\" title=\"4. Chunk\"></a>4. Chunk</h3><p>代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</p>\n<h3 id=\"5-Loader\"><a href=\"#5-Loader\" class=\"headerlink\" title=\"5. Loader\"></a>5. Loader</h3><p>Loader 让 Webpack 能够去处理那些非 JavaScript 文件（Webpack 自身只理解 JavaScript）。</p>\n<p>Loader 可以将所有类型的文件转换为 Webpack 能够处理的有效模块，然后你就可以利用 Webpack 的打包能力，对它们进行处理。</p>\n<p>本质上，Webpack Loader 将所有类型的文件，转换为应用程序的依赖图（和最终的 bundle）可以直接引用的模块。</p>\n<h3 id=\"6-Plugin\"><a href=\"#6-Plugin\" class=\"headerlink\" title=\"6. Plugin\"></a>6. Plugin</h3><p>Loader 被用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。</p>\n<p>插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能极其强大，可以用来处理各种各样的任务。</p>\n<h2 id=\"Webpack-构建流程\"><a href=\"#Webpack-构建流程\" class=\"headerlink\" title=\"Webpack 构建流程\"></a>Webpack 构建流程</h2><p>Webpack 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程：</p>\n<ol>\n<li><strong>初始化参数</strong>：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数。</li>\n<li><strong>开始编译</strong>：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译。</li>\n<li><strong>确定入口</strong>：根据配置中的 entry 找出所有的入口文件。</li>\n<li><strong>编译模块</strong>：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。<blockquote>\n<p>可以分为三个部分帮助记忆：</p>\n<ul>\n<li>调用各 loader 处理模块之间的依赖</li>\n<li>调用 acorn 解析经 loader 处理后的源文件生成抽象语法树 AST</li>\n<li>遍历 AST，构建该模块所依赖的模块</li>\n</ul>\n</blockquote>\n</li>\n<li><strong>完成模块编译</strong>：在经过第 4 步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li>\n<li><strong>输出资源</strong>：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会。</li>\n<li><strong>输出完成</strong>：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。</li>\n</ol>\n<p>在以上过程中，Webpack 会在特定的时间点广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。</p>\n<h2 id=\"Loader\"><a href=\"#Loader\" class=\"headerlink\" title=\"Loader\"></a>Loader</h2><p>Loader 用于对模块的源代码进行转换，在 import 或”加载”模块时预处理文件</p>\n<h3 id=\"1-配置方式\"><a href=\"#1-配置方式\" class=\"headerlink\" title=\"1. 配置方式\"></a>1. 配置方式</h3><p>Loader 的配置写在 <code>module.rules</code> 属性中：</p>\n<ul>\n<li>  <code>rules</code> 是一个数组的形式，可以配置很多个 Loader</li>\n<li>  每一个 Loader 对应一个对象的形式，对象属性 <code>test</code> 为匹配的规则，一般情况为正则表达式</li>\n<li>  属性 <code>use</code> 针对匹配到文件类型，调用对应的 Loader 进行处理</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">                use: [</span><br><span class=\"line\">                    &#123; <span class=\"attr\">loader</span>: <span class=\"string\">&quot;style-loader&quot;</span> &#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"attr\">loader</span>: <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">                        <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">modules</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &#123; <span class=\"attr\">loader</span>: <span class=\"string\">&quot;sass-loader&quot;</span> &#125;,</span><br><span class=\"line\">                ],</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-特性\"><a href=\"#2-特性\" class=\"headerlink\" title=\"2. 特性\"></a>2. 特性</h3><p>Loader 支持链式调用，链中的每个 Loader 会处理之前已处理过的资源，最终变为 js 代码，顺序为相反的顺序执行。</p>\n<p>Loader 的特性：</p>\n<ul>\n<li>  Loader 可以是同步的，也可以是异步的</li>\n<li>  Loader 运行在 Node.js 中，并且能够执行任何操作</li>\n<li>  除了常见的通过 package.json 的 main 来将一个 npm 模块导出为 Loader，还可以在 module.rules 中使用 Loader 字段直接引用一个模块</li>\n<li>  插件(plugin) 可以为 Loader 带来更多特性</li>\n<li>  Loader 能够产生额外的任意文件</li>\n</ul>\n<h3 id=\"3-常见的-Loader\"><a href=\"#3-常见的-Loader\" class=\"headerlink\" title=\"3. 常见的 Loader\"></a>3. 常见的 Loader</h3><table>\n<thead>\n<tr>\n<th>Loader</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>style-loader</td>\n<td>将 css 添加到 DOM 的内联样式标签 <code>style</code> 里</td>\n</tr>\n<tr>\n<td>css-loader</td>\n<td>允许将 css 文件通过 <code>require</code> 的方式引入，并返回 css 代码</td>\n</tr>\n<tr>\n<td>less-loader</td>\n<td>处理 less</td>\n</tr>\n<tr>\n<td>sass-loader</td>\n<td>处理 sass</td>\n</tr>\n<tr>\n<td>postcss-loader</td>\n<td>用 postcss 来处理 CSS</td>\n</tr>\n<tr>\n<td>autoprefixer-loader</td>\n<td>处理 CSS3 属性前缀，已被弃用，建议直接使用 postcss</td>\n</tr>\n<tr>\n<td>file-loader</td>\n<td>分发文件到 output 目录并返回相对路径</td>\n</tr>\n<tr>\n<td>url-loader</td>\n<td>和 file-loader 类似，但是当文件小于设定的 limit 时可以返回一个 Data Url</td>\n</tr>\n<tr>\n<td>html-minify-loader</td>\n<td>压缩 HTML</td>\n</tr>\n<tr>\n<td>babel-loader</td>\n<td>用 babel 来转换 ES6 文件到 ES5</td>\n</tr>\n</tbody></table>\n<h2 id=\"Plugin\"><a href=\"#Plugin\" class=\"headerlink\" title=\"Plugin\"></a>Plugin</h2><p>Plugin 赋予其各种灵活的功能，例如打包优化、资源管理、环境变量注入等，它们会运行在 Webpack 的不同阶段（钩子 / 生命周期），贯穿了 Webpack 整个编译周期。</p>\n<p>Plugin 目的在于解决 Loader 无法实现的其他事。</p>\n<h3 id=\"1-配置方式-1\"><a href=\"#1-配置方式-1\" class=\"headerlink\" title=\"1. 配置方式\"></a>1. 配置方式</h3><p>通过配置文件导出对象中 <code>plugins</code> 属性传入 new 实例对象。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> Webpack = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;Webpack&quot;</span>); <span class=\"comment\">// 访问内置的插件</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.ProgressPlugin(),</span><br><span class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123; <span class=\"attr\">template</span>: <span class=\"string\">&quot;./src/index.html&quot;</span> &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-特性-1\"><a href=\"#2-特性-1\" class=\"headerlink\" title=\"2. 特性\"></a>2. 特性</h3><p>其本质是一个具有 <code>apply</code> 方法 javascript 对象</p>\n<p><code>apply</code> 方法会被 Webpack compiler 调用，并且在整个编译生命周期都可以访问 compiler 对象</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> pluginName = <span class=\"string\">&quot;ConsoleLogOnBuildWebpackPlugin&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConsoleLogOnBuildWebpackPlugin</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"title\">apply</span>(<span class=\"params\">compiler</span>)</span> &#123;</span><br><span class=\"line\">        compiler.hooks.run.tap(pluginName, <span class=\"function\"><span class=\"params\">compilation</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;Webpack 构建过程开始！&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = ConsoleLogOnBuildWebpackPlugin;</span><br></pre></td></tr></table></figure>\n\n<p>compiler hook 的 <code>tap</code> 方法的第一个参数，应是驼峰式命名的插件名称</p>\n<p>关于整个编译生命周期钩子，有如下：</p>\n<blockquote>\n<ul>\n<li>  <code>entry-option</code>：初始化 option</li>\n<li>  <code>run</code></li>\n<li>  <code>compile</code>：真正开始的编译，在创建 compilation 对象之前</li>\n<li>  <code>compilation</code>：生成好了 compilation 对象</li>\n<li>  <code>make</code>： 从 entry 开始递归分析依赖，准备对每个模块进行 build</li>\n<li>  <code>after-compile</code>：编译 build 过程结束</li>\n<li>  <code>emit</code>：在将内存中 assets 内容写到磁盘文件夹之前</li>\n<li>  <code>after-emit</code>：在将内存中 assets 内容写到磁盘文件夹之后</li>\n<li>  <code>done</code>：完成所有的编译过程</li>\n<li>  <code>failed</code>：编译失败的时候</li>\n</ul>\n</blockquote>\n<h3 id=\"3-常见的-Plugin\"><a href=\"#3-常见的-Plugin\" class=\"headerlink\" title=\"3. 常见的 Plugin\"></a>3. 常见的 Plugin</h3><table>\n<thead>\n<tr>\n<th>Plugin</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AggressiveSplittingPlugin</td>\n<td>将原来的 chunk 分成更小的 chunk</td>\n</tr>\n<tr>\n<td>BabelMinifyWebpackPlugin</td>\n<td>使用 babel-minify 进行压缩</td>\n</tr>\n<tr>\n<td>BannerPlugin</td>\n<td>在每个生成的 chunk 顶部添加 banner</td>\n</tr>\n<tr>\n<td>CommonsChunkPlugin</td>\n<td>提取 chunks 之间共享的通用模块</td>\n</tr>\n<tr>\n<td>CompressionWebpackPlugin</td>\n<td>预先准备的资源压缩版本，使用 Content-Encoding 提供访问服务</td>\n</tr>\n<tr>\n<td>ContextReplacementPlugin</td>\n<td>重写 require 表达式的推断上下文</td>\n</tr>\n<tr>\n<td>CopyWebpackPlugin</td>\n<td>将单个文件或整个目录复制到构建目录</td>\n</tr>\n<tr>\n<td>DefinePlugin</td>\n<td>允许在编译时(compile time) 配置的全局常量</td>\n</tr>\n<tr>\n<td>Dllplugin</td>\n<td>为了极大减小构建时间，进行分离打包</td>\n</tr>\n<tr>\n<td>EnvironmentPlugin</td>\n<td>DefinePlugin 中的 process.env 键的简写方式</td>\n</tr>\n<tr>\n<td>ExtractTextWebpackPlugin</td>\n<td>从 bundel 中提取文本(CSS) 到单独的文件</td>\n</tr>\n<tr>\n<td>HotModuleReplacementPlugin</td>\n<td>启用模块热替换 (Enable Hot Module Replacement - HMR)</td>\n</tr>\n<tr>\n<td>HtmlWebpackPlugin</td>\n<td>简单创建 HTML 文件，用于服务器访问</td>\n</tr>\n<tr>\n<td>I18nWebpackPlugin</td>\n<td>为 bundle 增加国际化支持</td>\n</tr>\n<tr>\n<td>IgnorePlugin</td>\n<td>从 bundle 中排除某些模块</td>\n</tr>\n<tr>\n<td>LimitChunkCountPlugin</td>\n<td>设置 chunk 的最小/最大限制，以微调和控制 chunk</td>\n</tr>\n<tr>\n<td>LoaderOptionsPlugin</td>\n<td>用于从 Webpack1 迁移到 Webpack2</td>\n</tr>\n<tr>\n<td>MinChunkSizePlugin</td>\n<td>确保 chunk 大小超过指定限制</td>\n</tr>\n<tr>\n<td>NoEmitOnErrorsPlugin</td>\n<td>在输出阶段时，遇到编译错误跳过</td>\n</tr>\n<tr>\n<td>NormalModuleReplacementPlugin</td>\n<td>替换与正则表达式匹配的资源</td>\n</tr>\n</tbody></table>\n<h2 id=\"Loader-和-Plugin-的区别\"><a href=\"#Loader-和-Plugin-的区别\" class=\"headerlink\" title=\"Loader 和 Plugin 的区别\"></a>Loader 和 Plugin 的区别</h2><ul>\n<li>  Loader 运行在打包文件之前</li>\n<li>  Plugin 在整个编译周期都起作用</li>\n</ul>\n<p>在 Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果。</p>\n<p>对于 Loader，实质是一个转换器，比如将 A.scss 或 A.less 转变为 B.css，单纯的文件转换过程。</p>\n<h2 id=\"Webpack-热更新\"><a href=\"#Webpack-热更新\" class=\"headerlink\" title=\"Webpack 热更新\"></a>Webpack 热更新</h2><h3 id=\"1-实现原理\"><a href=\"#1-实现原理\" class=\"headerlink\" title=\"1. 实现原理\"></a>1. 实现原理</h3><img src=\"../.images/image-20210526112504058.png\" alt=\"image-20210526112504058\" style=\"width: 600px;\">\n\n<ul>\n<li>  Webpack Compile：将 JS 源代码编译成 bundle.js</li>\n<li>  HMR Server：用来将热更新的文件输出给 HMR Runtime</li>\n<li>  Bundle Server：静态资源文件服务器，提供文件访问路径</li>\n<li>  HMR Runtime：socket 服务器，会被注入到浏览器，更新文件的变化</li>\n<li>  bundle.js：构建输出的文件</li>\n<li>  在 HMR Runtime 和 HMR Server 之间建立 Websocket，即 4⃣️ ，用于实时更新文件变化</li>\n</ul>\n<h4 id=\"启动阶段\"><a href=\"#启动阶段\" class=\"headerlink\" title=\"启动阶段\"></a>启动阶段</h4><p>1 -&gt; 2 -&gt; A -&gt; B<br>在编写未经过 Webpack 打包的源代码后，Webpack Compile 将源代码和 HMR Runtime 一起编译成 bundle 文件，传输给 Bundle Server 静态资源服务器。</p>\n<h4 id=\"更新阶段\"><a href=\"#更新阶段\" class=\"headerlink\" title=\"更新阶段\"></a>更新阶段</h4><p>1 -&gt; 2 -&gt; 3 -&gt; 4</p>\n<p>当某一个文件或者模块发生变化时，Webpack 监听到文件变化对文件重新编译打包，编译生成唯一的 hash 值（下图 <code>h</code> 属性），这个 hash 值用来作为下一次热更新的标识。</p>\n<p>根据变化的内容生成两个补丁文件：<code>manifest</code>（包含了 hash 和 chundId，用来说明变化的内容）和 <code>chunk.js</code> 模块。</p>\n<p>由于 socket 服务器在 HMR Runtime 和 HMR Server 之间建立 Websocket 链接，当文件发生改动的时候，服务端会向浏览器推送一条消息，消息包含文件改动后生成的 hash 值，作为下一次热更新的标识。<br><img src=\"../.images/image-20210526145412513.png\" alt=\"image-20210526145412513\" style=\"width:600px;\"></p>\n<p>在浏览器接受到这条消息之前，浏览器已经在上一次 socket 消息中已经记住了此时的 hash 标识，这时候会去服务端获取变化内容的 manifest 文件。</p>\n<p>mainfest 文件包含重新 build 生成的 hash 值，以及变化的模块（上图 <code>c</code> 属性）。</p>\n<p>浏览器根据 manifest 文件获取模块变化的内容，从而触发 render 流程，实现局部模块更新。</p>\n<h3 id=\"2-总结\"><a href=\"#2-总结\" class=\"headerlink\" title=\"2. 总结\"></a>2. 总结</h3><ul>\n<li>  通过 <code>Webpack-dev-server</code> 创建两个服务器：提供静态资源的服务（express）和 Socket 服务</li>\n<li>  express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）</li>\n<li>  socket server 是一个 Websocket 的长连接，双方可以通信</li>\n<li>  当 socket server 监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）</li>\n<li>  通过长连接，socket server 可以直接将这两个文件主动发送给客户端（浏览器）</li>\n<li>  浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新</li>\n</ul>\n<h2 id=\"Webpack-Proxy\"><a href=\"#Webpack-Proxy\" class=\"headerlink\" title=\"Webpack Proxy\"></a>Webpack Proxy</h2><p>Webpack Proxy，即 Webpack 提供的代理服务，基本行为就是接收客户端发送的请求后转发给其他服务器，其目的是为了便于开发者在开发模式下解决跨域问题（浏览器安全策略限制）。</p>\n<p>想要实现代理首先需要一个中间服务器，Webpack 中提供服务器的工具为 Webpack-dev-server。</p>\n<h3 id=\"1-Webpack-dev-server\"><a href=\"#1-Webpack-dev-server\" class=\"headerlink\" title=\"1. Webpack-dev-server\"></a>1. Webpack-dev-server</h3><p>Webpack-dev-server 是 Webpack 官方推出的一款开发工具，将自动编译和自动刷新浏览器等一系列对开发友好的功能全部集成在了一起，目的是为了提高开发者日常的开发效率，<strong>「只适用在开发阶段」</strong></p>\n<p>配置方面，在 Webpack 配置对象属性中通过 devServer 属性提供，如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ./Webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;path&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">contentBase</span>: path.join(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">        <span class=\"attr\">compress</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">port</span>: <span class=\"number\">3000</span>,</span><br><span class=\"line\">        <span class=\"attr\">proxy</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;/api&quot;</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">target</span>: <span class=\"string\">&quot;https://api.xxx.com&quot;</span>,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>属性：</p>\n<ul>\n<li>  target：表示的是代理到的目标地址</li>\n<li>  pathRewrite：默认情况下 <code>/api</code> 也会被写入到 URL 中，如果希望删除，可以使用 <code>pathRewrite</code></li>\n<li>  secure：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 <code>false</code></li>\n<li>  changeOrigin：它表示是否更新代理后请求的 <code>headers</code> 中 <code>host</code> 地址</li>\n</ul>\n</blockquote>\n<h3 id=\"2-工作原理\"><a href=\"#2-工作原理\" class=\"headerlink\" title=\"2. 工作原理\"></a>2. 工作原理</h3><p>proxy 工作原理实质上是利用 <code>http-proxy-middleware</code> 这个 http 代理中间件，实现请求转发给其他服务器。</p>\n<h3 id=\"3-跨域\"><a href=\"#3-跨域\" class=\"headerlink\" title=\"3. 跨域\"></a>3. 跨域</h3><p>在开发阶段， Webpack-dev-server 会启动一个本地开发服务器，所以我们的应用在开发阶段是独立运行在 localhost 的一个端口上，而后端服务又是运行在另外一个地址上，所以在开发阶段中，由于浏览器同源策略的原因，当本地访问后端就会出现跨域请求的问题。</p>\n<p>通过设置 Webpack proxy 实现代理请求后，相当于浏览器与服务端中添加一个代理者，当本地发送请求的时候，代理服务器响应该请求，并将请求转发到目标服务器，目标服务器响应数据后再将数据返回给代理服务器，最终再由代理服务器将数据响应给本地。</p>\n<p><strong>注意：「服务器与服务器之间请求数据并不会存在跨域行为，跨域行为是浏览器安全策略限制」</strong></p>\n<h2 id=\"前端性能优化\"><a href=\"#前端性能优化\" class=\"headerlink\" title=\"前端性能优化\"></a>前端性能优化</h2><h3 id=\"1-JS-代码压缩\"><a href=\"#1-JS-代码压缩\" class=\"headerlink\" title=\"1. JS 代码压缩\"></a>1. JS 代码压缩</h3><p><code>terser</code> 是一个 JavaScript 的解释、绞肉机、压缩机的工具集，可以帮助我们压缩、丑化我们的代码，让 bundle 更小</p>\n<p>在 <code>production</code> 模式下，Webpack 默认使用 TerserPlugin 来处理代码。自定义配置方法如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TerserPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;terser-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> TerserPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 电脑cpu核数-1</span></span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>属性：</p>\n<ul>\n<li><p>  extractComments：默认值为 <code>true</code>，表示会将注释抽取到一个单独的文件中，开发阶段，我们可设置为 <code>false</code> ，不保留注释</p>\n</li>\n<li><p>  parallel：使用多进程并发运行提高构建的速度，默认值是 <code>true</code>，并发运行的默认数量：<code>os.cpus().length - 1</code></p>\n</li>\n<li><p>terserOptions：设置我们的 terser 相关的配置：</p>\n<p>  compress：设置压缩相关的选项<br>  mangle：设置丑化相关的选项，可以直接设置为 <code>true</code><br>  toplevel：底层变量是否进行转换<br>  keep_classnames：保留类的名称<br>  keep_fnames：保留函数的名称</p>\n</li>\n</ul>\n</blockquote>\n<h3 id=\"2-CSS-代码压缩\"><a href=\"#2-CSS-代码压缩\" class=\"headerlink\" title=\"2. CSS 代码压缩\"></a>2. CSS 代码压缩</h3><p>使用 <code>css-minimizer-Webpack-plugin</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install css-minimizer-Webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> CssMinimizerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;css-minimizer-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> CssMinimizerPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-HTML-文件代码压缩\"><a href=\"#3-HTML-文件代码压缩\" class=\"headerlink\" title=\"3. HTML 文件代码压缩\"></a>3. HTML 文件代码压缩</h3><p>使用 <code>HtmlWebpackPlugin</code> 插件来生成 HTML 的模板时候，通过配置属性 <code>minify</code> 进行 html 优化。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugin</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">minify</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">minifyCSS</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否压缩css</span></span><br><span class=\"line\">                <span class=\"attr\">collapseWhitespace</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否折叠空格</span></span><br><span class=\"line\">                <span class=\"attr\">removeComments</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否移除注释</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>设置了 <code>minify</code>，实际会使用另一个插件 <code>html-minifier-terser</code></p>\n<h3 id=\"4-文件大小压缩\"><a href=\"#4-文件大小压缩\" class=\"headerlink\" title=\"4. 文件大小压缩\"></a>4. 文件大小压缩</h3><p>对文件的大小进行压缩，减少 http 传输过程中宽带的损耗，使用 <code>compression-Webpack-plugin</code>。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> ComepressionPlugin(&#123;</span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(css|js)$/</span>, <span class=\"comment\">// 哪些文件需要压缩</span></span><br><span class=\"line\">    threshold: <span class=\"number\">500</span>, <span class=\"comment\">// 设置文件多大开始压缩</span></span><br><span class=\"line\">    <span class=\"attr\">minRatio</span>: <span class=\"number\">0.7</span>, <span class=\"comment\">// 至少压缩的比例</span></span><br><span class=\"line\">    <span class=\"attr\">algorithm</span>: <span class=\"string\">&quot;gzip&quot;</span>, <span class=\"comment\">// 采用的压缩算法</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5-图片压缩\"><a href=\"#5-图片压缩\" class=\"headerlink\" title=\"5. 图片压缩\"></a>5. 图片压缩</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpg|gif)$/</span>,</span><br><span class=\"line\">            use: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">loader</span>: <span class=\"string\">&quot;file-loader&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                        <span class=\"attr\">name</span>: <span class=\"string\">&quot;[name]_[hash].[ext]&quot;</span>,</span><br><span class=\"line\">                        <span class=\"attr\">outputPath</span>: <span class=\"string\">&quot;images/&quot;</span>,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">loader</span>: <span class=\"string\">&quot;image-Webpack-loader&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// 压缩 jpeg 的配置</span></span><br><span class=\"line\">                        <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">progressive</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"number\">65</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 使用 imagemin**-optipng 压缩 png，enable: false 为关闭</span></span><br><span class=\"line\">                        <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">enabled</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 使用 imagemin-pngquant 压缩 png</span></span><br><span class=\"line\">                        <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"string\">&quot;65-90&quot;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 压缩 gif 的配置</span></span><br><span class=\"line\">                        <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 开启 webp，会把 jpg 和 png 图片压缩为 webp 格式</span></span><br><span class=\"line\">                        <span class=\"attr\">webp</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"number\">75</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">            ],</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-Tree-Shaking\"><a href=\"#6-Tree-Shaking\" class=\"headerlink\" title=\"6. Tree Shaking\"></a>6. Tree Shaking</h3><p>Tree Shaking 是一个术语，在计算机中表示消除死代码，依赖于 ES Module 的静态语法分析（不执行任何的代码，可以明确知道模块的依赖关系）。</p>\n<p>在 Webpack 实现 Tree shaking 有两种不同的方案：</p>\n<ul>\n<li>  usedExports：通过标记某些函数是否被使用，之后通过 Terser 来进行优化的</li>\n<li>sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用<br>  两种不同的配置方案， 有不同的效果</li>\n</ul>\n<h4 id=\"usedExports\"><a href=\"#usedExports\" class=\"headerlink\" title=\"usedExports\"></a>usedExports</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">usedExports</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>使用之后，没被用上的代码在 Webpack 打包中会加入 <code>/* unused harmony export mul */</code> 注释，用来告知 Terser 在优化时，可以删除掉这段代码。</p>\n<h4 id=\"sideEffects\"><a href=\"#sideEffects\" class=\"headerlink\" title=\"sideEffects\"></a>sideEffects</h4><p>sideEffects 用于告知 Webpack Compiler 哪些模块时有副作用，配置方法是在 <code>package.json</code> 中设置 <code>sideEffects</code> 属性。</p>\n<p>如果 sideEffects 设置为 <code>false</code>，就是告知 Webpack 可以安全的删除未用到的 exports。如果有些文件需要保留，可以设置为数组的形式。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">&quot;sideEffects&quot;</span>: [</span><br><span class=\"line\">        <span class=\"string\">&quot;./src/util/format.js&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;*.css&quot;</span> <span class=\"comment\">// 所有的css文件</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"css-tree-shaking\"><a href=\"#css-tree-shaking\" class=\"headerlink\" title=\"css tree shaking\"></a>css tree shaking</h4><p>css 进行 tree shaking 优化可以安装 <code>PurgeCss</code> 插件。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PurgeCssPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;purgecss-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> PurgeCssPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">path</span>: glob.sync(<span class=\"string\">`<span class=\"subst\">$&#123;path.resolve(<span class=\"string\">&quot;./src&quot;</span>)&#125;</span>/**/*`</span>),</span><br><span class=\"line\">            <span class=\"attr\">nodir</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// src里面的所有文件</span></span><br><span class=\"line\">            <span class=\"attr\">satelist</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                    <span class=\"attr\">standard</span>: [<span class=\"string\">&quot;html&quot;</span>],</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>paths：表示要检测哪些目录下的内容需要被分析，配合使用 glob。<br>默认情况下，PurgeCss 会将我们的 html 标签的样式移除掉，如果我们希望保留，可以添加一个 <code>safelist</code> 的属性。</p>\n</blockquote>\n<h3 id=\"7-代码分割-Code-Splitting\"><a href=\"#7-代码分割-Code-Splitting\" class=\"headerlink\" title=\"7. 代码分割 (Code Splitting)\"></a>7. 代码分割 (Code Splitting)</h3><p>将代码分离到不同的 bundle 中，之后我们可以按需加载，或者并行加载这些文件。</p>\n<p>默认情况下，所有的 JavaScript 代码（业务代码、第三方依赖、暂时没有用到的模块）在首页全部都加载，就会影响首页的加载速度。</p>\n<p>代码分离可以分出出更小的 bundle，以及控制资源加载优先级，提供代码的加载性能。</p>\n<p>这里通过 <code>splitChunksPlugin</code> 来实现，该插件 Webpack 已经默认安装和集成，只需要配置即可。默认配置中，chunks 仅仅针对于异步（async）请求，我们可以设置为 <code>initial</code> 或者 <code>all</code>。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minSize</span>: <span class=\"number\">30000</span>,</span><br><span class=\"line\">        <span class=\"attr\">maxInitialRequests</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">cacheGroups</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">lib</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;vendors&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;initial&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">react</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;react&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]react[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;all&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">antd</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;antd&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]antd[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;all&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">moment</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;moment&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]moment[\\\\/]/</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">default</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">minChunks</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: -<span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">reuseExistingChunk</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>minSize：拆分包的大小，至少为 minSize，如何包的大小不超过 minSize，这个包不会拆分<br>maxSize：将大于 maxSize 的包，拆分为不小于 minSize 的包</p>\n</blockquote>\n<h4 id=\"chunks\"><a href=\"#chunks\" class=\"headerlink\" title=\"chunks\"></a>chunks</h4><ol>\n<li><code>async</code> 表示只从异步加载得模块（动态加载 <code>import()</code>）里面进行拆分</li>\n<li><code>initial</code> 表示只从入口模块进行拆分</li>\n<li><code>all</code> 表示以上两者都包括</li>\n</ol>\n<h4 id=\"cacheGroups\"><a href=\"#cacheGroups\" class=\"headerlink\" title=\"cacheGroups\"></a>cacheGroups</h4><ol>\n<li><code>name</code>：chunk 的文件名</li>\n<li><code>test</code>：过滤 modules，默认为所有的 modules，可匹配模块路径或 chunk 名字，当匹配到某个 chunk 的名字时，这个 chunk 里面引入的所有 module 都会选中</li>\n<li><code>priority</code>：权重，数字越大表示优先级越高。一个 module 可能会满足多个 cacheGroups 的正则匹配，到底将哪个缓存组应用于这个 module，取决于优先级</li>\n<li><code>reuseExistingChunk</code>：是否使用已有的 chunk，true 则表示如果当前的 chunk 包含的模块已经被抽取出去了，那么将不会重新生成新的，即几个 chunk 复用被拆分出去的一个 module</li>\n</ol>\n<h3 id=\"8-内联-chunk\"><a href=\"#8-内联-chunk\" class=\"headerlink\" title=\"8. 内联 chunk\"></a>8. 内联 chunk</h3><p>可以通过 <code>InlineChunkHtmlPlugin</code> 插件将一些 chunk 的模块内联到 html，如 runtime 的代码（对模块进行解析、加载、模块信息相关的代码），代码量并不大，但是必须加载的。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> InlineChunkHtmlPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;react-dev-utils/InlineChunkHtmlPlugin&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugin</span>: [<span class=\"keyword\">new</span> InlineChunkHtmlPlugin(HtmlWebpackPlugin, [<span class=\"regexp\">/runtime.+\\.js/</span>])],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9-总结\"><a href=\"#9-总结\" class=\"headerlink\" title=\"9. 总结\"></a>9. 总结</h3><p>关于 Webpack 对前端性能的优化，可以通过文件体积大小入手，其次还可通过分包的形式、减少 http 请求次数等方式，实现对前端性能的优化。</p>\n<h2 id=\"提高-Webpack-的构建速度\"><a href=\"#提高-Webpack-的构建速度\" class=\"headerlink\" title=\"提高 Webpack 的构建速度\"></a>提高 Webpack 的构建速度</h2><h3 id=\"1-优化-Loader-配置\"><a href=\"#1-优化-Loader-配置\" class=\"headerlink\" title=\"1. 优化 Loader 配置\"></a>1. 优化 Loader 配置</h3><p>通过配置 include、exclude、test 属性来匹配文件，接触 include、exclude 规定哪些匹配应用 loader。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 配置 babel-loader</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 如果项目源码中只有 js 文件就不要写成 /\\.jsx?$/，提升正则表达式性能</span></span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">                <span class=\"comment\">// babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启</span></span><br><span class=\"line\">                use: [<span class=\"string\">&quot;babel-loader?cacheDirectory&quot;</span>],</span><br><span class=\"line\">                <span class=\"comment\">// 只对项目根目录下的 src 目录中的文件采用 babel-loader</span></span><br><span class=\"line\">                <span class=\"attr\">include</span>: path.resolve(__dirname, <span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-合理使用-resolve-extensions\"><a href=\"#2-合理使用-resolve-extensions\" class=\"headerlink\" title=\"2. 合理使用 resolve.extensions\"></a>2. 合理使用 resolve.extensions</h3><p>通过 <code>resolve.extensions</code> 是解析到文件时自动添加扩展名，默认情况如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">extensions</span>: [<span class=\"string\">&quot;.warm&quot;</span>, <span class=\"string\">&quot;.mjs&quot;</span>, <span class=\"string\">&quot;.js&quot;</span>, <span class=\"string\">&quot;.json&quot;</span>],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>引入文件的时候，若没有文件后缀名，则会根据数组内的值依次查找。配置的时候，不要随便把所有后缀都写在里面，这会调用多次文件的查找，减慢打包速度。</p>\n<h3 id=\"3-优化-resolve-modules\"><a href=\"#3-优化-resolve-modules\" class=\"headerlink\" title=\"3. 优化 resolve.modules\"></a>3. 优化 resolve.modules</h3><p><code>resolve.modules</code> 用于配置 Webpack 去哪些目录下寻找第三方模块。默认值为 <code>[&#39;node_modules&#39;]</code> ，所以默认会从 node_modules 中查找文件 当安装的第三方模块都放在项目根目录下的 <code>./node_modules</code> 目录下时，所以可以指明存放第三方模块的绝对路径，以减少寻找，配置如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 使用绝对路径指明第三方模块存放的位置，以减少搜索步骤</span></span><br><span class=\"line\">        <span class=\"comment\">// 其中 __dirname 表示当前工作目录，也就是项目根目录</span></span><br><span class=\"line\">        <span class=\"attr\">modules</span>: [path.resolve(__dirname, <span class=\"string\">&quot;node_modules&quot;</span>)],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-优化-resolve-alias\"><a href=\"#4-优化-resolve-alias\" class=\"headerlink\" title=\"4. 优化 resolve.alias\"></a>4. 优化 resolve.alias</h3><p>alias 给一些常用的路径起一个别名，特别当我们的项目目录结构比较深的时候，一个文件的路径可能是 <code>../../../</code> 的形式。</p>\n<p>通过配置 alias 以减少查找过程：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;@&quot;</span>: path.resolve(__dirname, <span class=\"string\">&quot;./src&quot;</span>),</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5-使用-DLLPlugin-插件\"><a href=\"#5-使用-DLLPlugin-插件\" class=\"headerlink\" title=\"5. 使用 DLLPlugin 插件\"></a>5. 使用 DLLPlugin 插件</h3><p>DLL 全称是 动态链接库，是为软件在 Windows 中实现共享函数库的一种实现方式，而 Webpack 也内置了 DLL 的功能，为的就是可以共享，不经常改变的代码，抽成一个共享的库。这个库在之后的编译过程中，会被引入到其他项目的代码中</p>\n<p>使用步骤分成两部分：</p>\n<ul>\n<li>  打包一个 DLL 库</li>\n<li>  引入 DLL 库</li>\n</ul>\n<h4 id=\"打包一个-DLL-库\"><a href=\"#打包一个-DLL-库\" class=\"headerlink\" title=\"打包一个 DLL 库\"></a>打包一个 DLL 库</h4><p>Webpack 内置了一个 DllPlugin 可以帮助我们打包一个 DLL 的库文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.DllPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&quot;dll_[name]&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/[name].mainfest.json&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"引入-DLL-库\"><a href=\"#引入-DLL-库\" class=\"headerlink\" title=\"引入 DLL 库\"></a>引入 DLL 库</h4><p>使用 Webpack 自带的 <code>DllReferencePlugin</code> 插件对 <code>mainfest.json</code> 映射文件进行分析，获取要使用的 DLL 库，然后再通过 <code>AddAssetHtmlPlugin</code> 插件，将打包的 DLL 库引入到 Html 模块中。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.DllReferencePlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">context</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/dll_react.js&quot;</span>),</span><br><span class=\"line\">            <span class=\"attr\">mainfest</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/react.mainfest.json&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">        <span class=\"keyword\">new</span> AddAssetHtmlPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">outputPath</span>: <span class=\"string\">&quot;./auto&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">filepath</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/dll_react.js&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-使用-cache-loader\"><a href=\"#6-使用-cache-loader\" class=\"headerlink\" title=\"6. 使用 cache-loader\"></a>6. 使用 cache-loader</h3><p>在一些性能开销较大的 loader 之前添加 <code>cache-loader</code>，以将结果缓存到磁盘里，显著提升二次构建速度。</p>\n<p>保存和读取这些缓存文件会有一些时间开销，所以应只对性能开销较大的 loader 使用此 loader。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.ext$/</span>,</span><br><span class=\"line\">                use: [<span class=\"string\">&quot;cache-loader&quot;</span>, ...loaders],</span><br><span class=\"line\">                <span class=\"attr\">include</span>: path.resolve(<span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7-terser-启动多线程\"><a href=\"#7-terser-启动多线程\" class=\"headerlink\" title=\"7. terser 启动多线程\"></a>7. terser 启动多线程</h3><p>使用多进程并行运行来提高构建速度。</p>\n<p>TerserWebpackPlugin 插件使用 terser 来压缩 JavaScript。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> TerserPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8-合理使用-sourceMap\"><a href=\"#8-合理使用-sourceMap\" class=\"headerlink\" title=\"8. 合理使用 sourceMap\"></a>8. 合理使用 sourceMap</h3><p>打包生成 sourceMap 的时候，如果信息越详细，打包速度就会越慢。对应属性取值如下所示：</p>\n<table>\n<thead>\n<tr>\n<th>devtool</th>\n<th>构建速度</th>\n<th>重新构建速度</th>\n<th>生产环境</th>\n<th>品质(quality)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>(none)</td>\n<td>+++</td>\n<td>+++</td>\n<td>yes</td>\n<td>打包后的代码</td>\n</tr>\n<tr>\n<td>eval</td>\n<td>+++</td>\n<td>+++</td>\n<td>no</td>\n<td>生成后的代码</td>\n</tr>\n<tr>\n<td>cheap-eval-source-map</td>\n<td>+</td>\n<td>++</td>\n<td>no</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>cheap-module-eval-source-map</td>\n<td>o</td>\n<td>++</td>\n<td>no</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>eval-source-map</td>\n<td>–</td>\n<td>+</td>\n<td>no</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>cheap-source-map</td>\n<td>+</td>\n<td>o</td>\n<td>yes</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>cheap-module-source-map</td>\n<td>o</td>\n<td>-</td>\n<td>yes</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>inline-cheap-source-map</td>\n<td>+</td>\n<td>o</td>\n<td>no</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>inline-cheap-module-source-map</td>\n<td>o</td>\n<td>-</td>\n<td>no</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>inline-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>no</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>hidden-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>nosources-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>无源代码内容</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>+++ 非常快速 &emsp; ++ 快速 &emsp; + 比较快 &emsp; o 中等 &emsp; - 比较慢 &emsp; – 慢</p>\n</blockquote>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>优化 Webpack 构建的方式有很多，主要可以从优化搜索时间、缩小文件搜索范围、减少不必要的编译等方面入手。</p>\n<h2 id=\"Webpack-与-grunt、gulp-有什么不同\"><a href=\"#Webpack-与-grunt、gulp-有什么不同\" class=\"headerlink\" title=\"Webpack 与 grunt、gulp 有什么不同\"></a>Webpack 与 grunt、gulp 有什么不同</h2><img src=\"../.images/image-20210526232017808.png\" alt=\"image-20210526232017808\" style=\"width: 600px;\">\n\n<p>从上图中可以看出来三者都不在一个频道，自然没有可比性。</p>\n<p>grunt 和 gulp 在早期比较流行，属于前端工具类，主要优化前端工作流程，比如自动刷新页面、combo、压缩 css、js、css 预编译等等。</p>\n<p>现在 Webpack 相对来说比较主流，属于预编译模块的方案，不需要在浏览器中加载解释器。另外，在本地直接写 JS，不管是 AMD / CMD / ES6 风格的模块化，Webpack 都能认识，并且编译成浏览器认识的 js。</p>\n<h3 id=\"使用上的区别\"><a href=\"#使用上的区别\" class=\"headerlink\" title=\"使用上的区别\"></a>使用上的区别</h3><p>grunt 和 gulp 是基于任务和流（Task、Stream）的。类似 jQuery，找到一个（或一类）文件，对其做一系列链式操作，更新流上的数据， 整条链式操作构成了一个任务，多个任务就构成了整个 web 的构建流程。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gulp.task(<span class=\"string\">&quot;dev&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 这个任务的名称是 dev</span></span><br><span class=\"line\">    gulp.src(<span class=\"string\">&quot;src/js/*.js&quot;</span>) <span class=\"comment\">//找到 `src/js/` 目录下的所有js</span></span><br><span class=\"line\">        .pipe(concat(<span class=\"string\">&quot;all.js&quot;</span>)) <span class=\"comment\">//对其进行合并并且命名为 `all.js`</span></span><br><span class=\"line\">        .pipe(uglify()) <span class=\"comment\">//压缩</span></span><br><span class=\"line\">        .pipe(rename(<span class=\"string\">&quot;all.min.js&quot;</span>)) <span class=\"comment\">//重命名</span></span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">&quot;dist/js/&quot;</span>)); <span class=\"comment\">//输出压缩后的js</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//在目录下执行 `gulp dev` 即可执行上述操作</span></span><br><span class=\"line\"><span class=\"comment\">//grunt 与 gulp 类似，只是稍微繁索一些，现在基本上用不上了</span></span><br></pre></td></tr></table></figure>\n\n<p>Webpack 是基于入口的。会自动地递归解析入口所需要加载的所有资源文件，然后用不同的 Loader 来处理不同的文件，用 Plugin 来扩展 Webpack 功能。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Webpack 具体配置这里不做讲解，形式都大同小异</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">entry</span>: <span class=\"string\">&quot;./entry.js&quot;</span>, <span class=\"comment\">//入口文件</span></span><br><span class=\"line\">    <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">filename</span>: <span class=\"string\">&quot;./bundle.js&quot;</span>, <span class=\"comment\">//输出文件</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">loaders</span>: [...loaders],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>从构建思路来说，gulp 和 grunt 需要开发者将整个前端构建过程拆分成多个 Task，并合理控制所有 Task 的调用关系<br>Webpack 需要开发者找到入口，并需要清楚对于不同的资源应该使用什么 Loader 做何种解析和加工。</p>\n<h3 id=\"总结-1\"><a href=\"#总结-1\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ul>\n<li>  gulp、grunt 是 web 构建工具</li>\n<li>  Webpack 是模块化方案</li>\n<li>  gulp、grunt 是基于任务和流</li>\n<li>  Webpack 基于入口文件</li>\n</ul>\n","site":{"data":{}},"excerpt":"<h1 id=\"Webpack\"><a href=\"#Webpack\" class=\"headerlink\" title=\"Webpack\"></a>Webpack</h1><p><img src=\"/2021/11/01/webpack/webpack-1.png\" alt=\"Webpack\"></p>","more":"<h2 id=\"什么是-Webpack\"><a href=\"#什么是-Webpack\" class=\"headerlink\" title=\"什么是 Webpack\"></a>什么是 Webpack</h2><p>Webpack 是一个<strong>模块打包工具</strong> (module bundler)，在 Webpack 里一切文件皆模块。通过 loader 转换文件，通过 plugin 注入钩子，最后输出由多个模块组合的文件。Webpack 专注构建模块化项目。</p>\n<blockquote>\n<p>当 Webpack 处理应用程序时，它会递归地构建一个依赖关系图 (dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p>\n<p>Webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。插件就像是一个插入到生产线中的一个功能，在特定的时机对生产线上的资源做处理。</p>\n<p>Webpack 通过 Tapable 来组织这条复杂的生产线。 Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。 Webpack 的事件流机制保证了插件的有序性，使得整个系统扩展性很好。 – 深入浅出 Webpack 吴浩麟</p>\n</blockquote>\n<p><img src=\"/2021/11/01/webpack/webpack-2.png\" alt=\"Webpack\"></p>\n<h2 id=\"Webpack-核心概念\"><a href=\"#Webpack-核心概念\" class=\"headerlink\" title=\"Webpack 核心概念\"></a>Webpack 核心概念</h2><h3 id=\"1-Entry\"><a href=\"#1-Entry\" class=\"headerlink\" title=\"1. Entry\"></a>1. Entry</h3><p>入口起点 (entry point) 指示 Webpack 应该使用哪个模块，来作为构建其内部依赖图的开始。</p>\n<p>进入入口起点后，Webpack 会找出有哪些模块和库是入口起点（直接和间接）依赖的。</p>\n<p>每个依赖项随即被处理，最后输出到称之为 bundles 的文件中。</p>\n<h3 id=\"2-Output\"><a href=\"#2-Output\" class=\"headerlink\" title=\"2. Output\"></a>2. Output</h3><p>Output 属性告诉 Webpack 在哪里输出它所创建的 bundles，以及如何命名这些文件，默认值为 <code>./dist</code>。</p>\n<p>基本上，整个应用程序结构，都会被编译到你指定的输出路径的文件夹中。</p>\n<h3 id=\"3-Module\"><a href=\"#3-Module\" class=\"headerlink\" title=\"3. Module\"></a>3. Module</h3><p>模块，在 Webpack 里一切皆模块，一个模块对应着一个文件。Webpack 会从配置的 Entry 开始递归找出所有依赖的模块。</p>\n<h3 id=\"4-Chunk\"><a href=\"#4-Chunk\" class=\"headerlink\" title=\"4. Chunk\"></a>4. Chunk</h3><p>代码块，一个 Chunk 由多个模块组合而成，用于代码合并与分割。</p>\n<h3 id=\"5-Loader\"><a href=\"#5-Loader\" class=\"headerlink\" title=\"5. Loader\"></a>5. Loader</h3><p>Loader 让 Webpack 能够去处理那些非 JavaScript 文件（Webpack 自身只理解 JavaScript）。</p>\n<p>Loader 可以将所有类型的文件转换为 Webpack 能够处理的有效模块，然后你就可以利用 Webpack 的打包能力，对它们进行处理。</p>\n<p>本质上，Webpack Loader 将所有类型的文件，转换为应用程序的依赖图（和最终的 bundle）可以直接引用的模块。</p>\n<h3 id=\"6-Plugin\"><a href=\"#6-Plugin\" class=\"headerlink\" title=\"6. Plugin\"></a>6. Plugin</h3><p>Loader 被用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。</p>\n<p>插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能极其强大，可以用来处理各种各样的任务。</p>\n<h2 id=\"Webpack-构建流程\"><a href=\"#Webpack-构建流程\" class=\"headerlink\" title=\"Webpack 构建流程\"></a>Webpack 构建流程</h2><p>Webpack 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程：</p>\n<ol>\n<li><strong>初始化参数</strong>：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数。</li>\n<li><strong>开始编译</strong>：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译。</li>\n<li><strong>确定入口</strong>：根据配置中的 entry 找出所有的入口文件。</li>\n<li><strong>编译模块</strong>：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。<blockquote>\n<p>可以分为三个部分帮助记忆：</p>\n<ul>\n<li>调用各 loader 处理模块之间的依赖</li>\n<li>调用 acorn 解析经 loader 处理后的源文件生成抽象语法树 AST</li>\n<li>遍历 AST，构建该模块所依赖的模块</li>\n</ul>\n</blockquote>\n</li>\n<li><strong>完成模块编译</strong>：在经过第 4 步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li>\n<li><strong>输出资源</strong>：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会。</li>\n<li><strong>输出完成</strong>：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。</li>\n</ol>\n<p>在以上过程中，Webpack 会在特定的时间点广播出特定的事件，插件在监听到感兴趣的事件后会执行特定的逻辑，并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。</p>\n<h2 id=\"Loader\"><a href=\"#Loader\" class=\"headerlink\" title=\"Loader\"></a>Loader</h2><p>Loader 用于对模块的源代码进行转换，在 import 或”加载”模块时预处理文件</p>\n<h3 id=\"1-配置方式\"><a href=\"#1-配置方式\" class=\"headerlink\" title=\"1. 配置方式\"></a>1. 配置方式</h3><p>Loader 的配置写在 <code>module.rules</code> 属性中：</p>\n<ul>\n<li>  <code>rules</code> 是一个数组的形式，可以配置很多个 Loader</li>\n<li>  每一个 Loader 对应一个对象的形式，对象属性 <code>test</code> 为匹配的规则，一般情况为正则表达式</li>\n<li>  属性 <code>use</code> 针对匹配到文件类型，调用对应的 Loader 进行处理</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">                use: [</span><br><span class=\"line\">                    &#123; <span class=\"attr\">loader</span>: <span class=\"string\">&quot;style-loader&quot;</span> &#125;,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"attr\">loader</span>: <span class=\"string\">&quot;css-loader&quot;</span>,</span><br><span class=\"line\">                        <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">modules</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &#123; <span class=\"attr\">loader</span>: <span class=\"string\">&quot;sass-loader&quot;</span> &#125;,</span><br><span class=\"line\">                ],</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-特性\"><a href=\"#2-特性\" class=\"headerlink\" title=\"2. 特性\"></a>2. 特性</h3><p>Loader 支持链式调用，链中的每个 Loader 会处理之前已处理过的资源，最终变为 js 代码，顺序为相反的顺序执行。</p>\n<p>Loader 的特性：</p>\n<ul>\n<li>  Loader 可以是同步的，也可以是异步的</li>\n<li>  Loader 运行在 Node.js 中，并且能够执行任何操作</li>\n<li>  除了常见的通过 package.json 的 main 来将一个 npm 模块导出为 Loader，还可以在 module.rules 中使用 Loader 字段直接引用一个模块</li>\n<li>  插件(plugin) 可以为 Loader 带来更多特性</li>\n<li>  Loader 能够产生额外的任意文件</li>\n</ul>\n<h3 id=\"3-常见的-Loader\"><a href=\"#3-常见的-Loader\" class=\"headerlink\" title=\"3. 常见的 Loader\"></a>3. 常见的 Loader</h3><table>\n<thead>\n<tr>\n<th>Loader</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>style-loader</td>\n<td>将 css 添加到 DOM 的内联样式标签 <code>style</code> 里</td>\n</tr>\n<tr>\n<td>css-loader</td>\n<td>允许将 css 文件通过 <code>require</code> 的方式引入，并返回 css 代码</td>\n</tr>\n<tr>\n<td>less-loader</td>\n<td>处理 less</td>\n</tr>\n<tr>\n<td>sass-loader</td>\n<td>处理 sass</td>\n</tr>\n<tr>\n<td>postcss-loader</td>\n<td>用 postcss 来处理 CSS</td>\n</tr>\n<tr>\n<td>autoprefixer-loader</td>\n<td>处理 CSS3 属性前缀，已被弃用，建议直接使用 postcss</td>\n</tr>\n<tr>\n<td>file-loader</td>\n<td>分发文件到 output 目录并返回相对路径</td>\n</tr>\n<tr>\n<td>url-loader</td>\n<td>和 file-loader 类似，但是当文件小于设定的 limit 时可以返回一个 Data Url</td>\n</tr>\n<tr>\n<td>html-minify-loader</td>\n<td>压缩 HTML</td>\n</tr>\n<tr>\n<td>babel-loader</td>\n<td>用 babel 来转换 ES6 文件到 ES5</td>\n</tr>\n</tbody></table>\n<h2 id=\"Plugin\"><a href=\"#Plugin\" class=\"headerlink\" title=\"Plugin\"></a>Plugin</h2><p>Plugin 赋予其各种灵活的功能，例如打包优化、资源管理、环境变量注入等，它们会运行在 Webpack 的不同阶段（钩子 / 生命周期），贯穿了 Webpack 整个编译周期。</p>\n<p>Plugin 目的在于解决 Loader 无法实现的其他事。</p>\n<h3 id=\"1-配置方式-1\"><a href=\"#1-配置方式-1\" class=\"headerlink\" title=\"1. 配置方式\"></a>1. 配置方式</h3><p>通过配置文件导出对象中 <code>plugins</code> 属性传入 new 实例对象。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> Webpack = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;Webpack&quot;</span>); <span class=\"comment\">// 访问内置的插件</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.ProgressPlugin(),</span><br><span class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123; <span class=\"attr\">template</span>: <span class=\"string\">&quot;./src/index.html&quot;</span> &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-特性-1\"><a href=\"#2-特性-1\" class=\"headerlink\" title=\"2. 特性\"></a>2. 特性</h3><p>其本质是一个具有 <code>apply</code> 方法 javascript 对象</p>\n<p><code>apply</code> 方法会被 Webpack compiler 调用，并且在整个编译生命周期都可以访问 compiler 对象</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> pluginName = <span class=\"string\">&quot;ConsoleLogOnBuildWebpackPlugin&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConsoleLogOnBuildWebpackPlugin</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"title\">apply</span>(<span class=\"params\">compiler</span>)</span> &#123;</span><br><span class=\"line\">        compiler.hooks.run.tap(pluginName, <span class=\"function\"><span class=\"params\">compilation</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;Webpack 构建过程开始！&quot;</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = ConsoleLogOnBuildWebpackPlugin;</span><br></pre></td></tr></table></figure>\n\n<p>compiler hook 的 <code>tap</code> 方法的第一个参数，应是驼峰式命名的插件名称</p>\n<p>关于整个编译生命周期钩子，有如下：</p>\n<blockquote>\n<ul>\n<li>  <code>entry-option</code>：初始化 option</li>\n<li>  <code>run</code></li>\n<li>  <code>compile</code>：真正开始的编译，在创建 compilation 对象之前</li>\n<li>  <code>compilation</code>：生成好了 compilation 对象</li>\n<li>  <code>make</code>： 从 entry 开始递归分析依赖，准备对每个模块进行 build</li>\n<li>  <code>after-compile</code>：编译 build 过程结束</li>\n<li>  <code>emit</code>：在将内存中 assets 内容写到磁盘文件夹之前</li>\n<li>  <code>after-emit</code>：在将内存中 assets 内容写到磁盘文件夹之后</li>\n<li>  <code>done</code>：完成所有的编译过程</li>\n<li>  <code>failed</code>：编译失败的时候</li>\n</ul>\n</blockquote>\n<h3 id=\"3-常见的-Plugin\"><a href=\"#3-常见的-Plugin\" class=\"headerlink\" title=\"3. 常见的 Plugin\"></a>3. 常见的 Plugin</h3><table>\n<thead>\n<tr>\n<th>Plugin</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AggressiveSplittingPlugin</td>\n<td>将原来的 chunk 分成更小的 chunk</td>\n</tr>\n<tr>\n<td>BabelMinifyWebpackPlugin</td>\n<td>使用 babel-minify 进行压缩</td>\n</tr>\n<tr>\n<td>BannerPlugin</td>\n<td>在每个生成的 chunk 顶部添加 banner</td>\n</tr>\n<tr>\n<td>CommonsChunkPlugin</td>\n<td>提取 chunks 之间共享的通用模块</td>\n</tr>\n<tr>\n<td>CompressionWebpackPlugin</td>\n<td>预先准备的资源压缩版本，使用 Content-Encoding 提供访问服务</td>\n</tr>\n<tr>\n<td>ContextReplacementPlugin</td>\n<td>重写 require 表达式的推断上下文</td>\n</tr>\n<tr>\n<td>CopyWebpackPlugin</td>\n<td>将单个文件或整个目录复制到构建目录</td>\n</tr>\n<tr>\n<td>DefinePlugin</td>\n<td>允许在编译时(compile time) 配置的全局常量</td>\n</tr>\n<tr>\n<td>Dllplugin</td>\n<td>为了极大减小构建时间，进行分离打包</td>\n</tr>\n<tr>\n<td>EnvironmentPlugin</td>\n<td>DefinePlugin 中的 process.env 键的简写方式</td>\n</tr>\n<tr>\n<td>ExtractTextWebpackPlugin</td>\n<td>从 bundel 中提取文本(CSS) 到单独的文件</td>\n</tr>\n<tr>\n<td>HotModuleReplacementPlugin</td>\n<td>启用模块热替换 (Enable Hot Module Replacement - HMR)</td>\n</tr>\n<tr>\n<td>HtmlWebpackPlugin</td>\n<td>简单创建 HTML 文件，用于服务器访问</td>\n</tr>\n<tr>\n<td>I18nWebpackPlugin</td>\n<td>为 bundle 增加国际化支持</td>\n</tr>\n<tr>\n<td>IgnorePlugin</td>\n<td>从 bundle 中排除某些模块</td>\n</tr>\n<tr>\n<td>LimitChunkCountPlugin</td>\n<td>设置 chunk 的最小/最大限制，以微调和控制 chunk</td>\n</tr>\n<tr>\n<td>LoaderOptionsPlugin</td>\n<td>用于从 Webpack1 迁移到 Webpack2</td>\n</tr>\n<tr>\n<td>MinChunkSizePlugin</td>\n<td>确保 chunk 大小超过指定限制</td>\n</tr>\n<tr>\n<td>NoEmitOnErrorsPlugin</td>\n<td>在输出阶段时，遇到编译错误跳过</td>\n</tr>\n<tr>\n<td>NormalModuleReplacementPlugin</td>\n<td>替换与正则表达式匹配的资源</td>\n</tr>\n</tbody></table>\n<h2 id=\"Loader-和-Plugin-的区别\"><a href=\"#Loader-和-Plugin-的区别\" class=\"headerlink\" title=\"Loader 和 Plugin 的区别\"></a>Loader 和 Plugin 的区别</h2><ul>\n<li>  Loader 运行在打包文件之前</li>\n<li>  Plugin 在整个编译周期都起作用</li>\n</ul>\n<p>在 Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果。</p>\n<p>对于 Loader，实质是一个转换器，比如将 A.scss 或 A.less 转变为 B.css，单纯的文件转换过程。</p>\n<h2 id=\"Webpack-热更新\"><a href=\"#Webpack-热更新\" class=\"headerlink\" title=\"Webpack 热更新\"></a>Webpack 热更新</h2><h3 id=\"1-实现原理\"><a href=\"#1-实现原理\" class=\"headerlink\" title=\"1. 实现原理\"></a>1. 实现原理</h3><img src=\"../.images/image-20210526112504058.png\" alt=\"image-20210526112504058\" style=\"width: 600px;\">\n\n<ul>\n<li>  Webpack Compile：将 JS 源代码编译成 bundle.js</li>\n<li>  HMR Server：用来将热更新的文件输出给 HMR Runtime</li>\n<li>  Bundle Server：静态资源文件服务器，提供文件访问路径</li>\n<li>  HMR Runtime：socket 服务器，会被注入到浏览器，更新文件的变化</li>\n<li>  bundle.js：构建输出的文件</li>\n<li>  在 HMR Runtime 和 HMR Server 之间建立 Websocket，即 4⃣️ ，用于实时更新文件变化</li>\n</ul>\n<h4 id=\"启动阶段\"><a href=\"#启动阶段\" class=\"headerlink\" title=\"启动阶段\"></a>启动阶段</h4><p>1 -&gt; 2 -&gt; A -&gt; B<br>在编写未经过 Webpack 打包的源代码后，Webpack Compile 将源代码和 HMR Runtime 一起编译成 bundle 文件，传输给 Bundle Server 静态资源服务器。</p>\n<h4 id=\"更新阶段\"><a href=\"#更新阶段\" class=\"headerlink\" title=\"更新阶段\"></a>更新阶段</h4><p>1 -&gt; 2 -&gt; 3 -&gt; 4</p>\n<p>当某一个文件或者模块发生变化时，Webpack 监听到文件变化对文件重新编译打包，编译生成唯一的 hash 值（下图 <code>h</code> 属性），这个 hash 值用来作为下一次热更新的标识。</p>\n<p>根据变化的内容生成两个补丁文件：<code>manifest</code>（包含了 hash 和 chundId，用来说明变化的内容）和 <code>chunk.js</code> 模块。</p>\n<p>由于 socket 服务器在 HMR Runtime 和 HMR Server 之间建立 Websocket 链接，当文件发生改动的时候，服务端会向浏览器推送一条消息，消息包含文件改动后生成的 hash 值，作为下一次热更新的标识。<br><img src=\"../.images/image-20210526145412513.png\" alt=\"image-20210526145412513\" style=\"width:600px;\"></p>\n<p>在浏览器接受到这条消息之前，浏览器已经在上一次 socket 消息中已经记住了此时的 hash 标识，这时候会去服务端获取变化内容的 manifest 文件。</p>\n<p>mainfest 文件包含重新 build 生成的 hash 值，以及变化的模块（上图 <code>c</code> 属性）。</p>\n<p>浏览器根据 manifest 文件获取模块变化的内容，从而触发 render 流程，实现局部模块更新。</p>\n<h3 id=\"2-总结\"><a href=\"#2-总结\" class=\"headerlink\" title=\"2. 总结\"></a>2. 总结</h3><ul>\n<li>  通过 <code>Webpack-dev-server</code> 创建两个服务器：提供静态资源的服务（express）和 Socket 服务</li>\n<li>  express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）</li>\n<li>  socket server 是一个 Websocket 的长连接，双方可以通信</li>\n<li>  当 socket server 监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）</li>\n<li>  通过长连接，socket server 可以直接将这两个文件主动发送给客户端（浏览器）</li>\n<li>  浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新</li>\n</ul>\n<h2 id=\"Webpack-Proxy\"><a href=\"#Webpack-Proxy\" class=\"headerlink\" title=\"Webpack Proxy\"></a>Webpack Proxy</h2><p>Webpack Proxy，即 Webpack 提供的代理服务，基本行为就是接收客户端发送的请求后转发给其他服务器，其目的是为了便于开发者在开发模式下解决跨域问题（浏览器安全策略限制）。</p>\n<p>想要实现代理首先需要一个中间服务器，Webpack 中提供服务器的工具为 Webpack-dev-server。</p>\n<h3 id=\"1-Webpack-dev-server\"><a href=\"#1-Webpack-dev-server\" class=\"headerlink\" title=\"1. Webpack-dev-server\"></a>1. Webpack-dev-server</h3><p>Webpack-dev-server 是 Webpack 官方推出的一款开发工具，将自动编译和自动刷新浏览器等一系列对开发友好的功能全部集成在了一起，目的是为了提高开发者日常的开发效率，<strong>「只适用在开发阶段」</strong></p>\n<p>配置方面，在 Webpack 配置对象属性中通过 devServer 属性提供，如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ./Webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;path&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">contentBase</span>: path.join(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">        <span class=\"attr\">compress</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">port</span>: <span class=\"number\">3000</span>,</span><br><span class=\"line\">        <span class=\"attr\">proxy</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;/api&quot;</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">target</span>: <span class=\"string\">&quot;https://api.xxx.com&quot;</span>,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>属性：</p>\n<ul>\n<li>  target：表示的是代理到的目标地址</li>\n<li>  pathRewrite：默认情况下 <code>/api</code> 也会被写入到 URL 中，如果希望删除，可以使用 <code>pathRewrite</code></li>\n<li>  secure：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 <code>false</code></li>\n<li>  changeOrigin：它表示是否更新代理后请求的 <code>headers</code> 中 <code>host</code> 地址</li>\n</ul>\n</blockquote>\n<h3 id=\"2-工作原理\"><a href=\"#2-工作原理\" class=\"headerlink\" title=\"2. 工作原理\"></a>2. 工作原理</h3><p>proxy 工作原理实质上是利用 <code>http-proxy-middleware</code> 这个 http 代理中间件，实现请求转发给其他服务器。</p>\n<h3 id=\"3-跨域\"><a href=\"#3-跨域\" class=\"headerlink\" title=\"3. 跨域\"></a>3. 跨域</h3><p>在开发阶段， Webpack-dev-server 会启动一个本地开发服务器，所以我们的应用在开发阶段是独立运行在 localhost 的一个端口上，而后端服务又是运行在另外一个地址上，所以在开发阶段中，由于浏览器同源策略的原因，当本地访问后端就会出现跨域请求的问题。</p>\n<p>通过设置 Webpack proxy 实现代理请求后，相当于浏览器与服务端中添加一个代理者，当本地发送请求的时候，代理服务器响应该请求，并将请求转发到目标服务器，目标服务器响应数据后再将数据返回给代理服务器，最终再由代理服务器将数据响应给本地。</p>\n<p><strong>注意：「服务器与服务器之间请求数据并不会存在跨域行为，跨域行为是浏览器安全策略限制」</strong></p>\n<h2 id=\"前端性能优化\"><a href=\"#前端性能优化\" class=\"headerlink\" title=\"前端性能优化\"></a>前端性能优化</h2><h3 id=\"1-JS-代码压缩\"><a href=\"#1-JS-代码压缩\" class=\"headerlink\" title=\"1. JS 代码压缩\"></a>1. JS 代码压缩</h3><p><code>terser</code> 是一个 JavaScript 的解释、绞肉机、压缩机的工具集，可以帮助我们压缩、丑化我们的代码，让 bundle 更小</p>\n<p>在 <code>production</code> 模式下，Webpack 默认使用 TerserPlugin 来处理代码。自定义配置方法如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> TerserPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;terser-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> TerserPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 电脑cpu核数-1</span></span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>属性：</p>\n<ul>\n<li><p>  extractComments：默认值为 <code>true</code>，表示会将注释抽取到一个单独的文件中，开发阶段，我们可设置为 <code>false</code> ，不保留注释</p>\n</li>\n<li><p>  parallel：使用多进程并发运行提高构建的速度，默认值是 <code>true</code>，并发运行的默认数量：<code>os.cpus().length - 1</code></p>\n</li>\n<li><p>terserOptions：设置我们的 terser 相关的配置：</p>\n<p>  compress：设置压缩相关的选项<br>  mangle：设置丑化相关的选项，可以直接设置为 <code>true</code><br>  toplevel：底层变量是否进行转换<br>  keep_classnames：保留类的名称<br>  keep_fnames：保留函数的名称</p>\n</li>\n</ul>\n</blockquote>\n<h3 id=\"2-CSS-代码压缩\"><a href=\"#2-CSS-代码压缩\" class=\"headerlink\" title=\"2. CSS 代码压缩\"></a>2. CSS 代码压缩</h3><p>使用 <code>css-minimizer-Webpack-plugin</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install css-minimizer-Webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> CssMinimizerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;css-minimizer-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> CssMinimizerPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-HTML-文件代码压缩\"><a href=\"#3-HTML-文件代码压缩\" class=\"headerlink\" title=\"3. HTML 文件代码压缩\"></a>3. HTML 文件代码压缩</h3><p>使用 <code>HtmlWebpackPlugin</code> 插件来生成 HTML 的模板时候，通过配置属性 <code>minify</code> 进行 html 优化。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugin</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">minify</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">minifyCSS</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否压缩css</span></span><br><span class=\"line\">                <span class=\"attr\">collapseWhitespace</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否折叠空格</span></span><br><span class=\"line\">                <span class=\"attr\">removeComments</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否移除注释</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>设置了 <code>minify</code>，实际会使用另一个插件 <code>html-minifier-terser</code></p>\n<h3 id=\"4-文件大小压缩\"><a href=\"#4-文件大小压缩\" class=\"headerlink\" title=\"4. 文件大小压缩\"></a>4. 文件大小压缩</h3><p>对文件的大小进行压缩，减少 http 传输过程中宽带的损耗，使用 <code>compression-Webpack-plugin</code>。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> ComepressionPlugin(&#123;</span><br><span class=\"line\">    <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(css|js)$/</span>, <span class=\"comment\">// 哪些文件需要压缩</span></span><br><span class=\"line\">    threshold: <span class=\"number\">500</span>, <span class=\"comment\">// 设置文件多大开始压缩</span></span><br><span class=\"line\">    <span class=\"attr\">minRatio</span>: <span class=\"number\">0.7</span>, <span class=\"comment\">// 至少压缩的比例</span></span><br><span class=\"line\">    <span class=\"attr\">algorithm</span>: <span class=\"string\">&quot;gzip&quot;</span>, <span class=\"comment\">// 采用的压缩算法</span></span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5-图片压缩\"><a href=\"#5-图片压缩\" class=\"headerlink\" title=\"5. 图片压缩\"></a>5. 图片压缩</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpg|gif)$/</span>,</span><br><span class=\"line\">            use: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">loader</span>: <span class=\"string\">&quot;file-loader&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                        <span class=\"attr\">name</span>: <span class=\"string\">&quot;[name]_[hash].[ext]&quot;</span>,</span><br><span class=\"line\">                        <span class=\"attr\">outputPath</span>: <span class=\"string\">&quot;images/&quot;</span>,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"attr\">loader</span>: <span class=\"string\">&quot;image-Webpack-loader&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// 压缩 jpeg 的配置</span></span><br><span class=\"line\">                        <span class=\"attr\">mozjpeg</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">progressive</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"number\">65</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 使用 imagemin**-optipng 压缩 png，enable: false 为关闭</span></span><br><span class=\"line\">                        <span class=\"attr\">optipng</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">enabled</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 使用 imagemin-pngquant 压缩 png</span></span><br><span class=\"line\">                        <span class=\"attr\">pngquant</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"string\">&quot;65-90&quot;</span>,</span><br><span class=\"line\">                            <span class=\"attr\">speed</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 压缩 gif 的配置</span></span><br><span class=\"line\">                        <span class=\"attr\">gifsicle</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">interlaced</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                        <span class=\"comment\">// 开启 webp，会把 jpg 和 png 图片压缩为 webp 格式</span></span><br><span class=\"line\">                        <span class=\"attr\">webp</span>: &#123;</span><br><span class=\"line\">                            <span class=\"attr\">quality</span>: <span class=\"number\">75</span>,</span><br><span class=\"line\">                        &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">            ],</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    ];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-Tree-Shaking\"><a href=\"#6-Tree-Shaking\" class=\"headerlink\" title=\"6. Tree Shaking\"></a>6. Tree Shaking</h3><p>Tree Shaking 是一个术语，在计算机中表示消除死代码，依赖于 ES Module 的静态语法分析（不执行任何的代码，可以明确知道模块的依赖关系）。</p>\n<p>在 Webpack 实现 Tree shaking 有两种不同的方案：</p>\n<ul>\n<li>  usedExports：通过标记某些函数是否被使用，之后通过 Terser 来进行优化的</li>\n<li>sideEffects：跳过整个模块/文件，直接查看该文件是否有副作用<br>  两种不同的配置方案， 有不同的效果</li>\n</ul>\n<h4 id=\"usedExports\"><a href=\"#usedExports\" class=\"headerlink\" title=\"usedExports\"></a>usedExports</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">usedExports</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>使用之后，没被用上的代码在 Webpack 打包中会加入 <code>/* unused harmony export mul */</code> 注释，用来告知 Terser 在优化时，可以删除掉这段代码。</p>\n<h4 id=\"sideEffects\"><a href=\"#sideEffects\" class=\"headerlink\" title=\"sideEffects\"></a>sideEffects</h4><p>sideEffects 用于告知 Webpack Compiler 哪些模块时有副作用，配置方法是在 <code>package.json</code> 中设置 <code>sideEffects</code> 属性。</p>\n<p>如果 sideEffects 设置为 <code>false</code>，就是告知 Webpack 可以安全的删除未用到的 exports。如果有些文件需要保留，可以设置为数组的形式。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">&quot;sideEffects&quot;</span>: [</span><br><span class=\"line\">        <span class=\"string\">&quot;./src/util/format.js&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;*.css&quot;</span> <span class=\"comment\">// 所有的css文件</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"css-tree-shaking\"><a href=\"#css-tree-shaking\" class=\"headerlink\" title=\"css tree shaking\"></a>css tree shaking</h4><p>css 进行 tree shaking 优化可以安装 <code>PurgeCss</code> 插件。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PurgeCssPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;purgecss-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> PurgeCssPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">path</span>: glob.sync(<span class=\"string\">`<span class=\"subst\">$&#123;path.resolve(<span class=\"string\">&quot;./src&quot;</span>)&#125;</span>/**/*`</span>),</span><br><span class=\"line\">            <span class=\"attr\">nodir</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// src里面的所有文件</span></span><br><span class=\"line\">            <span class=\"attr\">satelist</span>: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                    <span class=\"attr\">standard</span>: [<span class=\"string\">&quot;html&quot;</span>],</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>paths：表示要检测哪些目录下的内容需要被分析，配合使用 glob。<br>默认情况下，PurgeCss 会将我们的 html 标签的样式移除掉，如果我们希望保留，可以添加一个 <code>safelist</code> 的属性。</p>\n</blockquote>\n<h3 id=\"7-代码分割-Code-Splitting\"><a href=\"#7-代码分割-Code-Splitting\" class=\"headerlink\" title=\"7. 代码分割 (Code Splitting)\"></a>7. 代码分割 (Code Splitting)</h3><p>将代码分离到不同的 bundle 中，之后我们可以按需加载，或者并行加载这些文件。</p>\n<p>默认情况下，所有的 JavaScript 代码（业务代码、第三方依赖、暂时没有用到的模块）在首页全部都加载，就会影响首页的加载速度。</p>\n<p>代码分离可以分出出更小的 bundle，以及控制资源加载优先级，提供代码的加载性能。</p>\n<p>这里通过 <code>splitChunksPlugin</code> 来实现，该插件 Webpack 已经默认安装和集成，只需要配置即可。默认配置中，chunks 仅仅针对于异步（async）请求，我们可以设置为 <code>initial</code> 或者 <code>all</code>。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minSize</span>: <span class=\"number\">30000</span>,</span><br><span class=\"line\">        <span class=\"attr\">maxInitialRequests</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"attr\">cacheGroups</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">lib</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;vendors&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;initial&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">react</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;react&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]react[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;all&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">antd</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;antd&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]antd[\\\\/]/</span>,</span><br><span class=\"line\">            chunks: <span class=\"string\">&#x27;all&#x27;</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">moment</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&#x27;moment&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: <span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]moment[\\\\/]/</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          <span class=\"attr\">default</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">minChunks</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">            <span class=\"attr\">priority</span>: -<span class=\"number\">20</span>,</span><br><span class=\"line\">            <span class=\"attr\">reuseExistingChunk</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>minSize：拆分包的大小，至少为 minSize，如何包的大小不超过 minSize，这个包不会拆分<br>maxSize：将大于 maxSize 的包，拆分为不小于 minSize 的包</p>\n</blockquote>\n<h4 id=\"chunks\"><a href=\"#chunks\" class=\"headerlink\" title=\"chunks\"></a>chunks</h4><ol>\n<li><code>async</code> 表示只从异步加载得模块（动态加载 <code>import()</code>）里面进行拆分</li>\n<li><code>initial</code> 表示只从入口模块进行拆分</li>\n<li><code>all</code> 表示以上两者都包括</li>\n</ol>\n<h4 id=\"cacheGroups\"><a href=\"#cacheGroups\" class=\"headerlink\" title=\"cacheGroups\"></a>cacheGroups</h4><ol>\n<li><code>name</code>：chunk 的文件名</li>\n<li><code>test</code>：过滤 modules，默认为所有的 modules，可匹配模块路径或 chunk 名字，当匹配到某个 chunk 的名字时，这个 chunk 里面引入的所有 module 都会选中</li>\n<li><code>priority</code>：权重，数字越大表示优先级越高。一个 module 可能会满足多个 cacheGroups 的正则匹配，到底将哪个缓存组应用于这个 module，取决于优先级</li>\n<li><code>reuseExistingChunk</code>：是否使用已有的 chunk，true 则表示如果当前的 chunk 包含的模块已经被抽取出去了，那么将不会重新生成新的，即几个 chunk 复用被拆分出去的一个 module</li>\n</ol>\n<h3 id=\"8-内联-chunk\"><a href=\"#8-内联-chunk\" class=\"headerlink\" title=\"8. 内联 chunk\"></a>8. 内联 chunk</h3><p>可以通过 <code>InlineChunkHtmlPlugin</code> 插件将一些 chunk 的模块内联到 html，如 runtime 的代码（对模块进行解析、加载、模块信息相关的代码），代码量并不大，但是必须加载的。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> InlineChunkHtmlPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;react-dev-utils/InlineChunkHtmlPlugin&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;html-Webpack-plugin&quot;</span>);</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugin</span>: [<span class=\"keyword\">new</span> InlineChunkHtmlPlugin(HtmlWebpackPlugin, [<span class=\"regexp\">/runtime.+\\.js/</span>])],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"9-总结\"><a href=\"#9-总结\" class=\"headerlink\" title=\"9. 总结\"></a>9. 总结</h3><p>关于 Webpack 对前端性能的优化，可以通过文件体积大小入手，其次还可通过分包的形式、减少 http 请求次数等方式，实现对前端性能的优化。</p>\n<h2 id=\"提高-Webpack-的构建速度\"><a href=\"#提高-Webpack-的构建速度\" class=\"headerlink\" title=\"提高 Webpack 的构建速度\"></a>提高 Webpack 的构建速度</h2><h3 id=\"1-优化-Loader-配置\"><a href=\"#1-优化-Loader-配置\" class=\"headerlink\" title=\"1. 优化 Loader 配置\"></a>1. 优化 Loader 配置</h3><p>通过配置 include、exclude、test 属性来匹配文件，接触 include、exclude 规定哪些匹配应用 loader。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 配置 babel-loader</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 如果项目源码中只有 js 文件就不要写成 /\\.jsx?$/，提升正则表达式性能</span></span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">                <span class=\"comment\">// babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启</span></span><br><span class=\"line\">                use: [<span class=\"string\">&quot;babel-loader?cacheDirectory&quot;</span>],</span><br><span class=\"line\">                <span class=\"comment\">// 只对项目根目录下的 src 目录中的文件采用 babel-loader</span></span><br><span class=\"line\">                <span class=\"attr\">include</span>: path.resolve(__dirname, <span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-合理使用-resolve-extensions\"><a href=\"#2-合理使用-resolve-extensions\" class=\"headerlink\" title=\"2. 合理使用 resolve.extensions\"></a>2. 合理使用 resolve.extensions</h3><p>通过 <code>resolve.extensions</code> 是解析到文件时自动添加扩展名，默认情况如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">extensions</span>: [<span class=\"string\">&quot;.warm&quot;</span>, <span class=\"string\">&quot;.mjs&quot;</span>, <span class=\"string\">&quot;.js&quot;</span>, <span class=\"string\">&quot;.json&quot;</span>],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>引入文件的时候，若没有文件后缀名，则会根据数组内的值依次查找。配置的时候，不要随便把所有后缀都写在里面，这会调用多次文件的查找，减慢打包速度。</p>\n<h3 id=\"3-优化-resolve-modules\"><a href=\"#3-优化-resolve-modules\" class=\"headerlink\" title=\"3. 优化 resolve.modules\"></a>3. 优化 resolve.modules</h3><p><code>resolve.modules</code> 用于配置 Webpack 去哪些目录下寻找第三方模块。默认值为 <code>[&#39;node_modules&#39;]</code> ，所以默认会从 node_modules 中查找文件 当安装的第三方模块都放在项目根目录下的 <code>./node_modules</code> 目录下时，所以可以指明存放第三方模块的绝对路径，以减少寻找，配置如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 使用绝对路径指明第三方模块存放的位置，以减少搜索步骤</span></span><br><span class=\"line\">        <span class=\"comment\">// 其中 __dirname 表示当前工作目录，也就是项目根目录</span></span><br><span class=\"line\">        <span class=\"attr\">modules</span>: [path.resolve(__dirname, <span class=\"string\">&quot;node_modules&quot;</span>)],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-优化-resolve-alias\"><a href=\"#4-优化-resolve-alias\" class=\"headerlink\" title=\"4. 优化 resolve.alias\"></a>4. 优化 resolve.alias</h3><p>alias 给一些常用的路径起一个别名，特别当我们的项目目录结构比较深的时候，一个文件的路径可能是 <code>../../../</code> 的形式。</p>\n<p>通过配置 alias 以减少查找过程：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;@&quot;</span>: path.resolve(__dirname, <span class=\"string\">&quot;./src&quot;</span>),</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5-使用-DLLPlugin-插件\"><a href=\"#5-使用-DLLPlugin-插件\" class=\"headerlink\" title=\"5. 使用 DLLPlugin 插件\"></a>5. 使用 DLLPlugin 插件</h3><p>DLL 全称是 动态链接库，是为软件在 Windows 中实现共享函数库的一种实现方式，而 Webpack 也内置了 DLL 的功能，为的就是可以共享，不经常改变的代码，抽成一个共享的库。这个库在之后的编译过程中，会被引入到其他项目的代码中</p>\n<p>使用步骤分成两部分：</p>\n<ul>\n<li>  打包一个 DLL 库</li>\n<li>  引入 DLL 库</li>\n</ul>\n<h4 id=\"打包一个-DLL-库\"><a href=\"#打包一个-DLL-库\" class=\"headerlink\" title=\"打包一个 DLL 库\"></a>打包一个 DLL 库</h4><p>Webpack 内置了一个 DllPlugin 可以帮助我们打包一个 DLL 的库文件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.DllPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">&quot;dll_[name]&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">path</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/[name].mainfest.json&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"引入-DLL-库\"><a href=\"#引入-DLL-库\" class=\"headerlink\" title=\"引入 DLL 库\"></a>引入 DLL 库</h4><p>使用 Webpack 自带的 <code>DllReferencePlugin</code> 插件对 <code>mainfest.json</code> 映射文件进行分析，获取要使用的 DLL 库，然后再通过 <code>AddAssetHtmlPlugin</code> 插件，将打包的 DLL 库引入到 Html 模块中。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Webpack.DllReferencePlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">context</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/dll_react.js&quot;</span>),</span><br><span class=\"line\">            <span class=\"attr\">mainfest</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/react.mainfest.json&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">        <span class=\"keyword\">new</span> AddAssetHtmlPlugin(&#123;</span><br><span class=\"line\">            <span class=\"attr\">outputPath</span>: <span class=\"string\">&quot;./auto&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">filepath</span>: path.resolve(__dirname, <span class=\"string\">&quot;./dll/dll_react.js&quot;</span>),</span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"6-使用-cache-loader\"><a href=\"#6-使用-cache-loader\" class=\"headerlink\" title=\"6. 使用 cache-loader\"></a>6. 使用 cache-loader</h3><p>在一些性能开销较大的 loader 之前添加 <code>cache-loader</code>，以将结果缓存到磁盘里，显著提升二次构建速度。</p>\n<p>保存和读取这些缓存文件会有一些时间开销，所以应只对性能开销较大的 loader 使用此 loader。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.ext$/</span>,</span><br><span class=\"line\">                use: [<span class=\"string\">&quot;cache-loader&quot;</span>, ...loaders],</span><br><span class=\"line\">                <span class=\"attr\">include</span>: path.resolve(<span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7-terser-启动多线程\"><a href=\"#7-terser-启动多线程\" class=\"headerlink\" title=\"7. terser 启动多线程\"></a>7. terser 启动多线程</h3><p>使用多进程并行运行来提高构建速度。</p>\n<p>TerserWebpackPlugin 插件使用 terser 来压缩 JavaScript。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">            <span class=\"keyword\">new</span> TerserPlugin(&#123;</span><br><span class=\"line\">                <span class=\"attr\">parallel</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            &#125;),</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"8-合理使用-sourceMap\"><a href=\"#8-合理使用-sourceMap\" class=\"headerlink\" title=\"8. 合理使用 sourceMap\"></a>8. 合理使用 sourceMap</h3><p>打包生成 sourceMap 的时候，如果信息越详细，打包速度就会越慢。对应属性取值如下所示：</p>\n<table>\n<thead>\n<tr>\n<th>devtool</th>\n<th>构建速度</th>\n<th>重新构建速度</th>\n<th>生产环境</th>\n<th>品质(quality)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>(none)</td>\n<td>+++</td>\n<td>+++</td>\n<td>yes</td>\n<td>打包后的代码</td>\n</tr>\n<tr>\n<td>eval</td>\n<td>+++</td>\n<td>+++</td>\n<td>no</td>\n<td>生成后的代码</td>\n</tr>\n<tr>\n<td>cheap-eval-source-map</td>\n<td>+</td>\n<td>++</td>\n<td>no</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>cheap-module-eval-source-map</td>\n<td>o</td>\n<td>++</td>\n<td>no</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>eval-source-map</td>\n<td>–</td>\n<td>+</td>\n<td>no</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>cheap-source-map</td>\n<td>+</td>\n<td>o</td>\n<td>yes</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>cheap-module-source-map</td>\n<td>o</td>\n<td>-</td>\n<td>yes</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>inline-cheap-source-map</td>\n<td>+</td>\n<td>o</td>\n<td>no</td>\n<td>转换过的代码 (仅限行)</td>\n</tr>\n<tr>\n<td>inline-cheap-module-source-map</td>\n<td>o</td>\n<td>-</td>\n<td>no</td>\n<td>原始源代码 (仅限行)</td>\n</tr>\n<tr>\n<td>source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>inline-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>no</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>hidden-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>原始源代码</td>\n</tr>\n<tr>\n<td>nosources-source-map</td>\n<td>–</td>\n<td>–</td>\n<td>yes</td>\n<td>无源代码内容</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>+++ 非常快速 &emsp; ++ 快速 &emsp; + 比较快 &emsp; o 中等 &emsp; - 比较慢 &emsp; – 慢</p>\n</blockquote>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>优化 Webpack 构建的方式有很多，主要可以从优化搜索时间、缩小文件搜索范围、减少不必要的编译等方面入手。</p>\n<h2 id=\"Webpack-与-grunt、gulp-有什么不同\"><a href=\"#Webpack-与-grunt、gulp-有什么不同\" class=\"headerlink\" title=\"Webpack 与 grunt、gulp 有什么不同\"></a>Webpack 与 grunt、gulp 有什么不同</h2><img src=\"../.images/image-20210526232017808.png\" alt=\"image-20210526232017808\" style=\"width: 600px;\">\n\n<p>从上图中可以看出来三者都不在一个频道，自然没有可比性。</p>\n<p>grunt 和 gulp 在早期比较流行，属于前端工具类，主要优化前端工作流程，比如自动刷新页面、combo、压缩 css、js、css 预编译等等。</p>\n<p>现在 Webpack 相对来说比较主流，属于预编译模块的方案，不需要在浏览器中加载解释器。另外，在本地直接写 JS，不管是 AMD / CMD / ES6 风格的模块化，Webpack 都能认识，并且编译成浏览器认识的 js。</p>\n<h3 id=\"使用上的区别\"><a href=\"#使用上的区别\" class=\"headerlink\" title=\"使用上的区别\"></a>使用上的区别</h3><p>grunt 和 gulp 是基于任务和流（Task、Stream）的。类似 jQuery，找到一个（或一类）文件，对其做一系列链式操作，更新流上的数据， 整条链式操作构成了一个任务，多个任务就构成了整个 web 的构建流程。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gulp.task(<span class=\"string\">&quot;dev&quot;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 这个任务的名称是 dev</span></span><br><span class=\"line\">    gulp.src(<span class=\"string\">&quot;src/js/*.js&quot;</span>) <span class=\"comment\">//找到 `src/js/` 目录下的所有js</span></span><br><span class=\"line\">        .pipe(concat(<span class=\"string\">&quot;all.js&quot;</span>)) <span class=\"comment\">//对其进行合并并且命名为 `all.js`</span></span><br><span class=\"line\">        .pipe(uglify()) <span class=\"comment\">//压缩</span></span><br><span class=\"line\">        .pipe(rename(<span class=\"string\">&quot;all.min.js&quot;</span>)) <span class=\"comment\">//重命名</span></span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">&quot;dist/js/&quot;</span>)); <span class=\"comment\">//输出压缩后的js</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//在目录下执行 `gulp dev` 即可执行上述操作</span></span><br><span class=\"line\"><span class=\"comment\">//grunt 与 gulp 类似，只是稍微繁索一些，现在基本上用不上了</span></span><br></pre></td></tr></table></figure>\n\n<p>Webpack 是基于入口的。会自动地递归解析入口所需要加载的所有资源文件，然后用不同的 Loader 来处理不同的文件，用 Plugin 来扩展 Webpack 功能。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Webpack 具体配置这里不做讲解，形式都大同小异</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"attr\">entry</span>: <span class=\"string\">&quot;./entry.js&quot;</span>, <span class=\"comment\">//入口文件</span></span><br><span class=\"line\">    <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">filename</span>: <span class=\"string\">&quot;./bundle.js&quot;</span>, <span class=\"comment\">//输出文件</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">loaders</span>: [...loaders],</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>从构建思路来说，gulp 和 grunt 需要开发者将整个前端构建过程拆分成多个 Task，并合理控制所有 Task 的调用关系<br>Webpack 需要开发者找到入口，并需要清楚对于不同的资源应该使用什么 Loader 做何种解析和加工。</p>\n<h3 id=\"总结-1\"><a href=\"#总结-1\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ul>\n<li>  gulp、grunt 是 web 构建工具</li>\n<li>  Webpack 是模块化方案</li>\n<li>  gulp、grunt 是基于任务和流</li>\n<li>  Webpack 基于入口文件</li>\n</ul>"}],"PostAsset":[{"_id":"source/_posts/webpack/webpack-1.png","post":"ckvgn6y83001nnwlw87wo44bb","slug":"webpack-1.png","modified":1,"renderable":1},{"_id":"source/_posts/webpack/webpack-2.png","post":"ckvgn6y83001nnwlw87wo44bb","slug":"webpack-2.png","modified":1,"renderable":1}],"PostCategory":[{"post_id":"ckvgn6y83001nnwlw87wo44bb","category_id":"ckvgn6y8a001onwlwdeeeagxn","_id":"ckvgn6y8g001rnwlwd5gx163d"}],"PostTag":[{"post_id":"ckvgn6y83001nnwlw87wo44bb","tag_id":"ckvgn6y8d001pnwlwdno54f5b","_id":"ckvgn6y8f001qnwlw0kco1ghy"}],"Tag":[{"name":"webpack","_id":"ckvgn6y8d001pnwlwdno54f5b"}]}}